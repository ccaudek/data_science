[
  {
    "objectID": "index.html",
    "href": "index.html",
    "title": "Data Science per psicologi",
    "section": "",
    "text": "Questo è il sito web per “Data Science per psicologi”. Viene qui presentato il materiale delle lezioni dell’insegnamento di Psicometria B000286 (A.A. 2021/2022) rivolto agli studenti del primo anno del Corso di Laurea in Scienze e Tecniche Psicologiche dell’Università degli Studi di Firenze. Lo scopo di questo insegnamento è quello di fornire agli studenti un’introduzione all’analisi dei dati psicologici. Le conoscenze/competenze che verranno sviluppate in questo insegnamento sono quelle della Data Science applicata alla psicologia, ovvero, un insieme di conoscenze/competenze che si pongono all’intersezione tra psicologia, statistica e informatica."
  },
  {
    "objectID": "index.html#license",
    "href": "index.html#license",
    "title": "Data Science per psicologi",
    "section": "License",
    "text": "License\nThis book was created by Corrado Caudek and is licensed under a Creative Commons Attribution-NonCommercial-NoDerivatives 4.0 International License."
  },
  {
    "objectID": "preface.html",
    "href": "preface.html",
    "title": "Prefazione",
    "section": "",
    "text": "Questo libro ti insegnerà i principi base della Data Science, con esempi pratici.\nSembra sensato spendere due parole su una domanda che è importante per gli studenti: perché dobbiamo perdere tanto tempo a studiare l’analisi dei dati psicologici quando in realtà quello che ci interessa è tutt’altro? Questa è una bella domanda. C’è una ragione molto semplice che dovrebbe farci capire perché la Data Science sia così importante per la psicologia. Infatti, a ben pensarci, la psicologia è una disciplina intrinsecamente statistica, se per statistica intendiamo quella disciplina che studia la variazione delle caratteristiche degli individui nella popolazione. La psicologia studia gli individui ed è proprio la variabilità inter- e intra-individuale ciò che vogliamo descrivere e, in certi casi, predire. In questo senso, la psicologia è molto diversa dall’ingegneria, per esempio. Le proprietà di un determinato ponte sotto certe condizioni, ad esempio, sono molto simili a quelle di un altro ponte, sotto le medesime condizioni. Quindi, per un ingegnere la statistica è poco importante: le proprietà dei materiali sono unicamente dipendenti dalla loro composizione e restano costanti. Ma lo stesso non può dirsi degli individui: ogni individuo è unico e cambia nel tempo. E le variazioni tra gli individui, e di un individuo nel tempo, sono l’oggetto di studio proprio della psicologia: è dunque chiaro che i problemi che la psicologia si pone sono molto diversi da quelli affrontati, per esempio, dagli ingegneri. Questa è la ragione per cui abbiamo tanto bisogno della Data Science in psicologia: perché la Data Science ci consente di descrivere la variazione e il cambiamento. E queste sono appunto le caratteristiche di base dei fenomeni psicologici.\nSono sicuro che, leggendo queste righe, a molti studenti sarà venuta in mente la seguente domanda: perché non chiediamo a qualche esperto di fare il “lavoro sporco” (ovvero le analisi statistiche) per noi, mentre noi (gli psicologi) ci occupiamo solo di ciò che ci interessa, ovvero dei problemi psicologici slegati dai dettagli “tecnici” della Data Science? La risposta a questa domanda è che non è possibile progettare uno studio psicologico sensato senza avere almeno una comprensione rudimentale della Data Science. Le tematiche della Data Science non possono essere ignorate né dai ricercatori in psicologia né da coloro che svolgono la professione di psicologo al di fuori dell’Università. Infatti, anche i professionisti al di fuori dall’università non possono fare a meno di leggere la letteratura psicologica più recente: il continuo aggiornamento delle conoscenze è infatti richiesto dalla deontologia della professione. Ma per potere fare questo è necessario conoscere un bel po’ di Data Science! Basta aprire a caso una rivista specialistica di psicologia per rendersi conto di quanto ciò sia vero: gli articoli che riportano i risultati delle ricerche psicologiche sono zeppi di analisi statistiche e di modelli formali. E la comprensione della letteratura psicologica rappresenta un requisito minimo nel bagaglio professionale dello psicologo.\nLe considerazioni precedenti cercano di chiarire il seguente punto: la Data Science non è qualcosa da studiare a malincuore, in un singolo insegnamento universitario, per poi poterla tranquillamente dimenticare. Nel bene e nel male, gli psicologi usano gli strumenti della Data Science in tantissimi ambiti della loro attività professionale: in particolare quando costruiscono, somministrano e interpretano i test psicometrici. È dunque chiaro che possedere delle solide basi di Data Science è un tassello imprescindibile del bagaglio professionale dello psicologo. In questo insegnamento verrano trattati i temi base della Data Science e verrà adottato un punto di vista bayesiano, che corrisponde all’approccio più recente e sempre più diffuso in psicologia."
  },
  {
    "objectID": "preface.html#come-studiare",
    "href": "preface.html#come-studiare",
    "title": "Prefazione",
    "section": "Come studiare",
    "text": "Come studiare\nIl giusto metodo di studio per prepararsi all’esame di Psicometria è quello di seguire attivamente le lezioni, assimilare i concetti via via che essi vengono presentati e verificare in autonomia le procedure presentate a lezione. Incoraggio gli studenti a farmi domande per chiarire ciò che non è stato capito appieno. Incoraggio gli studenti a utilizzare i forum attivi su Moodle e, soprattutto, a svolgere gli esercizi proposti su Moodle. I problemi forniti su Moodle rappresentano il livello di difficoltà richiesto per superare l’esame e consentono allo studente di comprendere se le competenze sviluppate fino a quel punto sono sufficienti rispetto alle richieste dell’esame.\nLa prima fase dello studio, che è sicuramente individuale, è quella in cui lo studente deve acquisire le conoscenze teoriche relative ai problemi che saranno presentati all’esame. La seconda fase di studio, che può essere facilitata da scambi con altri e da incontri di gruppo, porta lo studente ad acquisire la capacità di applicare le conoscenze: è necessario capire come usare un software (\\(\\textsf{R}\\)) per applicare i concetti statistici alla specifica situazione del problema che si vuole risolvere. Le due fasi non sono però separate: il saper fare molto spesso aiuta a capire meglio."
  },
  {
    "objectID": "basics.html",
    "href": "basics.html",
    "title": "Parte 1: Nozioni di base",
    "section": "",
    "text": "In questa prima parte affronteremo i temi della misurazione e delll’analisi descrittiva dei dati. Nel capitolo Capitolo 1 verranno presentati i concetti chiave della Data Science. Nel capitolo Capitolo 2 sarà affrontato il tema della misurazione. Nel capitolo Capitolo 3 verranno introdotti i concetti che vengono utilizzati per descrivere le distribuzioni dei dati. Verranno poi introdotti gli indici di tendenza centrale e di dispersione nel capitolo Capitolo 4. Infine, nel capitolo Capitolo 5 verrà affrontato il problema di descrivere le relazioni tra variabili.\nPrima di affrontare tali temi sarà necessario introdurre il linguaggio di programmazione statistica R (un’introduzione a R è fornita in Appendice)."
  },
  {
    "objectID": "001_key_notions.html",
    "href": "001_key_notions.html",
    "title": "1  Concetti chiave",
    "section": "",
    "text": "La data science si pone all’intersezione tra statistica e informatica. La statistica è un insieme di metodi utilizzati per estrarre informazioni dai dati; l’informatica implementa tali procedure in un software. In questo Capitolo vengono introdotti i concetti fondamentali."
  },
  {
    "objectID": "001_key_notions.html#popolazioni-e-campioni",
    "href": "001_key_notions.html#popolazioni-e-campioni",
    "title": "1  Concetti chiave",
    "section": "1.1 Popolazioni e campioni",
    "text": "1.1 Popolazioni e campioni\nPopolazione. L’analisi dei dati inizia con l’individuazione delle unità portatrici di informazioni circa il fenomeno di interesse. Si dice popolazione (o universo) l’insieme \\(\\Omega\\) delle entità capaci di fornire informazioni sul fenomeno oggetto dell’indagine statistica. Possiamo scrivere \\(\\Omega = \\{\\omega_i\\}_{i=1, \\dots, n}= \\{\\omega_1, \\omega_2, \\dots, \\omega_n\\}\\), oppure \\(\\Omega = \\{\\omega_1, \\omega_2, \\dots \\}\\) nel caso di popolazioni finite o infinite, rispettivamente. Gli elementi \\(\\omega_i\\) dell’insieme \\(\\Omega\\) sono detti unità statistiche.\nL’obiettivo principale della ricerca psicologica è conoscere gli esiti psicologici e i loro fattori trainanti nella popolazione. Questo è l’obiettivo delle sperimentazioni psicologiche e della maggior parte degli studi osservazionali in psicologia. È quindi necessario essere molto chiari sulla popolazione a cui si applicano i risultati della ricerca. La popolazione può essere ben definita, ad esempio, tutte le persone che si trovavano nella città di Hiroshima al momento del bombardamento atomico e sono sopravvissute per un anno, o può essere ipotetica, ad esempio, tutte le persone depresse che hanno subito o saranno sottoposte ad un intervento psicologico. Il ricercatore deve sempre essere in grado di determinare se un soggetto appartiene o meno alla popolazione oggetto di interesse.\nUna sotto-popolazione è una popolazione che soddisfa proprietà ben definite. Ad esempio, potremmo essere interessati alla sotto-popolazione di uomini di età inferiore ai 20 anni o alla sotto-popolazione di pazienti depressi sottoposti ad uno specifico intervento psicologico. Molte domande scientifiche riguardano le differenze tra sotto-popolazioni; ad esempio, il confronto tra un gruppo sottoposto a psicoterapia e un gruppo di controllo per determinare se il trattamento è stato efficace.\nCampione. Un sottoinsieme della popolazione, ovvero un insieme di elementi \\(\\omega_i\\), viene chiamato campione. Ciascuna unità statistica \\(\\omega_i\\) (abbreviata con u.s.) è portatrice dell’informazione che verrà rilevata mediante un’operazione di misurazione.\nUn campione è dunque un sottoinsieme della popolazione utilizzato per conoscere tale popolazione. A differenza di una sotto-popolazione definita in base a chiari criteri, un campione viene generalmente selezionato tramite un procedura casuale. Il campionamento casuale consente allo scienziato di trarre conclusioni sulla popolazione e, soprattutto, di quantificare l’incertezza sui risultati. I campioni di un sondaggio sono esempi di campioni casuali, ma molti studi osservazionali non sono campionati casualmente. Possono essere campioni di convenienza, come coorti di studenti in un unico istituto, che consistono di tutti gli studenti sottoposti ad un certo intervento psicologico in quell’istituto. Indipendentemente da come vengono ottenuti i campioni, il loro uso al fine di conoscere una popolazione target significa che i problemi di rappresentatività sono inevitabili e devono essere affrontati."
  },
  {
    "objectID": "001_key_notions.html#variabili-e-costanti",
    "href": "001_key_notions.html#variabili-e-costanti",
    "title": "1  Concetti chiave",
    "section": "1.2 Variabili e costanti",
    "text": "1.2 Variabili e costanti\nUna variabile è qualsiasi proprietà o descrittore che può assumere più valori (numerici o categoriali). Una variabile può essere pensata come la domanda di cui il valore dell’u.s. è la risposta. Ad esempio, “Qual è l’età di questo partecipante?” “19 anni”. Qui, “età” è la variabile e “38” è il suo valore.\nLa probabilità che la variabile \\(X\\) assuma valore \\(x\\) si scrive \\(P(X = x)\\). Questo è spesso abbreviato in \\(P(x)\\). Possiamo anche esaminare la probabilità di più valori contemporaneamente; per esempio, la probabilità che \\(X = x\\) e \\(Y = y\\) è scritta \\(P(X = x, Y = y)\\) o \\(P(x, y)\\). Si noti che \\(P(X = 19)\\) è interpretato come la probabilità che un individuo selezionato casualmente dalla popolazione abbia 19 anni. Il termine “variabile” si contrappone al termine “costante” che descrive una proprietà invariante di tutte le unità statistiche.\nSi dice modalità ciascuna delle varianti con cui una variabile statistica può presentarsi. Definiamo insieme delle modalità di una variabile statistica l’insieme \\(M\\) di tutte le possibili espressioni con cui la variabile può manifestarsi. Le modalità osservate e facenti parte del campione si chiamano dati.\n\nSupponiamo che il fenomeno studiato sia l’intelligenza. In uno studio, la popolazione potrebbe corrispondere all’insieme di tutti gli italiani adulti. La variabile considerata potrebbe essere il punteggio del test standardizzato WAIS-IV. Le modalità di tale variabile potrebbero essere 112, 92, 121, … Tale variabile è di tipo quantitativo discreto.\n\n\nSupponiamo che il fenomeno studiato sia il compito Stroop. La popolazione potrebbe corrispondere all’insieme dei bambini dai 6 agli 8 anni. La variabile considerata potrebbe essere il reciproco dei tempi di reazione in secondi. Le modalità di tale variabile potrebbero essere 1.93, 2.35, 1.32, 1.49, 1.62, 2.93, … La variabile è di tipo quantitativo continuo.\n\n\nSupponiamo che il fenomeno studiato sia il disturbo di personalità. La popolazione potrebbe corrispondere all’insieme dei detenuti nelle carceri italiane. La variabile considerata potrebbe essere l’assessment del disturbo di personalità tramite interviste cliniche strutturate. Le modalità di tale variabile potrebbero essere i Cluster A, Cluster B, Cluster C descritti dal DSM-V. Tale variabile è di tipo qualitativo.\n\n\n1.2.1 Variabili casuali\nIl termine variabile usato nella statistica è equivalente al termine variabile casuale usato nella teoria delle probabilità. Lo studio dei risultati degli interventi psicologici è lo studio delle variabili casuali che misurano questi risultati. Una variabile casuale cattura una caratteristica specifica degli individui nella popolazione e i suoi valori variano tipicamente tra gli individui. Ogni variabile casuale può assumere in teoria una gamma di valori sebbene, in pratica, osserviamo un valore specifico per ogni individuo. Useremo lettere maiuscole come \\(X\\) e \\(Y\\) per fare riferiremo alle variabili casuali considerate in termini generali; useremo lettere minuscole come \\(x\\) e \\(y\\) quando faremo riferimento ai valori assunti da una variabile casuale in una specifica circostanza.\n\n\n1.2.2 Variabili indipendenti e variabili dipendenti\nUn primo compito fondamentale in qualsiasi analisi dei dati è l’identificazione delle variabili dipendenti (\\(Y\\)) e delle variabili indipendenti (\\(X\\)). Le variabili dipendenti sono anche chiamate variabili di esito o di risposta e le variabili indipendenti sono anche chiamate predittori o covariate. Ad esempio, nell’analisi di regressione, che esamineremo in seguito, la domanda centrale è quella di capire come \\(Y\\) cambia al variare di \\(X\\). Più precisamente, la domanda che viene posta è: se il valore della variabile indipendente \\(X\\) cambia, qual è la conseguenza per la variabile dipendente \\(Y\\)? In parole povere, le variabili indipendenti e dipendenti sono analoghe a “cause” ed “effetti”, laddove le virgolette usate qui sottolineano che questa è solo un’analogia e che la determinazione delle cause può avvenire soltanto mediante l’utilizzo di un appropriato disegno sperimentale e di un’adeguata analisi statistica.\nSe una variabile è una variabile indipendente o dipendente dipende dalla domanda di ricerca. A volte può essere difficile distinguere le variabili dipendenti dalle variabili indipendenti, in particolare quando siamo specificamente interessati ai rapporti di causa/effetto. Ad esempio, supponiamo di indagare l’associazione tra esercizio fisico e insonnia. Vi sono evidenze che l’esercizio fisico (fatto al momento giusto della giornata) può ridurre l’insonnia. Ma l’insonnia può anche ridurre la capacità di una persona di fare esercizio fisico. Non è dunque facile capire quale sia la causa e quale sia l’effetto, ovvero quale sia la variabile dipendente e quale la variabile indipendente. La possibilità di identificare il ruolo delle variabili (dipendente/indipendente) dipende dalla nostra comprensione del fenomeno in esame.\n\nUno psicologo convoca 120 studenti universitari per un test di memoria. Prima di iniziare l’esperimento, a metà dei soggetti viene detto che si tratta di un compito particolarmente difficile; agli altri soggetti non viene data alcuna indicazione. Lo psicologo misura il punteggio nella prova di memoria di ciascun soggetto.\nIn questo esperimento, la variabile indipendente è l’informazione sulla difficoltà della prova. La variabile indipendente viene manipolata dallo sperimentatore assegnando i soggetti (di solito in maniera causale) o alla condizione (modalità) “informazione assegnata” o “informazione non data”. La variabile dipendente è ciò che viene misurato nell’esperimento, ovvero il punteggio nella prova di memoria di ciascun soggetto.\n\n\n\n1.2.3 La matrice dei dati\nLe realizzazioni delle variabili esaminate in una rilevazione statistica vengono organizzate in una matrice dei dati. Le colonne della matrice dei dati contengono gli insiemi dei dati individuali di ciascuna variabile statistica considerata. Ogni riga della matrice contiene tutte le informazioni relative alla stessa unità statistica. Una generica matrice dei dati ha l’aspetto seguente:\n\\[\nD_{m,n} =\n\\begin{pmatrix}\n  \\omega_1 & a_{1}   & b_{1}   & \\cdots & x_{1} & y_{1}\\\\\n  \\omega_2 & a_{2}   & b_{2}   & \\cdots & x_{2} & y_{2}\\\\\n  \\vdots   & \\vdots  & \\vdots  & \\ddots & \\vdots & \\vdots  \\\\\n\\omega_n  & a_{n}   & b_{n}   & \\cdots & x_{n} & y_{n}\n\\end{pmatrix}\n\\]\ndove, nel caso presente, la prima colonna contiene il nome delle unità statistiche, la seconda e la terza colonna si riferiscono a due mutabili statistiche (variabili categoriali; \\(A\\) e \\(B\\)) e ne presentano le modalità osservate nel campione mentre le ultime due colonne si riferiscono a due variabili statistiche (\\(X\\) e \\(Y\\)) e ne presentano le modalità osservate nel campione. Generalmente, tra le unità statistiche \\(\\omega_i\\) non esiste un ordine progressivo; l’indice attribuito alle unità statistiche nella matrice dei dati si riferisce semplicemente alla riga che esse occupano."
  },
  {
    "objectID": "001_key_notions.html#parametri-e-modelli",
    "href": "001_key_notions.html#parametri-e-modelli",
    "title": "1  Concetti chiave",
    "section": "1.3 Parametri e modelli",
    "text": "1.3 Parametri e modelli\nOgni variabile casuale ha una distribuzione che descrive la probabilità che la variabile assuma qualsiasi valore in un dato intervallo.1 Senza ulteriori specificazioni, una distribuzione può fare riferimento a un’intera famiglia di distribuzioni. I parametri, tipicamente indicati con lettere greche come \\(\\mu\\) e \\(\\alpha\\), ci permettono di specificare di quale membro della famiglia stiamo parlando. Quindi, si può parlare di una variabile casuale con una distribuzione Normale, ma se viene specificata la media \\(\\mu\\) = 100 e la varianza \\(\\sigma^2\\) = 15, viene individuata una specifica distribuzione Normale – nell’esempio, la distribuzione del quoziente di intelligenza.\nI metodi statistici parametrici specificano la famiglia delle distribuzioni e quindi utilizzano i dati per individuare, stimando i parametri, una specifica distribuzione all’interno della famiglia di distribuzioni ipotizzata. Se \\(f\\) è la PDF di una variabile casuale \\(Y\\), l’interesse può concentrarsi sulla sua media e varianza. Nell’analisi di regressione, ad esempio, cerchiamo di spiegare come i parametri di \\(f\\) dipendano dalle covariate \\(X\\). Nella regressione lineare classica, assumiamo che \\(Y\\) abbia una distribuzione normale con media \\(\\mu = \\mathbb{E}(Y)\\), e stimiamo come \\(\\mathbb{E}(Y)\\) dipenda da \\(X\\). Poiché molti esiti psicologici non seguono una distribuzione normale, verranno introdotte distribuzioni più appropriate per questi risultati. I metodi non parametrici, invece, non specificano una famiglia di distribuzioni per \\(f\\). In queste dispense faremo riferimento a metodi non parametrici quando discuteremo della statistica descrittiva.\nIl termine modello è onnipresente in statistica e nella data science. Il modello statistico include le ipotesi e le specifiche matematiche relative alla distribuzione della variabile casuale di interesse. Il modello dipende dai dati e dalla domanda di ricerca, ma raramente è unico; nella maggior parte dei casi, esiste più di un modello che potrebbe ragionevolmente usato per affrontare la stessa domanda di ricerca e avendo a disposizione i dati osservati. Nella previsione delle aspettative future dei pazienti depressi che discuteremo in seguito (Zetsche et al., 2019), ad esempio, la specifica del modello include l’insieme delle covariate candidate, l’espressione matematica che collega i predittori con le aspettative future e qualsiasi ipotesi sulla distribuzione della variabile dipendente. La domanda di cosa costituisca un buon modello è una domanda su cui torneremo ripetutamente in questo insegnamento."
  },
  {
    "objectID": "001_key_notions.html#effetto",
    "href": "001_key_notions.html#effetto",
    "title": "1  Concetti chiave",
    "section": "1.4 Effetto",
    "text": "1.4 Effetto\nL’effetto è una qualche misura dei dati. Dipende dal tipo di dati e dal tipo di test statistico che si vuole utilizzare. Ad esempio, se viene lanciata una moneta 100 volte e esce testa 66 volte, l’effetto sarà 66/100. Diventa poi possibile confrontare l’effetto ottenuto con l’effetto nullo che ci si aspetterebbe da una moneta bilanciata (50/100), o con qualsiasi altro effetto che può essere scelto. La dimensione dell’effetto si riferisce alla differenza tra l’effetto misurato nei dati e l’effetto nullo (di solito un valore che ci si aspetta di ottenere in base al caso soltanto)."
  },
  {
    "objectID": "001_key_notions.html#stima-e-inferenza",
    "href": "001_key_notions.html#stima-e-inferenza",
    "title": "1  Concetti chiave",
    "section": "1.5 Stima e inferenza",
    "text": "1.5 Stima e inferenza\nLa stima è il processo mediante il quale il campione viene utilizzato per conoscere le proprietà di interesse della popolazione. La media campionaria è una stima naturale della media della popolazione e la mediana campionaria è una stima naturale della mediana della popolazione. Quando parliamo di stimare una proprietà della popolazione (a volte indicata come parametro della popolazione) o di stimare la distribuzione di una variabile casuale, stiamo parlando dell’utilizzo dei dati osservati per conoscere le proprietà di interesse della popolazione. L’inferenza statistica è il processo mediante il quale le stime campionarie vengono utilizzate per rispondere a domande di ricerca e per valutare specifiche ipotesi relative alla popolazione. Discuteremo le procedure bayesiane dell’inferenza nell’ultima parte di queste dispense."
  },
  {
    "objectID": "001_key_notions.html#metodi-e-procedure-della-psicologia",
    "href": "001_key_notions.html#metodi-e-procedure-della-psicologia",
    "title": "1  Concetti chiave",
    "section": "1.6 Metodi e procedure della psicologia",
    "text": "1.6 Metodi e procedure della psicologia\nUn modello psicologico di un qualche aspetto del comportamento umano o della mente ha le seguenti proprietà:\n\ndescrive le caratteristiche del comportamento in questione,\nformula predizioni sulle caratteristiche future del comportamento,\nè sostenuto da evidenze empiriche,\ndeve essere falsificabile (ovvero, in linea di principio, deve potere fare delle predizioni su aspetti del fenomeno considerato che non sono ancora noti e che, se venissero indagati, potrebbero portare a rigettare il modello, se si dimostrassero incompatibili con esso).\n\nL’analisi dei dati valuta un modello psicologico utilizzando strumenti statistici.\n\n\n\n\n\n\nZetsche, U., Bürkner, P.-C., & Renneberg, B. (2019). Future expectations in clinical depression: Biased or realistic? Journal of Abnormal Psychology, 128(7), 678–688."
  },
  {
    "objectID": "005_measurement.html",
    "href": "005_measurement.html",
    "title": "2  La misurazione in psicologia",
    "section": "",
    "text": "Introduco il problema della misurazione in psicologia parlando dell’intelligenza. In quanto psicologi, siamo abituati a pensare alla misurazione dell’intelligenza, ma anche le persone che non sono psicologi sono ben familiari con la misurazione dell’intelligenza: tra le misurazioni delle caratteristiche psicologiche, infatti, la misurazione dell’intelligenza è forse la più conosciuta.\nI test di intelligenza consistono in una serie di problemi di carattere verbale, numerico o simbolico. Come ci si può aspettare, alcune persone riescono a risolvere correttamente un numero maggiore di problemi di altre. Possiamo contare il numero di risposte corrette e osservare le differenze individuali nei punteggi calcolati. Scopriamo in questo modo che le differenze individuali nell’abilità di risolvere tali problemi risultano sorprendentemente stabili nell’età adulta. Inoltre, diversi test di intelligenza tendono ad essere correlati positivamente: le persone che risolvono un maggior numero di problemi verbali, in media, tenderanno anche a risolvere correttamente un numero più grande di problemi numerici e simbolici. Esiste quindi una notevole coerenza delle differenze osservate tra le persone, sia nel tempo sia considerando diverse procedure di test e valutazione.\nAvendo stabilito che ci sono differenze individuali tra le persone, è possibile esaminare le associazioni tra i punteggi dei test di intelligenza e altre variabili. Possiamo indagare se le persone con punteggi più alti nei test di intelligenza, rispetto a persone che ottengono punteggi più bassi, hanno più successo sul lavoro; se guadagnano di più; se votano in modo diverso; o se hanno un’aspettativa di vita più alta. Possiamo esaminare le differenze nei punteggi dei test di intelligenza in funzione di variabili come il genere, il gruppo etnico-razziale o lo stato socio-economico. Possiamo fare ricerche sull’associazione tra i punteggi dei test di intelligenza e l’efficienza dell’elaborazione neuronale, i tempi di reazione o la quantità di materia grigia all’interno della scatola cranica. Tutte queste ricerche sono state condotte e gli psicologi hanno scoperto una vasta gamma di associazioni tra le misure dell’intelligenza e altre variabili. Alcune di queste associazioni sono grandi e stabili, altre sono piccole e difficili da replicare. In riferimento all’intelligenza, dunque, gli psicologi hanno condotto un enorme numero di ricerche ponendosi domande diverse. In quali condizioni si verificano determinati effetti? Quali variabili mediano o moderano le relazioni tra i punteggi dei test di intelligenza e altre variabili? Queste relazioni si mantengono stabili in diversi gruppi di persone? Le ricerche sull’intelligenza umana sono un campo in continuo sviluppo.\nTuttavia, una domanda sorge spontanea: che cosa misurano esattamente i test di intelligenza? Dopo un secolo di ricerche sui punteggi dei test di intelligenza e, in generale, sui test psicologici, non sappiamo ancora rispondere a questa domanda. Questa considerazione relativa ai test di intelligenza ci conduce dunque alle seguenti domande: che cos’è esattamente un costrutto psicologico (come l’intelligenza, ad esempio)? Come può essere misurato un costrutto psicologico? Queste sono domande a cui è difficile rispondere e a cui è dedicata un’intera area di ricerca, quella della teoria della misurazione psicologica. Non possiamo qui entrare nel merito delle complessità della teoria della misurazione psicologica (questi temi più generali verranno approfonditi nei successivi insegnamenti sulla testistica psicologica). La motivazione delle considerazioni precedenti era solo quella di fare qualche accenno al contesto generale all’interno del quale si colloca il tema di cui ci occuperemo qui, ovvero quello delle scale di misura."
  },
  {
    "objectID": "005_measurement.html#le-scale-di-misura",
    "href": "005_measurement.html#le-scale-di-misura",
    "title": "2  La misurazione in psicologia",
    "section": "\n2.1 Le scale di misura",
    "text": "2.1 Le scale di misura\nIn generale possiamo dire che la teoria della misurazione si occupa dello studio delle relazioni esistenti tra due domini: il “mondo fisico” e il “mondo psicologico”. Secondo la teoria della misurazione, la misurazione è un’attività rappresentativa, cioè è un processo di assegnazione di numeri in modo tale da preservare, all’interno del dominio numerico, le relazioni qualitative che sono state osservate nel mondo empirico. La teoria della misurazione ha lo scopo di specificare le condizioni necessarie per la costruzione di una rappresentazione adeguata delle relazioni empiriche all’interno di un sistema numerico. Da una prospettiva formale, le operazioni descritte dalla teoria della misurazione possono essere concettualizzate in termini di mappatura tra le relazioni esistenti all’interno di due insiemi (quello empirico e quello numerico). Il risultato di questa attività è chiamato “scala di misurazione”.\nUna famosa teoria delle scale di misura è stata proposta da (Stevens, 1946). Stevens ci fa notare che, in linea di principio, le variabili psicologiche sono in grado di rappresentare (preservare) con diversi gradi di accuratezza le relazioni qualitative che sono state osservate nei fenomeni psicologici. Secondo la teoria di Stevens, possiamo distinguere tra quattro scale di misura: le scale nominali (nominal scales), ordinali (ordinal scales), a intervalli (interval scales), di rapporti (ratio scales). Tali scale di misura consentono operazioni aritmetiche diverse, come indicato nella tabella successiva, in quanto ciasuna di esse è in grado di “catturare” soltanto alcune delle proprietà dei fenomeni psicologici che intende misurare.\n\n\n2.1.1 Scala nominale\nIl livello di misurazione più semplice è quello della scala nominale. Questa scala di misurazione corrisponde ad una tassonomia. I simoboli o numeri che costituiscono questa scala non sono altro che i nomi delle categorie che utilizziamo per classificare i fenomeni psicologici. In base alle misure fornite da una scala nominale, l’unica cosa che siamo in grado di dire a proposito di una caratteristica psicologica è se essa è uguale o no ad un’altra caratteristica psicologica.\nLa scala nominale raggruppa dunque i dati in categorie qualitative mutuamente esclusive (cioè nessun dato si può collocare in più di una categoria). Esiste la sola relazione di equivalenza tra le misure delle u.s., cioè nella scala nominale gli elementi del campione appartenenti a classi diverse sono differenti, mentre tutti quelli della stessa classe sono tra loro equivalenti: \\(x_i = x_j\\) oppure \\(x_i \\neq x_j\\).\nL’unica operazione algebrica che possiamo compiere sulle modalità della scala nominale è quella di contare le u.s. che appartengono ad ogni modalità e contare il numero delle modalità (classi di equivalenza). Dunque la descrizione dei dati avviene tramite le frequenze assolute e le frequenze relative.\nA partire da una scala nominale è possibile costruire altre scale nominali che sono equivalenti alla prima trasformando i valori della scala di partenza in modo tale da cambiare i nomi delle modalità, ma lasciando però inalterata la suddivisione u.s. nelle medesime classi di equivalenza. Questo significa che prendendo una variabile misurata su scala nominale e cambiando i nomi delle sue categorie otteniamo una nuova variabile esattamente corrispondente alla prima.\n\n2.1.2 Scala ordinale\nLa scala ordinale conserva la proprietà della scala nominale di classificare ciascuna u.s. all’interno di una e una sola categoria, ma alla relazione di equivalenza tra elementi di una stessa classe aggiunge la relazione di ordinamento tra le classi di equivalenza. Essendo basata su una relazione d’ordine, una scala ordinale descrive soltanto l’ordine di rango tra le modalità, ma non ci dà alcuna informazione su quanto una modalità sia più grande di un’altra. Non ci dice, per esempio, se la distanza tra le modalità \\(a\\) e \\(b\\) sia uguale, maggiore o minore della distanza tra le modalità \\(b\\) e \\(c\\).\n\nEsempio 2.1 \nUn esempio classico di scala ordinale è quello della scala Mohs per la determinazione della durezza dei minerali. Per stabilire la durezza dei minerali si usa il criterio empirico della scalfittura. Vengono stabiliti livelli di durezza crescente da 1 a 10 con riferimento a dieci minerali: talco, gesso, calcite, fluorite, apatite, ortoclasio, quarzo, topazio, corindone e diamante. Un minerale appartenente ad uno di questi livelli se scalfisce quello di livello inferiore ed è scalfito da quello di livello superiore.\n\n\n2.1.3 Scala ad intervalli\nLa scala ad intervalli include le proprietà di quella nominale e di quella ordinale, e in più consente di misurare le distanze tra le coppie di u.s. nei termini di un intervallo costante, chiamato unità di misura, a cui viene attribuito il valore “1”. La posizione dell’origine della scala, cioè il punto zero, è scelta arbitrariamente, nel senso che non indica l’assenza della quantità che si sta misurando. Avendo uno zero arbitrario, questa scala di misura consente valori negativi. Lo zero, infatti, non viene attribuito all’u.s. in cui la proprietà misurata risulta assente.\nLa scala a intervalli equivalenti ci consente di effettuare operazioni algebriche basate sulla differenza tra i numeri associati ai diversi punti della scala, operazioni algebriche non era possibile eseguire nel caso di misure a livello di scala ordinale o nominale. Il limite della scala ad intervalli è quello di non consentire il calcolo del rapporto tra coppie di misure. Possiamo dire, per esempio, che la distanza tra \\(a\\) e \\(b\\) è la metà della distanza tra \\(c\\) e \\(d\\). Oppure che la distanza tra \\(a\\) e \\(b\\) è uguale alla distanza tra \\(c\\) e \\(d\\). Non possiamo dire, però, che \\(a\\) possiede la proprietà misurata in quantità doppia rispetto \\(b\\). Non possiamo cioè stabilire dei rapporti diretti tra le misure ottenute. Solo per le differenze tra le modalità sono dunque permesse tutte le operazioni aritmetiche: le differenze possono essere tra loro sommate, elevate a potenza oppure divise, determinando così le quantità che stanno alla base della statistica inferenziale.\nNelle scale ad intervalli equivalenti, l’unità di misura è arbitraria, ovvero può essere cambiata attraverso una dilatazione, operazione che consiste nel moltiplicare tutti i valori della scala per una costante positiva. Poiché l’aggiunta di una costante non altera le differenze tra i valori della scala, è anche ammessa la traslazione, operazione che consiste nel sommare una costante a tutti i valori della scala. Essendo la scala invariate rispetto alla traslazione e alla dilatazione, le trasformazioni ammissibili sono le trasformazioni lineari:\n\\[\ny' = a + by, \\quad b > 0.\n\\]\nL’aspetto che rimane invariante a seguito di una trasformazione lineare è l’uguaglianza dei rapporti fra intervalli.\nEsempio di scala ad intervalli è la temperatura misurata in gradi Celsius o Fahrenheit, ma non Kelvin. Come per la scala nominale, è possibile stabilire se due modalità sono uguali o diverse: 30\\(^\\circ\\)C \\(\\neq\\) 20\\(^\\circ\\)C. Come per la scala ordinale è possibile mettere due modalità in una relazione d’ordine: 30\\(^\\circ\\)C \\(>\\) 20\\(^\\circ\\)C. In aggiunta ai casi precedenti, però, è possibile definire una unità di misura per cui è possibile dire che tra 30\\(^\\circ\\)C e 20\\(^\\circ\\)C c’è una differenza di 30\\(^\\circ\\) - 20\\(^\\circ\\) = 10\\(^\\circ\\)C. I valori di temperatura, oltre a poter essere ordinati secondo l’intensità del fenomeno, godono della proprietà che le differenze tra loro sono direttamente confrontabili e quantificabili.\nIl limite della scala ad intervalli è quello di non consentire il calcolo del rapporto tra coppie di misure. Ad esempio, una temperatura di 80\\(^\\circ\\)C non è il doppio di una di 40\\(^\\circ\\)C. Se infatti esprimiamo le stesse temperature nei termini della scala Fahrenheit, allora i due valori non saranno in rapporto di 1 a 2 tra loro. Infatti, 20\\(^\\circ\\)C = 68\\(^\\circ\\)F e 40\\(^\\circ\\)C = 104\\(^\\circ\\)F. Questo significa che la relazione “il doppio di” che avevamo individuato in precedenza si applicava ai numeri della scala centigrada, ma non alla proprietà misurata (cioè la temperatura). La decisione di che scala usare (Centigrada vs. Fahrenheit) è arbitraria. Ma questa arbitrarietà non deve influenzare le inferenze che traiamo dai dati. Queste inferenze, infatti, devono dirci qualcosa a proposito della realtà empirica e non possono in nessun modo essere condizionate dalle nostre scelte arbitrarie che ci portano a scegliere la scala Centigrada piuttosto che quella Fahrenheit.\nConsideriamo ora l’aspetto invariante di una trasformazione lineare, ovvero l’uguaglianza dei rapporti fra intervalli. Prendiamo in esame, ad esempio, tre temperature: \\(20^\\circ C = 68^\\circ F\\), \\(15^\\circ C = 59^\\circ F\\), \\(10^\\circ C = 50 ^\\circ F\\).\nÈ facile rendersi conto del fatto che i rapporti fra intervalli restano costanti indipendentemente dall’unità di misura che è stata scelta:\n\\[\n  \\frac{20^\\circ C - 10^\\circ C}{20^\\circ C - 15^\\circ C} =\n  \\frac{68^\\circ F - 50^\\circ F}{68^\\circ F-59^\\circ F} = 2.\n\\]\n\n2.1.4 Scala di rapporti\nNella scala a rapporti equivalenti la posizione dello zero non è arbitraria, ma corrisponde all’elemento dotato di intensità nulla rispetto alla proprietà misurata. Una scala a rapporti equivalenti si costruisce associando il numero 0 all’elemento con intensità nulla; viene poi scelta un’unità di misura \\(u\\) e, ad ogni elemento, si assegna un numero \\(a\\) definito come: \\[a = \\frac{d}{u}\\] dove \\(d\\) rappresenta la distanza dall’origine. Alle u.s. vengono dunque assegnati dei numeri tali per cui le differenze e i rapporti tra i numeri riflettono le differenze e i rapporti tra le intensità della proprietà misurata.\nOperazioni aritmetiche sono possibili non solo sulle differenze tra i valori della scala (come per la scala a intervalli equivalenti), ma anche sui valori stessi della scala. L’unica arbitrarietà riguarda l’unità di misura che si utilizza. L’unità di misura può cambiare, ma qualsiasi unità di misura si scelga, lo zero deve sempre indicare l’intensità nulla della proprietà considerata.\nLe trasformazioni ammissibili a questo livello di scala sono dette trasformazioni di similarità: \\[y' = by, \\quad b > 0.\\] A questo livello di scala, a seguito delle trasformazioni ammissibili, rimangono invariati anche i rapporti: \\[\\frac{y_i}{y_j} = \\frac{y'_i}{y'_j}.\\]"
  },
  {
    "objectID": "005_measurement.html#gerarchia-dei-livelli-di-scala-di-misura",
    "href": "005_measurement.html#gerarchia-dei-livelli-di-scala-di-misura",
    "title": "2  La misurazione in psicologia",
    "section": "\n2.2 Gerarchia dei livelli di scala di misura",
    "text": "2.2 Gerarchia dei livelli di scala di misura\nStevens (1946) parla di livelli di scala poiché i quattro tipi di scala di misura stanno in una precisa gerarchia: la scala nominale rappresenta il livello più basso della misurazione, la scala a rapporti equivalenti è invece il livello più alto.\n\n\nScale di modalità\nOperazioni aritmetiche\n\n\n\nnominali\nenumerare le classi di equivalenza e/o\n\n\n\nle frequenze per ciascuna classe di equivalenza\n\n\nordinali\nenumerare le classi di equivalenza e/o\n\n\n\nle frequenze per ciascuna classe di equivalenza\n\n\nintervallari\ndifferenze (rapporti tra differenze)\n\n\ndi rapporti\nrapporti diretti tra le misure\n\n\n\nPassando da un livello di misurazione ad uno più alto aumenta il numero di operazioni aritmetiche che possono essere compiute sui valori della scala, come indicato nella figura seguente.\n\nPer ciò che riguarda le trasformazioni ammissibili, più il livello di scala è basso, più le funzioni sono generali (sono minori cioè i vincoli per passare da una rappresentazione numerica ad un’altra equivalente). Salendo la gerarchia, la natura delle funzioni di trasformazione si fa più restrittiva."
  },
  {
    "objectID": "005_measurement.html#variabili-discrete-o-continue",
    "href": "005_measurement.html#variabili-discrete-o-continue",
    "title": "2  La misurazione in psicologia",
    "section": "\n2.3 Variabili discrete o continue",
    "text": "2.3 Variabili discrete o continue\nLe variabili a livello di intervalli e di rapporti possono essere discrete o continue. Le variabili discrete possono assumere alcuni valori ma non altri. Una volta che l’elenco di valori accettabili è stato specificato, non ci sono casi che cadono tra questi valori. Le variabili discrete di solito assumono valori interi.\nQuando una variabile può assumere qualsiasi valore entro un intervallo specificato, allora si dice che la variabile è continua. In teoria, ciò significa che frazioni e decimali possono essere utilizzati per raggiungere un livello di precisione qualsiasi. In pratica, a un certo punto dobbiamo arrotondare i numeri, rendendo tecnicamente la variabile discreta. In variabili veramente discrete, tuttavia, non è possibile aumentare a piacimento il livello di precisione della misurazione.\n\n\nEsempio 2.2 \nIl numero di biciclette possedute da una persona è una variabile discreta poiché tale variabile può assumere come modalità solo i numeri interi non negativi. Frazioni di bicicletta non hanno senso."
  },
  {
    "objectID": "005_measurement.html#alcune-misure-sono-migliori-di-altre",
    "href": "005_measurement.html#alcune-misure-sono-migliori-di-altre",
    "title": "2  La misurazione in psicologia",
    "section": "\n2.4 Alcune misure sono migliori di altre",
    "text": "2.4 Alcune misure sono migliori di altre\nIn psicologia, ciò che vogliamo misurare non è una caratteristica fisica, ma invece è un concetto teorico inosservabile, ovvero un costrutto. Un costrutto rappresenta il risultato di una fondata riflessione scientifica, non è per definizione accessibile all’osservazione diretta, ma viene inferito dall’osservazione di opportuni indicatori (Sartori, 2005). Ad esempio, supponiamo che un docente voglia valutare quanto bene uno studente comprenda la distinzione tra le quattro diverse scale di misura che sono state descritte sopra. Il docente potrebbe predisporre un test costituito da un insieme di domande e potrebbe contare a quante domande lo studente risponde correttamente. Questo test, però, può o può non essere una buona misura del costrutto relativo alla conoscenza effettiva delle quattro scale di misura. Per esempio, se il docente scrive le domande del test in modo ambiguo o se usa una linguaggio troppo tecnico che lo studente non conosce, allora i risultati del test potrebbero suggerire che lo studente non conosce la materia in questione anche se in realtà questo non è vero. D’altra parte, se il docente prepara un test a scelta multipla con risposte errate molto ovvie, allora lo studente può ottenere dei buoni risultati al test anche senza essere in grado di comprendere adeguatamente le proprietà delle quattro scale di misura. In generale non è possibile misurare un costrutto senza una certa quantità di errore. Poniamoci dunque il problema di determinare in che modo una misurazione possa dirsi adeguata.\n\n2.4.1 Tipologie di errori\nL’errore è, per definizione, la differenza tra il valore vero e il valore misurato della grandezza in esame. Gli errori sono classificati come sistematici (o determinati) e casuali (o indeterminati). Gli errori casuali sono fluttuazioni, in eccesso o in difetto rispetto al valore reale, delle singole determinazioni e sono dovuti alle molte variabili incontrollabili che influenzano ogni misura psicologica. Gli errori sistematici, invece, influiscono sulla misurazione sempre nello stesso senso e, solitamente, per una stessa quantità (possono essere additivi o proporzionali).\nLe differenze tra le due tipologie di errori, sistematici e casuali, introducono i concetti di accuratezza e di precisione della misura. Una misura viene definita:\n\n\naccurata, quando vi è un accordo tra la misura effettuata ed il valore reale;\n\nprecisa quando, ripetendo più volte la misura, i risultati ottenuti sono concordanti, cioè differiscono in maniera irrilevante tra loro.\n\nLa metafora del tiro a bersaglio illustra la relazione tra precisione e accuratezza.\n\n\n\n\nFigura 2.1: Metafora del tiro al bersaglio.\n\n\n\n\nPer tenere sotto controllo l’incidenza degli errori, sono stati introdotti in psicologia i concetti di attendibilità e validità.\nUno strumento si dice attendibile quando valuta in modo coerente e stabile la stessa variabile: i risultati ottenuti si mantengono costanti dopo ripetute somministrazione ed in assenza di variazioni psicologiche e fisiche dei soggetti sottoposti al test o cambiamenti dell’ambiente in cui ha luogo la somministrazione.\nL’attendibilità di uno strumento, però, non è sufficiente: in primo luogo uno strumento di misura deve essere valido, laddove la validità rappresenta il grado in cui uno strumento misura effettivamente ciò che dovrebbe misurare. In genere, si fa riferimento ad almeno quattro tipi di validità.\n\nLa validità di costrutto riguarda il grado in cui un test misura ciò per cui è stato costruito. Essa si suddivide in: validità convergente e validità divergente. La validità convergente fa riferimento alla concordanza tra uno strumento e un altro che misura lo stesso costrutto. La validità divergente, al contrario, valuta il grado di discriminazione tra strumenti che misurano costrutti differenti. Senza validità di costrutto le altre forme di validità non hanno senso.\nIn base alla validità di contenuto, un test fornisce una misura valida di un attributo psicologico se il dominio dell’attributo è rappresentato in maniera adeguata dagli item del test. Un requisito di base della validità di contenuto è la rilevanza e la rappresentatività del contenuto degli item in riferimento all’attributo che il test intende misurare.\nLa validità di criterio valuta il grado di concordanza tra i risultati dello strumento considerato e i risultati ottenuti da altri strumenti che misurano lo stesso costrutto, o tra i risultati dello strumento considerato e un criterio esterno. Nella validità concorrente, costrutto e criterio vengono misurati contestualmente, consentendo un confronto immediato. Nella validità predittiva, il costrutto viene misurato prima e il criterio in un momento successivo, consentendo la valutazione della capacità dello strumento di predire un evento futuro.\nInfine, la validità di facciata fa riferimento al grado in cui il test appare valido ai soggetti a cui esso è diretto. La validità di facciata è importante in ambiti particolari, quali ad esempio la selezione del personale per una determinata occupazione. In questo caso è ovviamente importante che chi si sottopone al test ritenga che il test vada a misurare quegli aspetti che sono importanti per le mansioni lavorative che dovranno essere svolte, piuttosto che altre cose. In generale, la validità di facciata non è utile, tranne in casi particolari."
  },
  {
    "objectID": "005_measurement.html#commenti-e-considerazioni-finali",
    "href": "005_measurement.html#commenti-e-considerazioni-finali",
    "title": "2  La misurazione in psicologia",
    "section": "Commenti e considerazioni finali",
    "text": "Commenti e considerazioni finali\nUna domanda che uno psicologo spesso si pone è: “sulla base delle evidenze osservate, possiamo concludere dicendo che l’intervento psicologico è efficace nel trattamento e nella cura del disturbo?” Le considerazioni svolte in questo capitolo dovrebbero farci capire che, prima di cercare di rispondere a questa domanda con l’analisi statistica dei dati, devono essere affrontati i problemi della validità e dell’attendibilità delle misure (oltre a stabilire l’appropriato livello di scala di misura delle osservazioni). L’attendibilità è un prerequisito della validità. Se gli errori di misurazione sono troppo grandi, i dati sono inutili. Inoltre, uno strumento di misurazione può essere preciso ma non valido. La validità e l’attendibilità delle misurazioni sono dunque entrambe necessarie.\nIn generale, l’attendibilità e la validità delle misure devono essere valutate per capire se i dati raccolti da un ricercatore siano adeguati (1) per fornire una risposta alla domanda della ricerca, e (2) per giungere alla conclusione proposta dal ricercatore alla luce dei risultati dell’analisi statistica che è stata eseguita. È chiaro che le informazioni fornite in questo capitolo si limitano a scalfire la superficie di questi problemi. I concetti qui introdotti, però, devono sempre essere tenuti a mente e costituiscono il fondamento di quanto verrà esposto nei capitoli successivi.\n\n\n\n\n\n\nStevens, S. S. (1946). On the theory of scales of measurement. Science, 103(2684), 677–680."
  },
  {
    "objectID": "007_freq_distr.html",
    "href": "007_freq_distr.html",
    "title": "3  Variabili e distribuzioni di frequenza",
    "section": "",
    "text": "Le analisi esplorative dei dati e la statistica descrittiva costituiscono la prima fase dell’analisi dei dati psicologici. Consentono di capire come i dati sono distribuiti, ci aiutano ad individuare le osservazioni anomale e gli errori di tabulazione. Consentono di riassumere le distribuzioni dei dati mediante indici sintetici. Consentono di visualizzare e di studiare le relazioni tra le variabili. In questo Capitolo, dopo avere presentato gli obiettivi dell’analisi esplorative dei dati, discuteremo il problema della descrizione numerica e della rappresentazione grafica delle distribuzioni di frequenza."
  },
  {
    "objectID": "007_freq_distr.html#chapter-descript",
    "href": "007_freq_distr.html#chapter-descript",
    "title": "3  Variabili e distribuzioni di frequenza",
    "section": "\n3.1 Introduzione all’esplorazione dei dati",
    "text": "3.1 Introduzione all’esplorazione dei dati\nLe analisi esplorative dei dati sono indispensabili per condurre in modo corretto una qualsiasi analisi statistica, dal livello base a quello avanzato. Si parla di analisi descrittiva se l’obiettivo è quello di descrivere le caratteristiche di un campione. Si parla di analisi esplorativa dei dati (Exploratory Data Analysis o EDA) se l’obiettivo è quello di esplorare i dati alla ricerca di nuove informazioni e relazioni tra variabili. Questa distinzione, seppur importante a livello teorico, nella pratica è più fumosa perché spesso entrambe le situazioni si verificano contemporaneamente nella stessa indagine statistica e le metodologie di analisi che si utilizzano sono molto simili.\nNé il calcolo delle statistiche descrittive né l’analisi esplorativa dei dati possono essere condotte senza utilizzare un software. Le descrizioni dei concetti di base della EDA saranno dunque fornite di pari passo alla spiegazione di come le quantità discusse possono essere calcolate in pratica utilizzando \\(\\mathsf{R}\\)."
  },
  {
    "objectID": "007_freq_distr.html#un-excursus-storico",
    "href": "007_freq_distr.html#un-excursus-storico",
    "title": "3  Variabili e distribuzioni di frequenza",
    "section": "\n3.2 Un excursus storico",
    "text": "3.2 Un excursus storico\nNel 1907 Francis Galton, cugino di Charles Darwin, matematico e statistico autodidatta, geografo, esploratore, teorico della dattiloscopia (ovvero, dell’uso delle impronte digitali a fini identificativi) e dell’eugenetica, scrisse una lettera alla rivista scientifica Nature sulla sua visita alla Fat Stock and Poultry Exhibition di Plymouth. Lì vide alcuni membri del pubblico partecipare ad un gioco il cui scopo era quello di indovinare il peso della carcassa di un grande bue che era appena stato scuoiato. Galton si procurò i 787 dei biglietti che erano stati compilati dal pubblico e considerò il valore medio di 547 kg come la “scelta democratica” dei partecipanti, in quanto “ogni altra stima era stata giudicata troppo alta o troppo bassa dalla maggioranza dei votanti”. Il punto interessante è che il peso corretto di 543 kg si dimostrò essere molto simile alla “scelta democratica” basata sulle stime dei 787 partecipanti. Galton intitolò la sua lettera a Nature Vox Populi (voce del popolo), ma questo processo decisionale è ora meglio conosciuto come la “saggezza delle folle” (wisdom of crowds). Possiamo dire che, nel suo articolo del 1907, Galton effettuò quello che ora chiamiamo un riepilogo dei dati, ovvero calcolò un indice sintetico a partire da un insieme di dati. In questo capitolo esamineremo le tecniche che sono state sviluppate nel secolo successivo per riassumere le grandi masse di dati con cui sempre più spesso ci dobbiamo confrontare. Vedremo come calcolare e interpretare gli indici di posizione e di dispersione, discuteremo le distribuzioni di frequenze e le relazioni tra variabili. Vedremo inoltre quali sono le tecniche di visualizzazione che ci consentono di rappresentare questi sommari dei dati mediante dei grafici. Ma prima di entrare nei dettagli, prendiamoci un momento per capire perché abbiamo bisogno della statistica e, per ciò che stiamo discutendo qui, della statistica descrittiva.\nIn generale, che cos’è la statistica? Ci sono molte definizioni. Fondamentalmente, la statistica è un insieme di tecniche che ci consentono di dare un senso al mondo attraverso i dati. Ciò avviene tramite il processo di analisi statistica. L’analisi statistica traduce le domande che abbiamo a proposito del mondo in modelli matematici, utilizza i dati per scegliere i modelli matematici che sono apppropriati per descrivere il mondo e, infine, applica tali modelli per trovare una risposta alle domande che ci siamo posti. La statistica consente quindi di collegare le nostre domande a proposito del mondo ai dati, di utilizzare i dati per trovare le risposte alle domande che ci siamo posti e di valutare l’impatto delle risposte che abbiamo trovato."
  },
  {
    "objectID": "007_freq_distr.html#riassumere-i-dati",
    "href": "007_freq_distr.html#riassumere-i-dati",
    "title": "3  Variabili e distribuzioni di frequenza",
    "section": "\n3.3 Riassumere i dati",
    "text": "3.3 Riassumere i dati\nIniziamo a porci una domanda. Quando riassumiamo i dati, necessariamente buttiamo via delle informazioni; ma è una buona idea procedere in questo modo? Non sarebbe meglio conservare le informazioni specifiche di ciascun soggetto che partecipa ad un esperimento psicologico, al di là di ciò che viene trasmesso dagli indici riassuntivi della statistica descrittiva? Che dire delle informazioni che descrivono come sono stati raccolti i dati, come l’ora del giorno o l’umore del partecipante? Tutte queste informazioni vengono perdute quando riassumiamo i dati. La risposta alla domanda che ci siamo posti è che, in generale, non è una buona idea conservare tutti i dettagli di ciò che sappiamo. È molto più utile riassumere le informazioni perché la semplificazione risultante consente i processi di generalizzazione.\nIn un contesto letterario, l’importanza della generalizzazione è stata sottolineata da Jorge Luis Borges nel suo racconto “Funes o della memoria”, che descrive un individuo che perde la capacità di dimenticare. Borges si concentra sulla relazione tra generalizzazione e pensiero: “Pensare è dimenticare una differenza, generalizzare, astrarre. Nel mondo troppo pieno di Funes, c’erano solo dettagli.”\nCome possiamo ben capire, la vita di Funes non è facile. Se facciamo riferimento alla psicologia possiamo dire che gli psicologi hanno studiato a lungo l’utilità della generalizzazione per il pensiero. Un esempio è fornito dal fenomeno della formazione dei concetti e lo psicologo che viene in mente a questo proposito è sicuramente Eleanor Rosch, la quale ha studiato i principi di base della categorizzazione. I concetti ci forniscono uno strumento potente per organizzare le conoscenze. Noi siamo in grado di riconoscere facilmente i diversi esemplare di un concetto – per esempio, “gli uccelli” – anche se i singoli esemplari che fanno parte di una categoria sono molto diversi tra loro (l’aquila, il gabbiano, il pettirosso). L’uso dei concetti, cioè la generalizzazione, è utile perché ci consente di fare previsioni sulle proprietà dei singoli esemplari che appartengono ad una categoria, anche se non abbiamo mai avuto esperienza diretta con essi – per esempio, possiamo fare la predizione che tutti gli uccelli possono volare e mangiare vermi, ma non possono guidare un’automobile o parlare in inglese. Queste previsioni non sono sempre corrette, ma sono utili.\nLe statistiche descrittive, in un certo senso, ci fornisco l’analogo dei “prototipi” che, secondo Eleanor Rosch, stanno alla base del processo psicologico di creazione dei concetti. Un prototipo è l’esemplare più rappresentativo di una categoria. In maniera simile, una statistica descrittiva come la media, ad esempio, potrebbe essere intesa come l’osservazione “tipica”.\nLa statistica descrittiva ci fornisce gli strumenti per riassumere i dati che abbiamo a disposizione in una forma visiva o numerica. Le rappresentazioni grafiche più usate della statistica descrittiva sono gli istogrammi, i diagrammi a dispersione o i box-plot, e gli indici sintetici più comuni sono la media, la mediana, la varianza e la deviazione standard."
  },
  {
    "objectID": "007_freq_distr.html#i-dati-grezzi",
    "href": "007_freq_distr.html#i-dati-grezzi",
    "title": "3  Variabili e distribuzioni di frequenza",
    "section": "\n3.4 I dati grezzi",
    "text": "3.4 I dati grezzi\nPer introdurre i principali strumenti della statistica descrittiva considereremo qui i dati raccolti da Zetsche et al. (2019). Questi ricercatori hanno studiato le aspettative negative quale meccanismo chiave nel mantenimento e nella reiterazione della depressione. Nello studio, Zetsche et al. (2019) si sono chiesti se individui depressi maturino delle aspettative accurate sul loro umore futuro, oppure se tali aspettative sono distorte negativamente.1. In uno studio viene esaminato un campione costituito da 30 soggetti con almeno un episodio depressivo maggiore e da 37 controlli sani. Gli autori hanno misurato il livello depressivo con il Beck Depression Inventory (BDI-II). Questi sono i dati che considereremo qui.\n\nQual è la la gravità della depressione riportata dai soggetti nel campione esaminato da Zetsche et al. (2019)?\nPer rispondere a questa domanda, iniziamo a leggere in \\(\\mathsf{R}\\) i dati, assumendo che il file data.mood.csv si trovi nella cartella data contenuta nella working directory.\n\nCodicelibrary(\"rio\")\ndf <- rio::import(\n  here(\"data\", \"data.mood.csv\"),\n  header = TRUE\n)\n\n\nC’è un solo valore BDI-II per ciascun soggetto ma tale valore viene ripetuto tante volte quante volte sono le righe del data.frame associate ad ogni soggetto (ciascuna riga corrispondente ad una prova diversa). È dunque necessario trasformare il data.frame in modo tale da avere un’unica riga per ciascun soggetto, ovvero un unico valore BDI-II per soggetto.\n\nCodicebysubj <- df %>%\n  group_by(esm_id) %>%\n  summarise(\n    bdi = mean(bdi)\n  ) %>%\n  na.omit()\n\n\nCi sono dunque 66 soggetti i quali hanno ottenuto i valori sulla scala del BDI-II stampati di seguito. Per semplicità, li presentiamo ordinati dal più piccolo al più grande.\n\nCodicesort(bysubj$bdi)\n#>  [1]  0  0  0  0  0  0  0  0  0  0  0  0  0  0  0  0  0  1  1  1  1  1  1  1  1\n#> [26]  2  2  2  2  3  3  3  5  7  9 12 19 22 22 24 25 25 26 26 26 27 27 28 28 30\n#> [51] 30 30 31 31 33 33 34 35 35 35 36 39 41 43 43 44"
  },
  {
    "objectID": "007_freq_distr.html#distribuzioni-di-frequenze",
    "href": "007_freq_distr.html#distribuzioni-di-frequenze",
    "title": "3  Variabili e distribuzioni di frequenza",
    "section": "\n3.5 Distribuzioni di frequenze",
    "text": "3.5 Distribuzioni di frequenze\nÈ chiaro che i dati grezzi sono di difficile lettura. Poniamoci dunque il problema di creare una rappresentazione sintetica e comprensibile di questo insieme di valori. Uno dei modi che ci consentono di effettuare una sintesi dei dati è quello di generare una distribuzione di frequenze.\n\nUna distribuzione di frequenze è un riepilogo del conteggio della frequenza con cui le modalità osservate in un insieme di dati si verificano in un intervallo di valori.\n\nIn altre parole, la distribuzione di frequenze della variabile \\(X\\) corrisponde all’insieme delle frequenze assegnate a ciascun possibile valore di \\(X\\).\nPer creare una distribuzione di frequenze possiamo procedere effettuando una partizione delle modalità della variabile di interesse in \\(m\\) classi (denotate con \\(\\Delta_i\\)) tra loro disgiunte. In tale partizione, la classe \\(i\\)-esima coincide con un intervallo di valori aperto a destra \\([a_i, b_i)\\) o aperto a sinistra \\((a_i, b_i]\\). Ad ogni classe \\(\\Delta_i\\) avente \\(a_i\\) e \\(b_i\\) come limite inferiore e superiore associamo l’ampiezza \\(b_i - a_i\\) (non necessariamente uguale per ogni classe) e il valore centrale \\(\\bar{x}_i\\). La scelta delle classi è arbitraria, ma è buona norma non definire classi con un numero troppo piccolo (< 5) di osservazioni. Poiché ogni elemento dell’insieme \\(\\{x_i\\}_{i=1}^n\\) appartiene ad una ed una sola classe \\(\\Delta_i\\), possiamo calcolare le quantità elencate di seguito.\n\n\nLa frequenza assoluta \\(n_i\\) di ciascuna classe, ovvero il numero di osservazioni che ricadono nella classe \\(\\Delta_i\\).\n\nProprietà: \\(n_1 + n_2 + \\dots + n_m = n\\).\n\n\n\nLa frequenza relativa \\(f_i = n_i/n\\) di ciascuna classe.\n\nProprietà: \\(f_1+f_2+\\dots+f_m =1\\).\n\n\nLa frequenza cumulata \\(N_i\\), ovvero il numero totale delle osservazioni che ricadono nelle classi fino alla \\(i\\)-esima compresa: \\(N_i = \\sum_{i=1}^m n_i.\\)\nLa frequenza cumulata relativa \\(F_i\\), ovvero \\(F_i = f_1+f_2+\\dots+f_m = \\frac{N_i}{n} = \\frac{1}{n} \\sum_{i=1}^m f_i.\\)\n\n\nSi calcoli la distribuzione di frequenza assoluta e la distribuzione di frequenza relativa per i valori del BDI-II del campione clinico di Zetsche et al. (2019).\nPer costruire una distribuzione di frequenza è innanzitutto necessario scegliere gli intervalli delle classi. Facendo riferimento ai cut-off usati per l’interpretazione del BDI-II, definiamo i seguenti intervalli aperti a destra:\n\ndepressione minima: [0, 13.5),\ndepressione lieve: [13.5, 19.5),\ndepressione moderata: [19.5, 28.5),\ndepressione severa: [28.5, 63).\n\nEsaminando i dati, possiamo notare che 36 soggetti cadono nella prima classe, uno nella seconda classe, e così via. La distribuzione di frequenza della variabile bdi2 è riportata nella tabella seguente. Questa distribuzione di frequenza ci aiuta a capire meglio cosa sta succedendo. Se consideriamo la frequenza relativa, ad esempio, possiamo notare che ci sono due valori maggiormente ricorrenti e tali valori corrispondono alle due classi più estreme. Questo ha senso nel caso presente, in quanto il campione esaminato da Zetsche et al. (2019) includeva due gruppi di soggetti: soggetti sani (con valori BDI-II bassi) e soggetti depressi (con valori BDI-II alti).2 In una distribuzione di frequenza tali valori tipici vanno sotto il nome di mode della distribuzione.\n\n\n\nLim. classi\nFr. ass.\nFr. rel.\nFr. ass. cum.\nFr. rel. cum.\n\n\n\n\\([0, 13.5)\\)\n36\n36/66\n36\n36/66\n\n\n\\([13.5, 19.5)\\)\n1\n1/66\n37\n37/66\n\n\n\\([19.5, 28.5)\\)\n12\n12/66\n49\n49/66\n\n\n\\([28.5, 63)\\)\n17\n17/66\n66\n66/66\n\n\n\n\nPoniamoci ora il problema di costruire la tabella precedente utilizzando \\(\\mathsf{R}\\). Usando la funzione cut(), dividiamo il campo di variazione (ovvero, la differenza tra il valore massimo di una distribuzione ed il valore minimo) di una variabile continua x in intervalli e codifica ciascun valore x nei termini dell’intervallo a cui appartiene. Così facendo otteniamo:\n\nCodicebysubj$bdi_level <- cut(\n  bysubj$bdi,\n  breaks = c(0, 13.5, 19.5, 28.5, 63),\n  include.lowest = TRUE,\n  labels = c(\n    \"minimal\", \"mild\", \"moderate\", \"severe\"\n  )\n)\n\nbysubj$bdi_level\n#>  [1] moderate severe   severe   moderate severe   severe   severe   severe  \n#>  [9] moderate severe   moderate mild     severe   minimal  minimal  minimal \n#> [17] severe   moderate minimal  minimal  minimal  minimal  minimal  moderate\n#> [25] minimal  minimal  minimal  minimal  minimal  minimal  minimal  severe  \n#> [33] minimal  minimal  severe   minimal  moderate minimal  minimal  minimal \n#> [41] severe   minimal  minimal  severe   severe   moderate severe   severe  \n#> [49] minimal  moderate minimal  moderate severe   moderate moderate minimal \n#> [57] minimal  minimal  minimal  minimal  minimal  minimal  minimal  minimal \n#> [65] minimal  minimal \n#> Levels: minimal mild moderate severe\n\n\nPossiamo ora usare la funzione table() la quale ritorna un elenco che associa la frequenza assoluta a ciascuna modalità della variabile – ovvero, ritorna la distribuzione di frequenza assoluta.\n\nCodicetable(bysubj$bdi_level)\n#> \n#>  minimal     mild moderate   severe \n#>       36        1       12       17\n\n\nLa distribuzione di frequenza relativa si ottiene dividendo ciascuna frequenza assoluta per il numero totale di osservazioni:\n\nCodicetable(bysubj$bdi_level) / sum(table(bysubj$bdi_level))\n#> \n#>    minimal       mild   moderate     severe \n#> 0.54545455 0.01515152 0.18181818 0.25757576\n\n\n\n\nLimiti delle classi\nFrequenza assoluta\nFrequenza relativa\n\n\n\n[0, 13.5)\n36\n36/66\n\n\n[13.5, 19.5)\n1\n1/66\n\n\n[19.5, 28.5)\n12\n12/66\n\n\n[28.5, 63]\n17\n17/66\n\n\n\n\nInsiemi di variabili possono anche avere distribuzioni di frequenze, dette distribuzioni congiunte. La distribuzione congiunta di un insieme di variabili \\(V\\) è l’insieme delle frequenze di ogni possibile combinazione di valori delle variabili in \\(V\\). Ad esempio, se \\(V\\) è un insieme di due variabili, \\(X\\) e \\(Y\\), ciascuna delle quali può assumere due valori, 1 e 2, allora una possibile distribuzione congiunta di frequenze relative per \\(V\\) è \\(f(X = 1, Y = 1) = 0.2\\), \\(f(X = 1, Y = 2) = 0.1\\), \\(f(X = 2, Y = 1) = 0.5\\), \\(f(X = 2, Y = 2) = 0.2\\). Proprio come con le distribuzioni di frequenze relative di una singola variabile, le frequenze relative di una distribuzione congiunta devono sommare a 1."
  },
  {
    "objectID": "007_freq_distr.html#istogramma",
    "href": "007_freq_distr.html#istogramma",
    "title": "3  Variabili e distribuzioni di frequenza",
    "section": "\n3.6 Istogramma",
    "text": "3.6 Istogramma\nI dati che sono stati sintetizzati in una distribuzione di frequenze possono essere rappresentati graficamente in un istogramma. Un istogramma si costruisce riportando sulle ascisse i limiti delle classi \\(\\Delta_i\\) e sulle ordinate i valori della funzione costante a tratti\n\\[\n\\varphi_n(x)= \\frac{f_i}{b_i-a_i}, \\quad x\\in \\Delta_i,\\, i=1, \\dots, m\n\\] che misura la densità della frequenza relativa della variabile \\(X\\) nella classe \\(\\Delta_i\\), ovvero il rapporto fra la frequenza relativa \\(f_i\\) e l’ampiezza (\\(b_i - a_i\\)) della classe. In questo modo il rettangolo dell’istogramma associato alla classe \\(\\Delta_i\\) avrà un’area proporzionale alla frequenza relativa \\(f_i\\). Si noti che l’area totale dell’istogramma delle frequenze relative è data della somma delle aree dei singoli rettangoli e quindi vale 1.0.\n\nSi utilizzi \\(\\mathsf{R}\\) per costruire un istogramma per i valori BDI-II riportati da Zetsche et al. (2019).\nCon i quattro intervalli individuati dai cut-off del BDI-II otteniamo la rappresentazione riportata nella figura @ref(fig:hist1zetsche). Per chiarezza, precisiamo che ggplot() utilizza intervalli aperti a destra. Nel caso della prima barra dell’istogramma, l’ampiezza dell’intervallo è pari a 13.5 e l’area della barra (ovvero, la frequenza relativa) è uguale a 36/66. Dunque l’altezza della barra è uguale a \\((36 / 66) / 13.5 = 0.040\\). Lo stesso procedimento si applica per il calcolo dell’altezza degli altri rettangoli.\n\nCodicebysubj %>%\n  ggplot(aes(x = bdi)) +\n  geom_histogram(\n    aes(y = ..density..),\n    breaks = c(0, 13.5, 19.5, 28.5, 44.1)\n    # il valore BDI-II massimo è 44\n  ) +\n  scale_x_continuous(\n    breaks = c(0, 13.5, 19.5, 28.5, 44.1)\n  ) +\n  labs(\n    x = \"BDI-II\",\n    y = \"Densità di frequenza\"\n  )\n\n\n\nIstogramma per i valori BDI-II riportati da Zetsche et al. (2019).\n\n\n\n\nAnche se nel caso presente è sensato usare ampiezze diverse per gli intervalli delle classi, in generale gli istogrammi si costruiscono utilizzando intervalli riportati sulle ascisse con un’ampiezza uguale. Questo è il caso dell’istogramma della figura @ref(fig:hist2zetsche).\n\nCodicebysubj %>%\n  ggplot(aes(x = bdi)) +\n  geom_histogram(\n    aes(y = ..density..),\n    breaks = seq(0, 44.1, length.out = 7)\n  ) +\n  scale_x_continuous(\n    breaks = c(0.00, 7.35, 14.70, 22.05, 29.40, 36.75, 44.10)\n  ) +\n  labs(\n    x = \"BDI-II\",\n    y = \"Densità di frequanza\"\n  )\n\n\n\nUna rappresentazione più comune per l’istogramma dei valori BDI-II nella quale gli intervalli delle classi hanno ampiezze uguali."
  },
  {
    "objectID": "007_freq_distr.html#kernel-density-plot",
    "href": "007_freq_distr.html#kernel-density-plot",
    "title": "3  Variabili e distribuzioni di frequenza",
    "section": "\n3.7 Kernel density plot",
    "text": "3.7 Kernel density plot\nIl confronto tra le figure @ref(fig:hist1zetsche) e @ref(fig:hist2zetsche) rende chiaro il limite dell’istogramma: il profilo dell’istogramma è arbitrario, in quanto dipende dal numero e dall’ampiezza delle classi. Questo rende difficile l’interpretazione.\nIl problema precedente può essere alleviato utilizzando una rappresentazione alternativa della distribuzione di frequenza, ovvero la stima della densità della frequenza dei dati (detta anche stima kernel di densità). Un modo semplice per pensare a tale rappresentazione, che in inglese va sotto il nome di kernel density plot (cioè i grafici basati sulla stima kernel di densità), è quello di immaginare un grande campione di dati, in modo che diventi possibile definire un enorme numero di classi di equivalenza di ampiezza molto piccola, le quali non risultino vuote. In tali circostanze, la funzione di densità empirica non è altro che il profilo lisciato dell’istogramma. La stessa idea si applica anche quando il campione è piccolo. In tali circostanze, invece di raccogliere le osservazioni in barre come negli istogrammi, lo stimatore di densità kernel colloca una piccola “gobba” (bump), determinata da un fattore \\(K\\) (kernel) e da un parametro \\(h\\) di smussamento detto ampiezza di banda (bandwidth), in corrispondenza di ogni osservazione, quindi somma le gobbe risultanti generando una curva smussata.\nL’interpretazione che possiamo attribuire al kernel density plot è simile a quella che viene assegnata agli istogrammi: l’area sottesa al kernel density plot in un certo intervallo rappresenta la proporzione di casi della distribuzione che hanno valori compresi in quell’intervallo.\n\nAll’istogramma dei valori BDI-II di Zetsche et al. (2019) si sovrapponga un kernel density plot.\n\nCodicebysubj %>%\n  ggplot(aes(x = bdi)) +\n  geom_histogram(\n    aes(y = ..density..),\n    breaks = seq(0, 44.1, length.out = 7)\n  ) +\n  geom_density(\n    aes(x = bdi),\n    adjust = 0.5,\n    size = 0.8,\n    #fill = colors[2],\n    alpha = 0.5\n  ) +\n  labs(\n    x = \"BDI-II\",\n    y = \"Densità di frequenza\"\n  )\n\n\n\nKernel density plot e corrispondente istogramma per i valori BDI-II."
  },
  {
    "objectID": "007_freq_distr.html#forma-di-una-distribuzione",
    "href": "007_freq_distr.html#forma-di-una-distribuzione",
    "title": "3  Variabili e distribuzioni di frequenza",
    "section": "\n3.8 Forma di una distribuzione",
    "text": "3.8 Forma di una distribuzione\nIn generale, la forma di una distribuzione descrive come i dati si distribuiscono intorno ai valori centrali. Distinguiamo tra distribuzioni simmetriche e asimmetriche, e tra distribuzioni unimodali o multimodali. Un’illustrazione grafica è fornita nella figura @ref(fig:distrib-shapes). Nel pannello 1 la distribuzione è unimodale con asimmetria negativa; nel pannello 2 la distribuzione è unimodale con asimmetria positiva; nel pannello 3 la distribuzione è simmetrica e unimodale; nel pannello 4 la distribuzione è bimodale.\n\n\n\n\nFigura 3.1: 1: Asimmetria negativa. 2: Asimmetria positiva. 3: Distribuzione unimodale. 4: Distribuzione bimodale.\n\n\n\n\n\nIl kernel density plot della figura @ref(fig:zetschehist3) indica che la distribuzione dei valori del BDI-II nel campione di Zetsche et al. (2019) è bimodale. Ciò indica che le osservazioni della distribuzione si addensano in due cluster ben distinti: un gruppo di osservazioni tende ad avere valori BDI-II bassi, mentre l’altro gruppo tende ad avere BDI-II alti. Questi due cluster di osservazioni corrispondono al gruppo di controllo e al gruppo clinico nel campione di dati esaminato da Zetsche et al. (2019)."
  },
  {
    "objectID": "007_freq_distr.html#indici-di-posizione",
    "href": "007_freq_distr.html#indici-di-posizione",
    "title": "3  Variabili e distribuzioni di frequenza",
    "section": "\n3.9 Indici di posizione",
    "text": "3.9 Indici di posizione\n\n3.9.1 Quantili\nLa descrizione della distribuzione dei valori BDI-II di Zetsche et al. (2019) può essere facilitata dalla determinazione di alcuni valori caratteristici che sintetizzano le informazioni contenute nella distribuzione di frequenze. Si dicono quantili (o frattili) quei valori caratteristici che hanno le seguenti proprietà. I quartili sono quei valori che ripartiscono i dati \\(x_i\\) in quattro parti ugualmente numerose (pari ciascuna al 25% del totale). Il primo quartile, \\(q_1\\), lascia alla sua sinistra il 25% del campione pensato come una fila ordinata (a destra quindi il 75%). Il secondo quartile \\(q_2\\) lascia a sinistra il 50% del campione (a destra quindi il 50%). Esso viene anche chiamato mediana. Il terzo quartile lascia a sinistrail 75% del campione (a destra quindi il 25%). Secondo lo stesso criterio, si dicono decili i quantili di ordine \\(p\\) multiplo di 0.10 e percentili i quantili di ordine \\(p\\) multiplo di 0.01.\nCome si calcolano i quantili? Consideriamo la definizione di quantile non interpolato di ordine \\(p\\) \\((0 < p < 1)\\). Si procede innanzitutto ordinando i dati in ordine crescente, \\(\\{x_1, x_2, \\dots, x_n\\}\\). Ci sono poi due possibilità. Se il valore \\(np\\) non è intero, sia \\(k\\) l’intero tale che \\(k < np < k + 1\\) – ovvero, la parte intera di \\(np\\). Allora \\(q_p = x_{k+1}.\\) Se \\(np = k\\) con \\(k\\) intero, allora \\(q_p = \\frac{1}{2}(x_{k} + x_{k+1}).\\) Se vogliamo calcolare il primo quartile \\(q_1\\), ad esempio, utilizziamo \\(p = 0.25\\). Dovendo calcolare gli altri quantili basta sostituire a \\(p\\) il valore appropriato.\nGli indici di posizione, tra le altre cose, hanno un ruolo importante, ovvero vengono utilizzati per creare una rappresentazione grafica di una distribuzione di valori che è molto popolare e può essere usata in alternativa ad un istogramma (in realtà vedremo poi come possa essere combinata con un istogramma). Tale rappresentazione va sotto il nome di box-plot.\n\nPer fare un esempio, consideriamo i nove soggetti del campione clinico di Zetsche et al. (2019) che hanno riportato un unico episodio di depressione maggiore. Per tali soggetti i valori ordinati del BDI-II (per semplicità li chiameremo \\(x\\)) sono i seguenti: 19, 26, 27, 28, 28, 33, 33, 41, 43. Per il calcolo del secondo quartile (non interpolato), ovvero per il calcolo della mediana, dobbiamo considerare la quantità \\(np = 9 \\cdot 0.5 = 4.5\\), non intero. Quindi, \\(q_1 = x_{4 + 1} = 27\\). Per il calcolo del quantile (non interpolato) di ordine \\(p = 2/3\\) dobbiamo considerare la quantità \\(np = 9 \\cdot 2/3 = 6\\), intero. Quindi, \\(q_{\\frac{2}{3}} = \\frac{1}{2} (x_{6} + x_{7}) = \\frac{1}{2} (33 + 33) = 33\\).\n\n\n3.9.2 Diagramma a scatola\nIl diagramma a scatola (o box plot) è uno strumento grafico utile al fine di ottenere informazioni circa la dispersione e l’eventuale simmetria o asimmetria di una distribuzione. Per costruire un box-plot si rappresenta sul piano cartesiano un rettangolo (cioè la “scatola”) di altezza arbitraria la cui base corrisponde alla dist intanza interquartile (IQR = \\(q_{0.75} - q_{0.25}\\)). La linea interna alla scatola rappresenta la mediana \\(q_{0.5}\\). Si tracciano poi ai lati della scatola due segmenti di retta i cui estremi sono detti “valore adiacente” inferiore e superiore. Il valore adiacente inferiore è il valore più piccolo tra le osservazioni che risulta maggiore o uguale al primo quartile meno la distanza corrispondente a 1.5 volte la distanza interquartile. Il valore adiacente superiore è il valore più grande tra le osservazioni che risulta minore o uguale a \\(Q_3+1.5\\) IQR. I valori esterni ai valori adiacenti (chiamati valori anomali) vengono rappresentati individualmente nel box-plot per meglio evidenziarne la presenza e la posizione.\n\n\n\n\nFigura 3.2: Box-plot: \\(M\\) è la mediana, \\(\\bar{x}\\) è la media aritmetica e IQR è la distanza interquartile (\\(Q_3 - Q_1\\)).\n\n\n\n\n\nPer i dati di Zetsche et al. (2019), si utilizzi un box-plot per rappresentare graficamente la distribuzione dei punteggi BDI-II nel gruppo dei pazienti e nel gruppo di controllo.\nNella figura @ref(fig:violin-zetsche) sinistra sono rappresentati i dati grezzi. La linea curva che circonda (simmetricamente) le osservazioni è l’istogramma lisciato (kernel density plot) che abbiamo descritto in precedenza. Nella figura @ref(fig:violin-zetsche) destra sono rappresentanti gli stessi dati: il kernel density plot è lo stesso di prima, ma al suo interno è stato collocato un box-plot. Entrambe le rappresentazioni suggeriscono che la distribuzione dei dati è all’incirca simmetrica nel gruppo clinico. Il gruppo di controllo mostra invece un’asimmetria positiva.\n\nCodicebysubj <- df %>%\n  group_by(esm_id, group) %>%\n  summarise(\n    bdi = mean(bdi),\n    nr_of_episodes = mean(nr_of_episodes, na.rm = TRUE)\n  ) %>%\n  na.omit() %>%\n  ungroup()\n\nbysubj$group <- forcats::fct_recode(\n  bysubj$group,\n  \"Controlli\\n sani\" = \"ctl\",\n  \"Depressione\\n maggiore\" = \"mdd\"\n)\n\np1 <- bysubj %>%\n  ggplot(aes(x = group, y = bdi)) +\n  geom_violin(trim = FALSE) +\n  geom_dotplot(binaxis = \"y\", stackdir = \"center\", dotsize = 0.7) +\n  labs(\n    x = \"\",\n    y = \"BDI-II\"\n  )\np2 <- bysubj %>%\n  ggplot(aes(x = group, y = bdi)) +\n  geom_violin(trim = FALSE) +\n  geom_boxplot(width = 0.05) +\n  labs(\n    x = \"\",\n    y = \"BDI-II\"\n  )\np1 + p2\n\n\n\nDue versioni di un violin plot per i valori BDI-II di ciascuno dei due gruppi di soggetti esaminati da Zetsche et al. (2019).\n\n\n\n\n\n\n3.9.3 Sina plot\nSi noti che i box plot non sono necessariamente la rappresentazione migliore della distribuzione di una variabile. Infatti, richiedono la comprensione di concetti complessi (quali i quantili e la differenza interquantile) che non sono necessari se vogliamo presentare in maniera grafica la distribuzione della variabile e, in generale, non sono compresi da un pubblico di non specialisti. Inoltre, i box plot nascondono informazioni che di solito sono importanti. È dunque preferibile presentare direttamente i dati.\nNella figura @ref(fig:sina-zetsche) viene presentato un cosiddetto “sina plot”. In tale rappresentazione grafica vengono mostrate le singole osservazioni divise in classi. Ai punti viene aggiunto un jitter, così da evitare sovrapposizioni. L’ampiezza del jitter lungo l’asse \\(x\\) è determinata dalla distribuzione della densità dei dati all’interno di ciascuna classe; quindi il grafico mostra lo stesso contorno di un violin plot, ma trasmette informazioni sia sul numero di punti dati, sia sulla distribuzione della densità, sui valori anomali e sulla distribuzione dei dati in un formato molto semplice, comprensibile e sintetico. Per un esempio in una recente pubblicazione, possiamo considerare le figure 3 e 6 di Lazic et al. (2020).\n\nSi generi un sina plot per i dati della figura @ref(fig:violin-zetsche). Si aggiunga alla figura una rappresentazione della mediana.\n\nCodicezetsche_summary <- bysubj %>%\n  group_by(group) %>%\n  summarize(\n    bdi_mean = mean(bdi),\n    bdi_sd = sd(bdi),\n    bdi_median = median(bdi)\n  ) %>%\n  ungroup()\n\nbysubj %>%\n  ggplot(\n    aes(x = group, y = bdi, color = group)\n  ) +\n  ggforce::geom_sina(aes(color = group, size = 1, alpha = .5)) +\n  geom_errorbar(\n    aes(y = bdi_median, ymin = bdi_median, ymax = bdi_median),\n    data = zetsche_summary, width = 0.3, size = 1\n  ) +\n  labs(\n    x = \"\",\n    y = \"BDI-II\",\n    color = \"Gruppo\"\n  ) +\n  theme(legend.position = \"none\") +\n  scale_colour_grey(start = 0.7, end = 0)\n\n\n\nSina plot per i valori BDI-II di ciascuno dei due gruppi di soggetti esaminati da Zetsche et al. (2019) con l’indicazione della mediana per ciascun gruppo.\n\n\n\n\n\n\n3.9.4 L’eccellenza grafica\nNon c’è un unico modo “corretto” per la rappresentazione grafica dei dati. Ciascuno dei grafici che abbiamo discusso in precedenza ha i suoi pregi e i suoi difetti. Un ricercatore che ha molto influenzato il modo in cui viene realizzata la visualizzazione dei dati scientifici è Edward Tufte, soprannominato dal New York Times il “Leonardo da Vinci dei dati.” Secondo Tufte, “l’eccellenza nella grafica consiste nel comunicare idee complesse in modo chiaro, preciso ed efficiente”. Nella visualizzazione delle informazioni, l’“eccellenza grafica” ha l’obiettivo di comunicare al lettore il maggior numero di idee nella maniera più diretta e semplice possibile. Secondo Tufte (2001), le rappresentazioni grafiche dovrebbero:\n\nmostrare i dati;\nindurre l’osservatore a riflettere sulla sostanza piuttosto che sulla progettazione grafica, o qualcos’altro;\nevitare di distorcere quanto i dati stanno comunicando (“integrità grafica”);\npresentare molte informazioni in forma succinta;\nrivelare la coerenza tra le molte dimensioni dei dati;\nincoraggiare l’osservatore a confrontare differenti sottoinsiemi di dati;\nrivelare i dati a diversi livelli di dettaglio, da una visione ampia alla struttura di base;\nservire ad uno scopo preciso (descrizione, esplorazione, o la risposta a qualche domanda);\nessere fortemente integrate con le descrizioni statistiche e verbali dei dati fornite nel testo.\n\nIn base a questi principi, figura @ref(fig:sina-zetsche) sembra fornire la rappresentazione migliore dei dati di Zetsche et al. (2019). Il seguente link fornisce alcune illustrazioni dei principi elencati sopra."
  },
  {
    "objectID": "007_freq_distr.html#commenti-e-considerazioni-finali",
    "href": "007_freq_distr.html#commenti-e-considerazioni-finali",
    "title": "3  Variabili e distribuzioni di frequenza",
    "section": "Commenti e considerazioni finali",
    "text": "Commenti e considerazioni finali\nUna distribuzione è una rappresentazione del modo in cui le diverse modalità di una variabile \\(X\\) si distribuiscono nelle unità statistiche che compongono il campione o la popolazione oggetto di studio. Il modo più diretto per trasmettere descrivere le proprietà della distribuzione di una variabile discreta è quello di fornire una rappresentazione grafica della distribuzione di frequenza. In seguito vedremo la corrispondente rappresentazione che viene usata nel caso delle variabili continue.\n\n\n\n\n\n\nLazic, S. E., Semenova, E., & Williams, D. P. (2020). Determining organ weight toxicity with bayesian causal models: Improving on the analysis of relative organ weights. Scientific Reports, 10(1), 1–12.\n\n\nTufte, E. R. (2001). The visual display of quantitative information. Graphics press Cheshire, CT.\n\n\nZetsche, U., Bürkner, P.-C., & Renneberg, B. (2019). Future expectations in clinical depression: Biased or realistic? Journal of Abnormal Psychology, 128(7), 678–688."
  },
  {
    "objectID": "011_loc_scale.html",
    "href": "011_loc_scale.html",
    "title": "4  Indici di posizione e di scala",
    "section": "",
    "text": "L’analisi grafica, esaminata in precedenza, costituisce la base di partenza di qualsivoglia analisi quantitativa dei dati. Tramite opportune rappresentazioni grafiche possiamo individuare alcune caratteristiche importanti di una distribuzione: per esempio, è possibile capire se la distribuzione è simmetrica o asimmetrica; oppure se è unimodale o multimodale. Successivamente, possiamo calcolare degli indici numerici che descrivono in modo sintetico le caratteristiche di base dei dati esaminati (er un’introduzione “soft” alla nozione di tendenza centrale di una distribuzione statistica, si segua il link)."
  },
  {
    "objectID": "011_loc_scale.html#indici-di-tendenza-centrale",
    "href": "011_loc_scale.html#indici-di-tendenza-centrale",
    "title": "4  Indici di posizione e di scala",
    "section": "\n4.1 Indici di tendenza centrale",
    "text": "4.1 Indici di tendenza centrale\nTra le misure di tendenza centrale, ovvero tra gli indici che forniscono un’idea dei valori attorno ai quali sono prevalentemente concentrati i dati di un campione, quella più comunemente usata è la media.\n\n4.1.1 Media\nTutti conosciamo la media aritmetica di \\(\\{x_1, x_2, \\dots, x_n\\}\\), ovvero il numero reale \\(\\bar{x}\\) definito da\n\\[\\begin{equation}\n\\bar{x}=\\frac{1}{n}\\sum_{i=1}^n x_i.\n(\\#eq:mean)\n\\end{equation}\\]\nNella @ref(eq:mean) abbiamo usato la notazione delle sommatorie per descrivere una somma di valori. Questa notazione è molto usata in statistica e viene descritta in Appendice.\nLa media gode della seguente importante proprietà: la somma degli scarti tra ciascuna modalità \\(x_i\\) e la media aritmetica \\(\\bar{x}\\) è nulla, cioè\n\\[\\begin{equation}\n\\sum_{i=1}^n (x_i - \\bar{x}) = 0.\\notag\n\\label{eq:diffmeansumzero}\n\\end{equation}\\]\nInfatti,\n\\[\n\\begin{aligned}\n\\sum_{i=1}^n (x_i - \\bar{x}) &= \\sum_i x_i - \\sum_i \\bar{x}\\notag\\\\\n&= \\sum_i x_i - n \\bar{x}\\notag\\\\\n&= \\sum_i x_i - \\sum_i x_i = 0.\\notag\n\\end{aligned}\n\\]\nCiò ci consente di pensare alla media come al baricentro della distribuzione.\nUn’altra proprietà della media è la seguente. La somma dei quadrati degli scarti tra ciascuna modalità \\(x_i\\) e una costante arbitraria \\(a\\), cioè\n\\[\\begin{equation}\n\\varphi(a) = \\sum_{i=1}^n (x_i - a)^2,\\notag\n\\end{equation}\\]\nè minima per \\(a = \\bar{x}\\).\n\nNota. Il concetto statistico di media ha suscitato molte battute. Per esempio, il fatto che, in media, ciascuno di noi ha un numero di gambe circa pari a 1.9999999. Oppure, il fatto che, in media, ciascuno di noi ha un testicolo. Ma la media ha altri problemi, oltre al fatto di ispirare battute simili alle precedenti. In particolare, dobbiamo notare che la media non è sempre l’indice che meglio rappresenta la tendenza centrale di una distribuzione. In particolare, ciò non accade quando la distribuzione è asimmetrica, o in presenza di valori anomali (outlier) – si veda il pannello di destra della figura @ref(fig:violin-zetsche). In tali circostanze, la tendenza centrale della distribuzione è meglio rappresentata dalla mediana o dalla media spuntata.\n\n\nSi calcoli la media dei valori BDI-II per i due gruppi di soggetti di Zetsche et al. (2019).\n\nCodicedf <- rio::import(\n  here(\"data\", \"data.mood.csv\"),\n  header = TRUE\n)\nbysubj <- df %>%\n  group_by(group, esm_id) %>%\n  summarise(\n    bdi = mean(bdi)\n  ) %>%\n  na.omit()\n\n\n\nCodicebysubj %>%\n  group_by(group) %>%\n  summarise(\n    avg_bdi = mean(bdi)\n  )\n#> # A tibble: 2 × 2\n#>   group avg_bdi\n#>   <chr>   <dbl>\n#> 1 ctl      1.61\n#> 2 mdd     30.9\n\n\n\n\n4.1.2 Media spuntata\nLa media spuntata \\(\\bar{x}_t\\) (trimmed mean) non è altro che la media dei dati calcolata considerando solo il 90% (o altra percentuale) dei dati centrali. Per calcolare \\(\\bar{x}_t\\) si ordinando i dati secondo una sequenza crescente, \\(x_1 \\leq x_2 \\leq x_3 \\leq \\dots \\leq x_n\\), per poi eliminare il primo 5% e l’ultimo 5% dei dati della serie così ordinata. La media spuntata è data dalla media aritmetica dei dati rimanenti.\n\nSi calcoli la media spuntata dei valori BDI-II per i due gruppi di soggetti di Zetsche et al. (2019) escludendo il 10% dei valori più estremi in ciascun gruppo.\n\nCodicebysubj %>%\n  group_by(group) %>%\n  summarise(\n    avg_trim_bdi = mean(bdi, trim = 0.1)\n  )\n#> # A tibble: 2 × 2\n#>   group avg_trim_bdi\n#>   <chr>        <dbl>\n#> 1 ctl            1  \n#> 2 mdd           30.6\n\n\n\n\n4.1.3 Moda e mediana\nIn precedenza abbiamo già incontrato altri due popolari indici di tendenza centrale: la moda (Mo), ovvero il valore centrale della classe con la frequenza massima (può succedere che una distribuzione abbia più mode; in tal caso si dice multimodale e questo operatore perde il suo significato di indice di tendenza centrale) e la mediana \\(\\tilde{x}\\).\n\nSi calcolino i quantili di ordine 0.25, 0.5 e 0.75 dei valori BDI-II per i due gruppi di soggetti di Zetsche et al. (2019).\n\nCodicebysubj %>%\n  group_by(group) %>%\n  summarise(\n    q25 = quantile(bdi, probs = 0.25),\n    q50 = quantile(bdi, probs = 0.50),\n    q75 = quantile(bdi, probs = 0.75)\n  )\n#> # A tibble: 2 × 4\n#>   group   q25   q50   q75\n#>   <chr> <dbl> <dbl> <dbl>\n#> 1 ctl       0     1     2\n#> 2 mdd      26    30    35\n\n\n\n\nNota. Si noti che solitamente i software restituiscono un valore interpolato del \\(p\\)-esimo quantile \\(q_p\\) \\((0 < p < 1)\\), il quale viene calcolato mediante specifiche procedure. Il risultato fornito dai software, dunque, non sarà identico a quello trovato utilizzando la definizione non interpolata di quantile che abbiamo presentato qui. Se, per qualche ragione, vogliamo conoscere l’algoritmo usato per la determinazione dei quantili interpolati, dobbiamo leggere la documentazione del software."
  },
  {
    "objectID": "011_loc_scale.html#indici-di-dispersione",
    "href": "011_loc_scale.html#indici-di-dispersione",
    "title": "4  Indici di posizione e di scala",
    "section": "\n4.2 Indici di dispersione",
    "text": "4.2 Indici di dispersione\nLe medie e gli indici di posizione descritti in precedenza forniscono delle sintesi dei dati che mettono in evidenza la tendenza centrale delle osservazioni. Tali indici, tuttavia, non considerano un aspetto importante della distribuzione dei dati, ovvero la variabilità dei valori numerici della variabile statistica. È dunque necessario sintetizzare la distribuzione di una variabile statistica oltre che con le misure di posizione anche tramite l’utilizzo di indicatori che valutino la dispersione delle unità statistice.\n\nNota. Un’introduzione “soft” al tema degli indici di posizione è fornita nel seguente link.\n\n\n4.2.1 Indici basati sull’ordinamento dei dati\nÈ possibile calcolare degli indici di variabilità basati sull’ordinamento dei dati. L’indice più ovvio è l’intervallo di variazione, ovvero la distanza tra il valore massimo e il valore minimo di una distribuzione di modalità, mentre in precedenza abbiamo già incontrato la differenza interquartile. Questi due indici, però, hanno il limite di essere calcolati sulla base di due soli valori della distribuzione (\\(x_{\\text{max}}\\) e \\(x_{\\text{mini}}\\), oppure \\(x_{0.25}\\) e \\(x_{0.75}\\)). Pertanto non utilizzano tutte le informazioni che sono disponibili. Inoltre, l’intervallo di variazione ha il limite di essere pesantemente influenzato dalla presenza di valori anomali.\n\n4.2.2 Varianza\nDati i limiti delle statistiche precedenti è più comune misurare la variabilità di una variabile statistica come la dispersione dei dati attorno ad un indice di tendenza centrale. Infatti, la misura di variabilità di gran lunga più usata per valutare la variabilità di una variabile statistica è senza dubbio la varianza. La varianza\n\\[\\begin{equation}\ns^2 = \\frac{1}{n} \\sum_{i=1}^n (x_i - \\bar{x})^2\n(\\#eq:var-descr)\n\\end{equation}\\]\nè la media dei quadrati degli scarti \\(x_i - \\bar{x}\\) tra ogni valore e la media della distribuzione. La varianza è una misura di dispersione più complessa di quelle esaminate in precedenza. È appropriata solo nel caso di distribuzioni simmetriche e, anch’essa, è fortemente influenzata dai valori anomali. Inoltre, è espressa in un’unità di misura che è il quadrato dell’unità di misura dei dati originari e quindi ad essa non può essere assegnata un’interpretazione intuitiva.\n\nSi calcoli la varianza dei valori BDI-II per i dati di Zetsche et al. (2019).\nApplicando la formula precedente, per tutto il campione abbiamo\n\nCodicevar(bysubj$bdi)\n#> [1] 239.8732\n\n\n\n\n4.2.3 Precisione\nSi definisce precisione l’inverso della varianza:\n\\[\\begin{equation}\n\\tau = \\frac{1}{\\sigma^2}.\n(\\#eq:precision)\n\\end{equation}\\]\nAlcuni ritengono che la precisione sia più “intuitiva” della varianza perché dice quanto sono concentrati i valori attorno alla media piuttosto che quanto sono dispersi. In altri termini, si potrebbe argomentare che siamo più interessati a quanto sia precisa una misurazione piuttosto che a quanto sia imprecisa. Più sono dispersi i valori attorno alla media (alta varianza), meno sono precisi (poca precisione); minore è la varianza, maggiore è la precisione.\nLa precisione è uno dei due parametri naturali della distribuzione gaussiana. Nei termini della @ref(eq:precision), la distribuzione gaussiana (si veda il Capitolo @ref(distr-rv-cont)) può essere espressa nel modo seguente\n\\[\n{\\displaystyle f(y)=\\sqrt{\\frac{\\tau}{2\\pi}} e^{-{\\frac {1}{2}}\\tau\\left({y-\\mu }\\right)^{2}}},\n\\] anziché come\n\\[\n{\\displaystyle f(y)={\\frac {1}{\\sigma {\\sqrt {2\\pi }}}}e^{-{\\frac {1}{2}}\\left({\\frac {y-\\mu }{\\sigma }}\\right)^{2}}}.\n\\]\n\n4.2.4 Scarto tipo\nPer le ragioni espresse sopra, la misura più usata della dispersione di una distribuzione di dati è lo scarto quadratico medio (o scarto tipo, o deviazione standard), ovvero la radice quadrata della varianza1. A differenza della varianza, dunque, lo scarto tipo è espresso nella stessa unità di misura dei dati. Come nel caso della varianza, anche lo scarto tipo \\(s\\) dovrebbe essere usato soltanto quando la media è adeguata per misurare il centro della distribuzione, ovvero, nel caso di distribuzioni simmetriche. Come nel caso della media \\(\\bar{x}\\), anche lo scarto tipo è fortemente influenzato dai dati anomali (outlier), ovvero dalla presenza di uno o di pochi dati che sono molto più distanti dalla media rispetto agli altri valori della distribuzione. Quando tutte le osservazioni sono uguali, \\(s = 0\\), altrimenti \\(s > 0\\).\nAllo scarto tipo può essere assegnata una semplice interpretazione: lo scarto tipo è simile (ma non identico) allo scarto semplice medio campionario, ovvero alla media aritmetica dei valori assoluti degli scarti dalla media. Lo scarto tipo ci dice, dunque, quanto sono distanti, in media, le singole osservazioni dal centro della distribuzione. Un’interpretazione più precisa del significato dello scarto tipo è fornita nel Paragrafo successivo.\n\nSi calcoli lo scarto tipo per i valori BDI-II di dati di Zetsche et al. (2019).\nApplicando la formula precedente, per tutto il campione abbiamo\n\nCodicesd(bysubj$bdi)\n#> [1] 15.48784\n\n\n\n\n4.2.5 Deviazione mediana assoluta\nUna misura robusta della dispersione statistica di un campione è la deviazione mediana assoluta (Median Absolute Deviation, MAD) definita come la mediana del valore assoluto delle deviazioni dei dati dalla mediana, ovvero:\n\\[\n{\\displaystyle \\operatorname {MAD} =\\operatorname {median} \\left(\\ \\left|X_{i}-\\operatorname {median} (X)\\right|\\ \\right)}\n\\] Nel caso di una distribuzione dei dati unimodale simmetrica di forma campanulare (ovvero, normale) si ha che\n\\[\n{\\displaystyle \\text{deviazione standard} \\approx 1.4826\\ \\operatorname {MAD} .\\,}\n\\] Pertanto, solitamente i software restituiscono il valore MAD moltiplicato per una tale costante.\n\nSi calcoli il valore MAD per i valori BDI-II riportati da Zetsche et al. (2019).\nApplicando la formula precedente, per tutto il campione abbiamo\n\nCodice1.4826 * median(abs(bysubj$bdi - median(bysubj$bdi)))\n#> [1] 8.8956\n\n\nNel caso presente, i dati seguono una distribuzione bimodale, dunque \\(1.4826\\ \\operatorname {MAD}\\) produce un valore piuttosto diverso dalla deviazione standard.\n\n\n4.2.6 Indici di variabilità relativi\nA volte può essere interessante effettuare un confronto fra due misure di variabilità di grandezze incommensurabili, ovvero di caratteri rilevati mediante differenti unità di misura. In questi casi, le misure di variabilità precedentemente descritte si rivelano inadeguate in quanto dipendono dall’unità di misura adottata. Diventa dunque necessario ricorrere a particolari numeri adimensionali detti indici relativi di variabilità. Il più importante di tali indici è il coefficiente di variazione, ovvero il numero puro\n\\[\nC_v = \\frac{\\sigma}{\\bar{x}}\n\\] ottenuto dal rapporto tra la deviazione standard e la media dei dati. Un altro indice relativo di variabilità è la differenza interquartile rapportata al primo quartile oppure al terzo quartile oppure alla mediana, cioè:\n\\[\n\\frac{x_{0.75} - x_{0.25}}{x_{0.25}}, \\qquad \\frac{x_{0.75} - x_{0.25}}{x_{0.75}}, \\qquad \\frac{x_{0.75} - x_{0.25}}{x_{0.50}}.\n\\]"
  },
  {
    "objectID": "011_loc_scale.html#commenti-e-considerazioni-finali",
    "href": "011_loc_scale.html#commenti-e-considerazioni-finali",
    "title": "4  Indici di posizione e di scala",
    "section": "Commenti e considerazioni finali",
    "text": "Commenti e considerazioni finali\nLe statistiche descrittive ci forniscono degli indici sintetici che riassumono i dati, ovvero le nostre misurazioni dell’intera popolazione o di un campione estratto da una popolazione. Le statistiche descrittive comprendono gli indici di tendenza centrale e gli indici di dispersione. Gli indici di tendenza centrale includono la media, la mediana e la moda, mentre gli indici di dispersione includono lo scarto tipo, la varianza, la curtosi e l’asimmetria.\n\n\n\n\n\n\nZetsche, U., Bürkner, P.-C., & Renneberg, B. (2019). Future expectations in clinical depression: Biased or realistic? Journal of Abnormal Psychology, 128(7), 678–688."
  },
  {
    "objectID": "012_correlation.html",
    "href": "012_correlation.html",
    "title": "5  Le relazioni tra variabili",
    "section": "",
    "text": "Nella loro ricerca, Zetsche et al. (2019) hanno misurato il livello di depressione dei soggetti utilizzando due scale psicometriche: il Beck Depression Inventory II (BDI-II) e la Center for Epidemiologic Studies Depression Scale (CES-D). Il BDI-II è uno strumento self-report che valutare la presenza e l’intensità di sintomi depressivi in pazienti adulti e adolescenti di almeno 13 anni di età con diagnosi psichiatrica mentre la CES-D è una scala self-report progettata per misurare i sintomi depressivi che sono stati vissuti nella settimana precedente nella popolazione generale, specialmente quella degli adolescenti/giovani adulti. Una domanda ovvia che ci può venire in mente è: quanto sono simili le misure ottenute mediante queste due scale?\nÈ chiaro che i numeri prodotti dalle scale BDI-II e CES-D non possono essere identici, e questo per due motivi: (1) la presenza degli errori di misurazione e (2) l’unità di misura delle due variabili. L’errore di misurazione corrompe sempre, almeno in parte, qualunque operazione di misurazione. E questo è vero specialmente in psicologia dove l’attendibilità degli strumenti di misurazione è minore che in altre discipline (quali la fisica, ad esempio). Il secondo motivo per cui i valori delle scale BDI-II e CES-D non possono essere uguali è che l’unità di misura delle due scale è arbitraria. Infatti, qual è l’unità di misura della depressione? Chi può dirlo! Ma, al di là delle differenze derivanti dall’errore di misurazione e dalla differente unità di misura, ci aspettiamo che, se le due scale misurano entrambe lo stesso costrutto, allora i valori prodotti dalle due scale dovranno essere tra loro linearmente associati. Per capire cosa si intende con “associazione lineare” iniziamo a guardare i dati. Per fare questo utilizziamo una rappresentazione grafica che va sotto il nome di diagramma a dispersione."
  },
  {
    "objectID": "012_correlation.html#diagramma-a-dispersione",
    "href": "012_correlation.html#diagramma-a-dispersione",
    "title": "5  Le relazioni tra variabili",
    "section": "\n5.1 Diagramma a dispersione",
    "text": "5.1 Diagramma a dispersione\nIl diagramma di dispersione è la rappresentazione grafica delle coppie di punti individuati da due variabili \\(X\\) e \\(Y\\).\nPer fare un esempio concreto, consideriamo le variabili BDI-II e CES-D di Zetsche et al. (2019). Il diagramma di dispersione per tali variabili si ottiene ponendo, ad esempio, i valori BDI-II sull’asse delle ascisse e quelli del CES-D sull’asse delle ordinate. In tale grafico, fornito dalla Figura 5.1, cascun punto corrisponde ad un individuo del quale, nel caso presente, conosciamo il livello di depressione misurato dalle due scale psicometriche.\nDalla Figura 5.1 possiamo vedere che i dati mostrano una tendenza a disporsi attorno ad una retta – nel gergo statistico, questo fatto viene espresso dicendo che i punteggi CES-D tendono ad essere linearmente associati ai punteggi BDI-II. È ovvio, tuttavia, che tale relazione lineare è lungi dall’essere perfetta – se fosse perfetta, tutti i punti del diagramma a dispersione si disporrebbero esattamente lungo una retta.\n\nCodicedf <- rio::import(\n  here(\"data\", \"data.mood.csv\"),\n  header = TRUE\n)\nbysubj <- df %>%\n  group_by(esm_id, group) %>%\n  summarise(\n    bdi = mean(bdi),\n    cesd = mean(cesd_sum)\n  ) %>%\n  na.omit() %>%\n  ungroup()\nm_cesd <- bysubj %>%\n  dplyr::pull(cesd) %>%\n  mean()\nm_bdi <- bysubj %>%\n  dplyr::pull(bdi) %>%\n  mean()\nFONT_SIZE <- 9\nbysubj %>%\n  ggplot(\n    aes(x = bdi, y = cesd, color = group)\n  ) +\n  geom_point(size = 3, alpha = .9) +\n  geom_hline(yintercept = m_cesd, linetype = \"dashed\", \n             color = \"gray\") +\n  geom_vline(xintercept = m_bdi, linetype = \"dashed\", \n             color = \"gray\") +\n  geom_text(x = -1, y = 16, label = \"I\", color = \"gray\", \n            size = FONT_SIZE) +\n  geom_text(x = 0, y = 46, label = \"IV\", color = \"gray\", \n            size = FONT_SIZE) +\n  geom_text(x = 18, y = 46, label = \"III\", color = \"gray\", \n            size = FONT_SIZE) +\n  geom_text(x = 18, y = 16, label = \"II\", color = \"gray\", \n            size = FONT_SIZE) +\n  labs(\n    x = \"BDI-II\",\n    y = \"CESD\"\n  ) +\n  theme(legend.position = \"none\") +\n  scale_colour_grey(start = 0.7, end = 0)\n\n\n\nFigura 5.1: Associazione tra le variabili BDI-II e CES-D nello studio di Zetsche et al. (2019). In grigio sono rappresentate le osservazioni del gruppo di controllo; in nero quelle dei pazienti."
  },
  {
    "objectID": "012_correlation.html#covarianza",
    "href": "012_correlation.html#covarianza",
    "title": "5  Le relazioni tra variabili",
    "section": "\n5.2 Covarianza",
    "text": "5.2 Covarianza\nIl problema che ci poniamo ora è quello di trovare un indice numerico che descrive di quanto la nube di punti si discosta da una perfetta relazione lineare tra le due variabili, ovvero che descrive la direzione e la forza della relazione lineare tra le due variabili. Ci sono vari indici statistici che possono essere utilizzati a questo scopo.\nIniziamo a considerare il più importante di tali indici, chiamato covarianza. In realtà la definizione di questo indice non ci sorprenderà più di tanto in quanto, in una forma solo apparentemente diversa, l’abbiamo già incontrato in precedenza. Ci ricordiamo infatti che la varianza di una generica variabile \\(X\\) è definita come la media degli scarti quadratici di ciascuna osservazione dalla media:\n\\[\nS_{XX} = \\frac{1}{n} \\sum_{i=1}^n(X_i - \\bar{X}) (X_i - \\bar{X}).\n\\]\nInfatti, la varianza viene talvolta descritta come la “covarianza di una variabile con sé stessa”.\nAdesso facciamo un passo ulteriore. Invece di valutare la dispersione di una sola variabile, chiediamoci come due variabili \\(X\\) e \\(Y\\) “variano insieme” (co-variano). È facile capire come una risposta a tale domanda possa essere fornita da una semplice trasformazione della formula precedente che diventa:\n\\[\nS_{XY} = \\frac{1}{n} \\sum_{i=1}^n(X_i - \\bar{X}) (Y_i - \\bar{Y}).\n\\]\nL’equazione precedente ci fornisce dunque la definizione della covarianza.\nPer capire il significato di tale equazione, supponiamo di dividere il grafico della Figura 5.1 in quattro quadranti definiti da una retta verticale passante per la media dei valori BDI-II e da una retta orizzontale passante per la media dei valori CES-D. Numeriamo i quadranti partendo da quello in basso a sinistra e muovendoci in senso antiorario.\nSe prevalgono punti nel I e III quadrante, allora la nuvola di punti avrà un andamento crescente (per cui a valori bassi di \\(X\\) tendono ad associarsi valori bassi di \\(Y\\) e a valori elevati di \\(X\\) tendono ad associarsi valori elevati di \\(Y\\)) e la covarianza segno positivo. Mentre se prevalgono punti nel II e IV quadrante la nuvola di punti avrà un andamento decrescente (per cui a valori bassi di \\(X\\) tendono ad associarsi valori elevati di \\(Y\\) e a valori elevati di \\(X\\) tendono ad associarsi valori bassi di \\(Y\\)) e la covarianza segno negativo. Dunque, il segno della covarianza ci informa sulla direzione della relazione lineare tra due variabili: l’associazione lineare si dice positiva se la covarianza è positiva, negativa se la covarianza è negativa.\nIl segno della covarianza ci informa sulla direzione della relazione, ma invece il valore assoluto della covarianza ci dice ben poco. Esso, infatti, dipende dall’unità di misura delle variabili. Nel caso presente questo concetto è difficile da comprendere, dato che le due variabili in esame non hanno un’unità di misura (ovvero, hanno un’unità di misura arbitraria e priva di significato). Ma quest’idea diventa chiara se pensiamo alla relazione lineare tra l’altezza e il peso delle persone, ad esempio. La covarianza tra queste due quantità è certamente positiva, ma il valore assoluto della covarianza diventa più grande se l’altezza viene misurata in millimetri e il peso in grammi, e diventa più piccolo l’altezza viene misurata in metri e il peso in chilogrammi. Dunque, il valore della covarianza cambia al mutare dell’unità di misura delle variabili anche se l’associazione tra le variabili resta costante."
  },
  {
    "objectID": "012_correlation.html#correlazione",
    "href": "012_correlation.html#correlazione",
    "title": "5  Le relazioni tra variabili",
    "section": "\n5.3 Correlazione",
    "text": "5.3 Correlazione\nDato che il valore assoluto della covarianza è di difficile interpretazione – in pratica, non viene mai interpretato – è necessario trasformare la covarianza in modo tale da renderla immune alle trasformazioni dell’unità di misura delle variabili. Questa operazione si dice standardizzazione e corrisponde alla divisione della covarianza per le deviazioni standard (\\(s_X\\), \\(s_Y\\)) delle due variabili:\n\\[\nr_{XY} = \\frac{S_{XY}}{s_X s_Y}.\n\\]\nLa quantità che si ottiene in questo modo viene chiamata correlazione di Bravais-Pearson (dal nome degli autori che, indipendentemente l’uno dall’altro, la hanno introdotta).\nIl coefficiente di correlazione ha le seguenti proprietà:\n\nha lo stesso segno della covarianza, dato che si ottiene dividendo la covarianza per due numeri positivi;\nè un numero puro, cioè non dipende dall’unità di misura delle variabili;\nassume valori compresi tra -1 e +1.\n\nAd esso possiamo assegnare la seguente interpretazione:\n\n\n\\(r_{XY} = -1\\) \\(\\rightarrow\\) perfetta relazione negativa: tutti i punti si trovano esattamente su una retta con pendenza negativa (dal quadrante in alto a sinistra al quadrante in basso a destra);\n\n\\(r_{XY} = +1\\) \\(\\rightarrow\\) perfetta relazione positiva: tutti i punti si trovano esattamente su una retta con pendenza positiva (dal quadrante in basso a sinistra al quadrante in alto a destra);\n\n\\(-1 < r_{XY} < +1\\) \\(\\rightarrow\\) presenza di una relazione lineare di intensità diversa;\n\n\\(r_{XY} = 0\\) \\(\\rightarrow\\) assenza di relazione lineare tra \\(X\\) e \\(Y\\).\n\n\nPer i dati della Figura 5.1, la covarianza è 207.426. Il segno positivo della covarianza ci dice che tra le due variabili c’è un’associazione lineare positiva. Per capire qual è l’intensità della relazione lineare tra le due variabili calcoliamo la correlazione. Essendo le deviazioni standard del BDI-II e del CES-D rispettavamente uguali a 15.37 e 14.93, la correlazione diventa uguale a \\(\\frac{207.426}{15.38 \\cdot 14.93} = 0.904.\\) Tale valore è prossimo a 1.0, il che vuol dire che i punti del diagramma a dispersione non si discostano troppo da una retta con una pendenza positiva."
  },
  {
    "objectID": "012_correlation.html#correlazione-e-causazione",
    "href": "012_correlation.html#correlazione-e-causazione",
    "title": "5  Le relazioni tra variabili",
    "section": "\n5.4 Correlazione e causazione",
    "text": "5.4 Correlazione e causazione\nFacendo riferimento nuovamente alla Figura 5.1, possiamo dire che, in molte applicazioni (ma non nel caso presente!) l’asse \\(x\\) rappresenta una quantità nota come variabile indipendente e l’interesse si concentra sulla sua influenza sulla variabile dipendente tracciata sull’asse \\(y\\). Ciò presuppone però che sia nota la direzione in cui l’influenza causale potrebbe risiedere. È importante tenere bene a mente che la correlazione è soltanto un indice descrittivo della relazione lineare tra due variabili e in nessun caso può essere usata per inferire alcunché sulle relazioni causali che legano le variabili. È ben nota l’espressione: “correlazione non significa causazione”.\nDi opinione diversa era invece Karl Pearson (1911), il quale ha affermato:\n\nQuanto spesso, quando è stato osservato un nuovo fenomeno, sentiamo che viene posta la domanda: ‘qual è la sua causa?’. Questa è una domanda a cui potrebbe essere assolutamente impossibile rispondere. Invece, può essere più facile rispondere alla domanda: ‘in che misura altri fenomeni sono associati con esso?’. Dalla risposta a questa seconda domanda possono risultare molte preziose conoscenze.\n\nChe alla seconda domanda posta da Pearson sia facile rispondere è indubbio. Che la nostra comprensione di un fenomeno possa aumentare sulla base delle informazioni fornite unicamente dalle correlazioni, invece, è molto dubbio e quasi certamente falso."
  },
  {
    "objectID": "012_correlation.html#usi-della-correlazione",
    "href": "012_correlation.html#usi-della-correlazione",
    "title": "5  Le relazioni tra variabili",
    "section": "\n5.5 Usi della correlazione",
    "text": "5.5 Usi della correlazione\nAnche se non può essere usata per studiare le relazioni causali, la correlazione viene usata per molti altri scopi tra i quali, per esempio, quello di misurare la validità concorrente di un test psiologico. Se un test psicologico misura effettivamente ciò che ci si aspetta che misuri (nel caso dell’esempio presente, la depressione), allora dovremo aspettarci che fornisca una correlazione alta con risultati di altri test che misurano lo stesso costrutto – come nel caso dei dati di (Zetsche et al., 2019). Un’altra proprietà desiderabile di un test psicometrico è la validità divergente: i risultati di test psicometrici che misurano costrutti diversi dovrebbero essere poco associati tra loro. In altre parole, in questo secondo caso dovremmo aspettarci che la correlazione sia bassa."
  },
  {
    "objectID": "012_correlation.html#correlazione-di-spearman",
    "href": "012_correlation.html#correlazione-di-spearman",
    "title": "5  Le relazioni tra variabili",
    "section": "\n5.6 Correlazione di Spearman",
    "text": "5.6 Correlazione di Spearman\nUna misura alternativa della relazione lineare tra due variabili è fornita dal coefficiente di correlazione di Spearman e dipende soltanto dalla relazione d’ordine dei dati, non dagli specifici valori dei dati. Tale misura di associazione è appropriata quando, del fenomeno in esame, gli psicologi sono stati in grado di misurare soltanto le relazioni d’ordine tra le diverse modalità della risposta dei soggetti, non l’intensità della risposta. Le variabili psicologiche che hanno questa proprietà si dicono ordinali. Nel caso di variabili ordinali, non è possibile sintetizzare i dati mediante le statistiche descrittive che abbiamo introdotto in questo capitolo, quali ad esempio la media e la varianza, ma è invece solo possibile riassumere i dati mediante una distribuzione di frequenze per le varie modalità della risposta."
  },
  {
    "objectID": "012_correlation.html#correlazione-nulla",
    "href": "012_correlation.html#correlazione-nulla",
    "title": "5  Le relazioni tra variabili",
    "section": "\n5.7 Correlazione nulla",
    "text": "5.7 Correlazione nulla\nUn ultimo aspetto da mettere in evidenza a proposito della correlazione riguarda il fatto che la correlazione descrive la direzione e l’intensità della relazione lineare tra due variabili. Relazioni non lineari tra le variabili, anche se sono molto forti, non vengono catturate dalla correlazione. È importante rendersi conto che una correlazione pari a zero non significa che non c’è relazione tra le due variabili, ma solo che tra esse non c’è una relazione lineare.\n\nLa Figura 5.2 fornisce un esempio di correlazione nulla in presenza di una chiara relazione (non lineare) tra due variabili.\n\n\n\n\nFigura 5.2: Due insiemi di dati (fittizi) per i quali i coefficienti di correlazione di Pearson sono entrambi 0. Ma questo non significa che non vi sia alcuna relazione tra le variabili."
  },
  {
    "objectID": "012_correlation.html#commenti-e-considerazioni-finali",
    "href": "012_correlation.html#commenti-e-considerazioni-finali",
    "title": "5  Le relazioni tra variabili",
    "section": "Commenti e considerazioni finali",
    "text": "Commenti e considerazioni finali\nLa prima fase dell’analisi dei dati riassume i dati mediante gli strumenti della statistica descrittiva. Le tipiche domande che vengono affrontate in questa fase sono: qual è la distribuzione delle variabili di interesse? Quali relazioni a coppie si possono osservare nel campione? Ci sono delle osservazioni ‘anomale’, ovvero estremamente discrepanti rispetto alle altre, sia quando si esaminano le statistiche descrittive univariate (ovvero, quelle che riguardano le caratteristiche di una variabile presa singolarmente), sia quando vengono esaminate le statistiche bivariate (ovvero, le statistiche che descrivono l’associazione tra le variabili)? È importante avere ben chiare le idee su questi punti prima di procedere con qualsiasi procedura statistica di tipo inferenziale. Per rispondere alle domande che abbiamo elencato sopra, ed ad altre simili, è molto utile procedere con delle rappresentazioni grafiche dei dati. È chiaro che, quando disponiamo di grandi moli di dati (come è sempre il caso in psicologia), l’analisi descrittiva dei dati deve essere svolta mediante un software statistico.\n\n\n\n\n\n\nZetsche, U., Bürkner, P.-C., & Renneberg, B. (2019). Future expectations in clinical depression: Biased or realistic? Journal of Abnormal Psychology, 128(7), 678–688."
  },
  {
    "objectID": "prob.html",
    "href": "prob.html",
    "title": "Parte 2: Il calcolo delle probabilità",
    "section": "",
    "text": "Nel capitolo Capitolo 6 verrà presentata la legge dei grandi numeri, il concetto di variabile casuale e la funzione di massa di probabilità."
  },
  {
    "objectID": "015_prob_intro.html",
    "href": "015_prob_intro.html",
    "title": "6  La logica dell’incerto",
    "section": "",
    "text": "In questa parte della dispensa verrà introdotta la teoria delle probabilità. Prima di entrare nei dettagli, cerchiamo di capire perché la probabilità sia cruciale per la ricerca scientifica.\nLa teoria delle probabilità è cruciale per la scienza perché la ricerca procede mediante l’inferenza induttiva. Non siamo mai completamente sicuri della verità di una proposizione (ipotesi, teoria): al valore di verità di una proposizione possiamo solo assegnare un giudizio probabilistico. L’approccio bayesiano è una scuola di pensiero che usa la probabilità per quantificare il grado di fiducia che può essere attribuito ad una proposizione. L’inferenza statistica bayesiana è un tipo di inferenza induttiva che ha lo scopo di quantificare la fiducia che si ha nell’ipotesi \\(H\\) dopo il verificarsi del dato d’evidenza \\(E\\). Per quantificare un tale grado di fiducia l’inferenza statistica bayesiana utilizza la teoria delle probabilità. Una comprensione dell’inferenza statistica bayesiana richiede dunque, preliminarmente, la conoscenze della teoria delle probabilità."
  },
  {
    "objectID": "015_prob_intro.html#che-cosè-la-probabilità",
    "href": "015_prob_intro.html#che-cosè-la-probabilità",
    "title": "6  La logica dell’incerto",
    "section": "\n6.1 Che cos’è la probabilità?",
    "text": "6.1 Che cos’è la probabilità?\nLa definizione della probabilità è un problema estremamente dibattuto ed aperto. Sono state fornite due possibili soluzioni al problema di definire il concetto di probabilità.\n\nLa natura della probabilità è “ontologica” (ovvero, basata sulla metafisica): la probabilità è una proprietà della della realtà, del mondo, di come sono le cose, indipendentemente dalla nostra esperienza. È una visione che qualcuno chiama “oggettiva”.\nLa natura della probabilità è “epistemica” (ovvero, basata sulla conoscenza): la probabilità si riferisce alla conoscenza che abbiamo del mondo, non al mondo in sé. Di conseguenza è detta, in contrapposizione alla precedente definizione, “soggettiva”.\n\nIn termini epistemici, la probabilità fornisce una misura della nostra incertezza sul verificarsi di un fenomeno, alla luce delle informazioni disponibili. Potremmo dire che c’è una “scala” naturale che ha per estremi il vero (1: evento certo) da una parte ed il falso (0: evento impossibile) dall’altra. La probabilità è la quantificazione di questa scala: descrive lo stato della nostra incertezza rispetto al contenuto di verità di una proposizione.\nL’incertezza nelle nostre previsioni può sorgere per due ragioni fondamentalmente diverse. Il primo è dovuto alla nostra ignoranza delle cause nascoste sottostanti o dei meccanismi che generano i dati. Questa è appunto un’incertezza epistemica. Il secondo tipo di incertezza deriva dalla variabilità intrinseca dei fenomeni, che non può essere ridotta anche se raccogliamo più dati. Questa seconda forma di incertezza è talvolta chiamata aleatoria. Come esempio concreto, consideriamo il lancio di una moneta equilibrata. Sappiamo con certezza che la probabilità di testa è \\(P = 0.5\\), quindi non c’è incertezza epistemica, ma non questo non è sufficiente per prevedere con certezza il risultato – ovvero, l’incertezza aleatoria persiste anche in assenza di incertezza epistemica.\nNell’interpretazione frequentista, la probabilità \\(P(E)\\) rappresenta la frequenza relativa a lungo termine di un grande numero di ripetizioni di un esperimento casuale sotto le medesime condizioni. Viene stressata qui l’idea che ciò di cui parliamo è qualcosa che emerge nel momento in cui è possibile ripetere l’esperimento casuale tante volte sotto le medesime condizioni – sono invece esclusi gli eventi unici e irripetibili.\n\n\nL’interpretazione bayesiana della probabilità fa invece ricorso ad una concezione più ampia, non legata al solo evento in sé ma che include anche il soggetto assegnante la funzione di probabilità. In pratica l’assegnazione di probabilità bayesiana viene effettuata dal decisore, in base alle proprie conoscenze a priori integrate con tutto il generico bagaglio culturale personale. In questo modo, la probabilità non sarà obbligatoriamente la stessa per tutti i soggetti, ma variarierà a seconda delle informazioni a disposizione, dell’esperienza personale e soprattutto del punto di vista proprio di ogni decisore ed è dunque assimilabile al “grado di fiducia” – in inglese degree of belief – di un dato soggetto, in un dato istante e con un dato insieme d’informazioni, circa l’accadere dell’evento \\(E\\). “[N]essuna scienza ci permetterà di dire: il tale fatto accadrà, andrà così e così, perché ciò è conseguenza di tale legge, e tale legge è una verità assoluta, ma tanto meno ci condurrà a concludere scetticamente: la verità assoluta non esiste, e quindi tale fatto può accadere e può non accadere, può andare così e può andare in tutt’altro modo, nulla io ne so. Quel che si potrà dire è questo: io prevedo che il tale fatto avverrà, e avverrà nel tal modo, perché l’esperienza del passato e l’elaborazione scientifica cui il pensiero dell’uomo l’ha sottoposta mi fanno sembrare ragionevole questa previsione” (Finetti, 1931).\nL’impostazione bayesiana, sviluppata da Ramsey e de Finetti, riconduce l’assegnazione di probabilità allo scommettere sul verificarsi di un evento: la probabilità di un evento \\(E\\) è la quota \\(p(E)\\) che un individuo reputa di dover pagare ad un banco per ricevere “1” ovvero “0” verificandosi o non verificandosi \\(E\\).\nSecondo De Finetti, le valutazioni di probabilità degli eventi devono rispondere ai principi di equità e coerenza. Una scommessa risponde al principio di equità se il ruolo di banco e giocatore sono scambiabili in ogni momento del gioco e sempre alle stesse condizioni. Una scommessa risponde al principio di coerenza se non vi sono combinazioni di scommesse che consentano (sia al banco che al giocatore) di realizzare perdite o vincite certe.\nL’approccio definettiano dell’impostazione della scommessa si basa dunque sulle assunzioni di razionalità e coerenza del decisore, al quale è fatto esplicito divieto di effettuare scommesse a perdita o guadagno certo. Il decisore, proponendo la scommessa, deve essere disposto a scambiare il posto dello scommettitore con quello del banco.\nIl metodo della scommessa, oltre che una definizione, fornisce un mezzo operativo di assegnazione della probabilità. Sulla base di questa definizione operativa, che si può ritenere ragionevolmente soddisfatta dal comportamento di un qualunque individuo che agisca in modo razionale in condizioni di incertezza, possono essere agevolmente dimostrate tutte le proprietà classiche della probabilità: essa non può assumere valori negativi, né può essere superiore all’unità; se \\(E\\) è un evento certo, la sua probabilità è 1; se invece \\(E\\) è un evento impossibile, la sua probabilità è 0.\nI problemi posti dall’approccio definettiano riguardano l’arbitrarietà dell’assegnazione soggettività di probabilità la quale sembra negare la validità dell’intero costrutto teorico. In risposta a tale critica, i bayesiani sostengono che gli approcci oggettivisti alla probabilità nascondono scelte arbitrarie preliminari e sono basate su assunzioni implausibili. È molto più onesto esplicitare subito tutte le scelte arbitrarie effettuate nel corso dell’analisi in modo da controllarne coerenza e razionalità."
  },
  {
    "objectID": "015_prob_intro.html#variabili-casuali-e-probabilità-di-un-evento",
    "href": "015_prob_intro.html#variabili-casuali-e-probabilità-di-un-evento",
    "title": "6  La logica dell’incerto",
    "section": "\n6.2 Variabili casuali e probabilità di un evento",
    "text": "6.2 Variabili casuali e probabilità di un evento\nEsaminiamo qui di seguito alcuni concetti di base della teoria delle probabilità, la quale può essere vista come un’estensione della logica.\n\n6.2.1 Eventi e probabilità\nNella teoria delle probabilità il risultato “testa” nel lancio di una moneta è chiamato evento.1 Un evento, denotato da una variabile binaria, corrisponde ad uno stato del mondo che si verifica oppure no. Ad esempio, \\(Y\\) = 1 può denotare l’evento per cui il lancio di una moneta produce il risultato testa. Il funzionale \\(P(Y)\\) denota la probabilità con cui si ritiene che l’evento \\(Y\\) sia vero (o la proporzione di volte che si verifica tale evento osservando a lungo termine delle ripetizioni indipendenti di un esperimento casuale). Ad esempio, per il lancio di una moneta equilibrata, la probabilità dell’evento “il risultato del lancio della moneta è testa” è scritta come \\(P(Y = 1) = 0.5.\\)\nSe la moneta è equilibrata dobbiamo anche avere \\(P(Y = 0) = 0.5\\). I due eventi Y = 1 e \\(Y\\) = 0 sono mutuamente esclusivi nel senso che non possono entrambi verificarsi contemporaneamente: \\(P(Y = 1\\; \\land \\; Y = 0) = 0.\\) Gli eventi \\(Y\\) = 1 e \\(Y\\) = 0 di dicono esaustivi, nel senso che almeno uno di essi deve verificarsi e nessun altro tipo di evento è possibile. Nella notazione probabilistica, \\(P(Y = 1\\; \\lor \\; Y = 0) = 1.\\) Il connettivo logico “o” (\\(\\lor\\)) specifica eventi disgiunti, ovvero eventi che non possono verificarsi contemporaneamente (eventi incompatibili) e per i quali, perciò, la probabilità della loro congiunzione è \\(P(A \\; \\land \\; B) = 0\\). Il connettivo logico “e” (\\(\\land\\)), invece, specifica eventi congiunti, ovvero eventi che possono verificarsi contemporaneamente (eventi compatibili) e per i quali, perciò, la probabilità della loro congiunzione è \\(P(A \\; \\land \\; B) > 0\\). La probabilità del verificarsi di due eventi congiunti \\(A\\) e \\(B\\) si può denotare, in maniera equivalente, con la notazione precedente, oppure con \\(P(A \\cap B)\\), oppure con \\(P(A, B)\\).\nSi richiede che \\(0 \\leq P(A) \\leq 1\\), dove \\(P(A) = 0\\) denota l’evento impossibile e \\(P(A) = 1\\) denota l’evento certo. Scriviamo \\(P(\\lnot A)\\) o \\(P(\\bar{A})\\) per denotare la probabilità che l’evento \\(A\\) non avvenga; questa probabilità è definita come \\(P(\\bar{A}) = 1 − P(A)\\).\n\n6.2.2 Spazio campione e risultati possibili\nAnche se il lancio di una moneta produce sempre uno specifico risultato nel mondo reale, possiamo anche immaginare i possibili risultati alternativi che si sarebbero potuti osservare. Quindi, anche se in uno specifico lancio la moneta dà testa (\\(Y\\) = 1), possiamo immaginare la possibilità che il lancio possa avere prodotto croce (\\(Y\\) = 0). Tale ragionamento controfattuale è la chiave per comprendere la teoria delle probabilità e l’inferenza statistica.\nI risultati possibili che si possono osservare come conseguenza del lancio di una moneta determinano i valori possibili che la variabile casuale può assumere. L’insieme \\(\\Omega\\) di tutti i risultati possibili è chiamato spazio campione (sample space). Lo spazio campione può essere concettualizzato come un’urna contenente una pallina per ogni possibile risultato del lancio della moneta. Su ogni pallina è scritto il valore della variabile casuale. Uno specifico lancio di una moneta – ovvero, l’osservazione di uno specifico valore di una variabile casuale – è chiamato esperimento casuale.\nIl lancio di un dado ci fornisce l’esempio di un altro esperimento casuale. Supponiamo di essere interessati all’evento “il lancio del dado produce un numero dispari”. Un evento seleziona un sottoinsieme dello spazio campione: in questo caso, l’insieme dei risultati \\(\\{1, 3, 5\\}\\). Se esce 3, per esempio, diciamo che si è verificato l’evento “dispari” (ma l’evento “dispari” si sarebbe anche verificato anche se fosse uscito 1 o 5)."
  },
  {
    "objectID": "015_prob_intro.html#variabili-casuali",
    "href": "015_prob_intro.html#variabili-casuali",
    "title": "6  La logica dell’incerto",
    "section": "\n6.3 Variabili casuali",
    "text": "6.3 Variabili casuali\nSia \\(Y\\) il risultato del lancio di moneta equilibrata, non di un generico lancio di una moneta, ma un’istanza specifica del lancio di una specifica moneta in un dato momento. Definita in questo modo, \\(Y\\) è una variabile casuale, ovvero una variabile i cui valori non possono essere previsti con esattezza. Se la moneta è equilibrata, c’è una probabilità del 50% che il lancio della moneta dia come risultato “testa” e una probabilità del 50% che dia come risultato “croce”. Per facilitare la trattazione, le variabili casuali assumono solo valori numerici. Per lo specifico lancio della moneta in questione, diciamo, ad esempio, che la variabile casuale \\(Y\\) assume il valore 1 se esce testa e il valore 0 se esce croce.\nUna variabile casuale può essere discreta o continua. Una variabile casuale discreta può assumere un numero finito di valori \\(x_1, \\dots ,x_n\\), in corrispondenza degli eventi \\(E_i, \\dots, E_n\\) che si verificano con le rispettive probabilità \\(p_1, \\dots, p_n\\). Un esempio è il punteggio totale di un test psicometrico costituito da item su scala Likert. Invece un esempio di una variabile casuale continua è la distanza tra due punti, che può assumere infiniti valori all’interno di un certo intervallo. L’insieme \\(S\\) dei valori che la variabile casuale può assumere è detto spazio dei valori o spazio degli stati.\nLa caratteristica fondamentale di una variabile casuale è data dall’insieme delle probabilità dei suoi valori, detta distribuzione di probabilità. Nel seguito useremo la notazione \\(P(\\cdot)\\) per fare riferimento alle distribuzioni di probabilità delle variabili casuali discrete e \\(p(\\cdot)\\) per fare riferimento alla densità di probabilità delle variabili casuali continue. In questo contesto, l’insieme dei valori che la variabile casuale può assumere è detto supporto della sua distribuzione di probabilità. Il supporto di una variabile casuale può essere finito (come nel caso di una variabile casuale uniforme di supporto \\([a, b]\\)) o infinito (nel caso di una variabile causale gaussiana il cui supporto coincide con la retta reale)."
  },
  {
    "objectID": "015_prob_intro.html#usare-la-simulazione-per-stimare-le-probabilità",
    "href": "015_prob_intro.html#usare-la-simulazione-per-stimare-le-probabilità",
    "title": "6  La logica dell’incerto",
    "section": "\n6.4 Usare la simulazione per stimare le probabilità",
    "text": "6.4 Usare la simulazione per stimare le probabilità\n\nIn questa dispensa verrà adottata l’interpretazione bayesiana delle probabilità. Tuttavia, le regole di base della teoria delle probabilità sono le stesse, indipendentemente dall’interpretazione adottata. Pertanto, negli esempi seguenti, possiamo utilizzare la simulazione per stimare le probabilità degli eventi in un modo diretto, ovvero mediante la generazione di molteplici osservazioni delle variabili casuali derivate dagli eventi di interesse.\nAd esempio, per simulare in R il lancio di una moneta equilibrata iniziamo con il definire un vettore che contiene i risultati possibili del lancio della moneta (ovvero i valori possibili della variabile casuale \\(Y\\)):\n\nCodicecoin <- c(0, 1)\n\n\nL’estrazione casuale di uno di questi due possibili valori (ovvero, la simulazione di uno specifico lancio di una moneta) si realizza con la funzione sample():\n\nCodicesample(coin, size = 1)\n#> [1] 0\n\n\nIn maniera equivalente, la stessa operazione si può realizzare mediante l’istruzione\n\nCodicerbinom(1, 1, 0.5)\n#> [1] 1\n\n\nSupponiamo di ripetere questo esperimento casuale 100 volte e di registrare i risultati così ottenuti. La stima della probabilità dell’evento \\(P(Y = 1)\\) è data dalla frequenza relativa del numero di volte in cui abbiamo osservato l’evento di interesse (\\(Y = 1\\)):\n\nCodiceM <- 100\ny <- rep(NA, M)\nfor (m in 1:M) {\n  y[m] = rbinom(1, 1, 0.5)\n}\nestimate = sum(y) / M\n\ncat(\"estimated P[Y = 1] =\", estimate)\n#> estimated P[Y = 1] = 0.53\n\n\nRipetiamo questa procedura 10 volte.\n\nCodiceflip_coin <- function(M) {\n  y <- rep(NA, M)\n  for (m in 1:M) {\n    y[m] = rbinom(1, 1, 0.5)\n  }\n  estimate <- sum(y) / M\n  cat(\"estimated P[Y = 1] =\", estimate, \"\\n\")\n}\n\n\n\nCodicefor(i in 1:10) {\n  flip_coin(100)\n}\n#> estimated P[Y = 1] = 0.44 \n#> estimated P[Y = 1] = 0.52 \n#> estimated P[Y = 1] = 0.46 \n#> estimated P[Y = 1] = 0.57 \n#> estimated P[Y = 1] = 0.47 \n#> estimated P[Y = 1] = 0.46 \n#> estimated P[Y = 1] = 0.48 \n#> estimated P[Y = 1] = 0.49 \n#> estimated P[Y = 1] = 0.47 \n#> estimated P[Y = 1] = 0.62\n\n\nDato che la moneta è equilibrata, la stima delle probabilità dell’evento \\(P(Y = 1)\\) è simile a al valore che ci aspettiamo, ovvero \\(P(Y = 1) = 0.5\\), ma il risultato ottenuto nelle simulazioni non è esatto. Proviamo ad aumentare il numero di lanci in ciascuna simulazione:\n\nCodicefor(i in 1:10) {\n  flip_coin(1000)\n}\n#> estimated P[Y = 1] = 0.497 \n#> estimated P[Y = 1] = 0.529 \n#> estimated P[Y = 1] = 0.493 \n#> estimated P[Y = 1] = 0.511 \n#> estimated P[Y = 1] = 0.506 \n#> estimated P[Y = 1] = 0.52 \n#> estimated P[Y = 1] = 0.49 \n#> estimated P[Y = 1] = 0.495 \n#> estimated P[Y = 1] = 0.489 \n#> estimated P[Y = 1] = 0.496\n\n\nIn questo secondo caso, gli errori tendono ad essere più piccoli che nel caso precedente. Cosa succede se in ciascuna simulazione esaminiamo i risultati di 10,000 lanci della moneta?\n\nCodicefor(i in 1:10) {\n  flip_coin(1e4)\n}\n#> estimated P[Y = 1] = 0.4885 \n#> estimated P[Y = 1] = 0.4957 \n#> estimated P[Y = 1] = 0.4902 \n#> estimated P[Y = 1] = 0.5032 \n#> estimated P[Y = 1] = 0.5048 \n#> estimated P[Y = 1] = 0.4931 \n#> estimated P[Y = 1] = 0.4965 \n#> estimated P[Y = 1] = 0.499 \n#> estimated P[Y = 1] = 0.4979 \n#> estimated P[Y = 1] = 0.4973\n\n\nOra le stime ottenute sono molto vicine alla vera probabilità che vogliamo stimare (cioè 0.5, perché la moneta è equilibrata).\nI risultati delle simulazioni precedenti pongono dunque il problema di determinare quale sia il numero di lanci di cui abbiamo bisogno per assicurarci che le stime siano accurate (ovvero, vicine al valore corretto della probabilità)"
  },
  {
    "objectID": "015_prob_intro.html#la-legge-dei-grandi-numeri",
    "href": "015_prob_intro.html#la-legge-dei-grandi-numeri",
    "title": "6  La logica dell’incerto",
    "section": "\n6.5 La legge dei grandi numeri",
    "text": "6.5 La legge dei grandi numeri\nLa visualizzazione mediante grafici contribuisce alla comprensione dei concetti della statistica e della teoria delle probabilità. Un modo per descrivere ciò che accade all’aumentare del numero \\(M\\) di ripetizioni del lancio della moneta consiste nel registrare la stima della probabilità dell’evento \\(P(Y = 1)\\) in funzione del numero di ripetizioni dell’esperimento casuale per ogni \\(m \\in 1:M\\). Possiamo ottenere un grafico dell’andamento della stima di \\(P(Y = 1)\\) in funzione di \\(m\\) nel modo seguente:\n\nCodicenrep <- 1e4\nestimate <- rep(NA, nrep)\nflip_coin <- function(m) {\n  y <- rbinom(m, 1, 0.5)\n  phat <- sum(y) / m\n  phat\n}\nfor(i in 1:nrep) {\n  estimate[i] <- flip_coin(i)\n}\nd <- tibble(\n  n = 1:nrep, \n  estimate\n)\nd %>% \n  ggplot(aes(x = n, y = estimate)) +\n  geom_line() +\n  labs(\n    x = \"Numero di lanci della moneta\", \n    y = \"Stima di P(Y = 1)\"\n)\n\n\n\nFigura 6.1: Stima della probabilità di successo in funzione del numero dei lanci di una moneta.\n\n\n\n\nLa Figura 6.1, quando è espressa su una scala lineare, non rivela chiaramente l’andamento della simulazione. Imponiamo dunque una scala logaritmica sull’asse delle ascisse (\\(x\\)). Su scala logaritmica, i valori tra 1 e 10 vengono tracciati all’incirca con la stessa ampiezza che si osserva tra i valori 50 e 700, eccetera.\n\nCodiced %>%\n  ggplot(aes(x = n, y = estimate)) +\n  geom_line() +\n  geom_hline(\n    yintercept = 0.5, color = \"gray\", size = 1\n  ) +\n  scale_x_log10(\n    breaks = c(\n      1, 3, 10, 50, 200,\n      700, 2500, 10000\n    )\n  ) +\n  labs(\n    x = \"Numero dei lanci della moneta (scala logaritmica)\",\n    y = \"Stima di P(Y = 1)\"\n  )\n\n\n\nFigura 6.2: Stima della probabilità di successo in funzione del numero dei lanci di una moneta.\n\n\n\n\nLa legge dei grandi numeri ci dice che, all’aumentare del numero di ripetizioni dell’esperimento casuale, la media dei risultati ottenuti tende al valore atteso, man mano che vengono eseguite più prove. Nella figura Figura 6.2 vediamo infatti che, all’aumentare del numero M di lanci della moneta, la stima di \\(P(Y = 1)\\) converge al valore 0.5."
  },
  {
    "objectID": "015_prob_intro.html#variabili-casuali-multiple",
    "href": "015_prob_intro.html#variabili-casuali-multiple",
    "title": "6  La logica dell’incerto",
    "section": "\n6.6 Variabili casuali multiple",
    "text": "6.6 Variabili casuali multiple\nLe variabili casuali non esistono isolatamente. Abbiamo iniziato con una sola variabile casuale \\(Y\\) che rappresenta il risultato di un singolo, specifico lancio di una moneta equlibrata. Ma supponiamo ora di lanciare la moneta tre volte. I risultati di ciascuno dei tre lanci possono essere rappresentati da una diversa variabile casuale, ad esempio, \\(Y_1 , Y_2 , Y_3\\). Possiamo assumere che ogni lancio sia indipendente, ovvero che non dipenda dal risultato degli altri lanci. Per ciascuna di queste variabili \\(Y_n\\), con \\(n \\in 1:3\\), abbiamo che \\(P(Y_n =1)=0.5\\) e \\(P(Y_n =0)=0.5\\).\nÈ possibile combinare più variabili casuali usando le operazioni aritmetiche. Se \\(Y_1 , Y_2, Y_3\\) sono variabili casuali che rappresentano tre lanci di una moneta equilibrata (o un lancio di tre monete equilibrate), possiamo definire la somma di tali variabili casuali come\n\\[\nZ = Y_1 + Y_2 + Y_3.\n\\]\nPossiamo simulare i valori assunti dalla variabile casuale Z simulando i valori di \\(Y_1, Y_2, Y_3\\) per poi sommarli.\n\nCodicey1 <- rbinom(1, 1, 0.5)\ny2 <- rbinom(1, 1, 0.5)\ny3 <- rbinom(1, 1, 0.5)\nc(y1, y2, y3)\n#> [1] 1 0 1\nz <- sum(c(y1, y2, y3))\ncat(\"z =\", z, \"\\n\")\n#> z = 2\n\n\novvero,\n\nCodicey <- rep(NA, 3)\nfor (i in 1:3) {\n  y[i] <- rbinom(1, 1, 0.5)\n}\ny\n#> [1] 0 1 1\nz <- sum(y)\ncat(\"z =\", z, \"\\n\")\n#> z = 2\n\n\noppure, ancora più semplicemente:\n\nCodicey <- rbinom(3, 1, 0.5)\ny\n#> [1] 1 0 1\nz <- sum(y)\ncat(\"z =\", z, \"\\n\")\n#> z = 2\n\n\nPossiamo ripetere questa simulazione \\(M = 1e5\\) volte:\n\nCodiceM <- 1e5\nz <- rep(NA, M)\nfor(i in 1:M) {\n  y <- rbinom(3, 1, 0.5)\n  z[i] <- sum(y)\n}\n\n\ne calcolare una stima della probabilità che la variabile casuale \\(Z\\) assuma ciascuno dei possibili valori 0, 1, 2, 3:\n\nCodicetable(z) / M\n#> z\n#>       0       1       2       3 \n#> 0.12585 0.37495 0.37480 0.12440\n\n\nNel caso di 4 monete equilibrate, avremo:\n\nCodiceM <- 1e5\nz <- rep(NA, M)\nfor(i in 1:M) {\n  y <- rbinom(4, 1, 0.5)\n  z[i] <- sum(y)\n}\ntable(z) / M\n#> z\n#>       0       1       2       3       4 \n#> 0.06340 0.24917 0.37360 0.25022 0.06361\n\n\nUna variabile casuale le cui modalità possono essere costituite solo da numeri interi è detta variabile casuale discreta:\n\\[\n\\mathbb{Z} = \\dots, -2, -1, 0, 1, 2, \\dots\n\\]"
  },
  {
    "objectID": "015_prob_intro.html#sec:fun-mass-prob",
    "href": "015_prob_intro.html#sec:fun-mass-prob",
    "title": "6  La logica dell’incerto",
    "section": "\n6.7 Funzione di massa di probabilità",
    "text": "6.7 Funzione di massa di probabilità\nÈ conveniente avere una funzione che associa una probabilità a ciascun possibile valore di una variabile casuale. In generale, ciò è possibile se e solo se la variabile casuale è discreta, così com’è stata definita nel Paragrafo precedente. Ad esempio, se consideriamo \\(Z = Y_1 + \\dots + Y_4\\) come, ad esempio, il numero di risultati “testa” in 4 lanci della moneta, allora possiamo definire la seguente funzione:\n\\[\n\\begin{array}{rclll}\np_Z(0) & = & 1/16 & & \\mathrm{TTTT}\n\\\\\np_Z(1) & = & 4/16 & & \\mathrm{HTTT, THTT, TTHT, TTTH}\n\\\\\np_Z(2) & = & 6/16 & & \\mathrm{HHTT, HTHT, HTTH, THHT, THTH, TTTH}\n\\\\\np_Z(3) & = & 4/16 & & \\mathrm{HHHT, HHTH, HTHH, THHH}\n\\\\\np_Z(4) & = & 1/16 & & \\mathrm{HHHH}\n\\end{array}\n\\]\nIl lancio di quattro monete può produrre 16 risultati possibili. Dato che i lanci sono indipendenti, se le monete sono equilibrate ogni possibile risultato è ugualmente probabile. Nella tabella in alto, le sequenze dei risultati possibili del lancio delle 4 monete sono riportate nella colonna più a destra. Le probabilità si ottengono dividendo il numero di sequenze che producono lo stesso numero di eventi testa per il numero dei risultati possibili.\nLe sequenze come \\(\\mathrm{TTTT}\\), \\(\\mathrm{HTTT}\\), ecc. sono chiamate “eventi elementari” (corrispondono ad un possibile esito dell’esperimento casuale). L’evento \\(Z = u\\), con \\(u \\in 0 \\dots, 4\\) è un “evento composto”, il quale può essere costituito da più eventi elementari.\nLa funzione \\(p_Z\\) è stata costruita per associare a ciascun valore \\(u\\) della variabile casuale \\(Z\\) la probabilità dell’evento \\(Z = u\\). Convenzionalmente, queste probabilità sono scritte come\n\\[\nP_Z(z) = P(Z = z).\n\\]\nLa parte a destra dell’uguale si può leggere come: “la probabilità che la variabile casuale \\(Z\\) assuma il valore \\(z\\)”. Una funzione definita come sopra è detta funzione di massa di probabilità della variabile casuale \\(Z\\). Ad ogni variabile casuale discreta è associata un’unica funzione di massa di probabilità.\nUna rappresentazione grafica della stima della funzione di massa di probabilità per l’esperimento casuale del lancio di quattro monete equilibrate è fornita nella Figura 6.3.\n\nCodiceset.seed(1234)\nM <- 1e5\nnflips <- 4\nu <- rbinom(M, nflips, 0.5)\nx <- 0:nflips\ny <- rep(NA, nflips + 1)\nfor (n in 0:nflips) {\n  y[n + 1] <- sum(u == n) / M\n}\nbar_plot <-\n  data.frame(Z = x, count = y) %>%\n  ggplot(aes(x = Z, y = count)) +\n  geom_bar(stat = \"identity\") +\n  scale_x_continuous(\n    breaks = 0:4,\n    labels = c(0, 1, 2, 3, 4)\n  ) +\n  labs(\n    y = \"Probabilità stimata P(Z = z)\"\n  )\nbar_plot\n\n\n\nFigura 6.3: Grafico di \\(M = 100,000\\) simulazioni della funzione di massa di probabilità di una variabile casuale definita come il numero di teste in quattro lanci di una moneta equilibrata.\n\n\n\n\nSe \\(A\\) è un sottoinsieme della variabile casuale \\(Z\\), allora denotiamo con \\(P_{z}(A)\\) la probabilità assegnata ad \\(A\\) dalla distribuzione \\(P_{z}\\). Mediante una distribuzione di probabilità \\(P_{z}\\) è dunque possibile determinare la probabilità di ciascun sottoinsieme \\(A \\subset Z\\) come\n\\[\\begin{equation}\nP_{z}(A) = \\sum_{z \\in A} P_{z}(Z = z).\n\\end{equation}\\]\nUna funzione di massa di probabilità soddisfa le proprietà\n\n\n\\(0 \\leq P(X=x) \\leq 1\\),\n\n\\(\\sum_{x \\in X} P(x) = 1\\).\n\n\nNel caso dell’esempio discusso nel Paragrafo @ref(sec:fun-mass-prob), la probabilità che la variabile casuale \\(Z\\) sia un numero dispari è\n\\[\nP(\\text{Z è un numero dispari}) = P_{z}(Z = 1) + P_{z}(Z = 3) = \\frac{4}{16} + \\frac{4}{16} = \\frac{1}{2}.\n\\]\n\n\n6.7.1 Funzione di ripartizione\nData una variabile casuale discreta \\(X\\) possiamo calcolare la probabilità che \\(X\\) non superi un certo valore \\(x\\), ossia la sua funzione di ripartizione. Poichè \\(X\\) assume valori discreti possiamo cumulare le probabilità mediante una somma:\n\\[\nF(x_k) = P(X \\leq x_k) = \\sum_{x \\leq x_k} P(x).\n\\]"
  },
  {
    "objectID": "015_prob_intro.html#commenti-e-considerazioni-finali",
    "href": "015_prob_intro.html#commenti-e-considerazioni-finali",
    "title": "6  La logica dell’incerto",
    "section": "Commenti e considerazioni finali",
    "text": "Commenti e considerazioni finali\nIn questo capitolo abbiamo visto come si costruisce lo spazio campione di un esperimento casuale, quali sono le proprietà di base della probabilità e come si assegnano le probabilità agli eventi definiti sopra uno spazio campione discreto. Abbiamo anche introdotto le nozioni di variabile casuale, ovvero di una variabile che assume i suoi valori in maniera casuale. Abbiamo descritto il modo di specificare la probabilità con cui sono una variabile casuale assume i suoi differenti valori, ovvero la funzione di ripartizione \\(F(X) = P(X < x)\\) e la funzione di massa di probabilità.\n\n\n\n\n\n\nFinetti, B. de. (1931). Probabilismo. Logos, 163–219."
  },
  {
    "objectID": "016_conditional_prob.html",
    "href": "016_conditional_prob.html",
    "title": "7  Probabilità condizionata",
    "section": "",
    "text": "Il fondamento della statistica bayesiana è il teorema di Bayes e il teorema di Bayes è una semplice ridescrizione della probabilità condizionata. Esaminiamo dunque la nozione di probabilità condizionata."
  },
  {
    "objectID": "016_conditional_prob.html#sec-bayes-cancer",
    "href": "016_conditional_prob.html#sec-bayes-cancer",
    "title": "7  Probabilità condizionata",
    "section": "\n7.1 Probabilità condizionata su altri eventi",
    "text": "7.1 Probabilità condizionata su altri eventi\nL’attribuzione di una probabilità ad un evento è sempre condizionata dalle conoscenze che abbiamo a disposizione. Per un determinato stato di conoscenze, attribuiamo ad un dato evento una certa probabilità di verificarsi; ma se il nostro stato di conoscenze cambia, allora cambierà anche la probabilità che attribuiremo all’evento in questione. Infatti, si può pensare che tutte le probabilità siano probabilità condizionate, anche se l’evento condizionante non è sempre esplicitamente menzionato.\nPer introdurre la probabilità condizionata, Albert & Hu (2019) utilizzando il famoso paradosso delle tre carte. “Ci sono tre carte, delle quali la prima (\\(A\\)) è rossa su entrambi i lati, la seconda (\\(B\\)) su un lato è rossa e sull’altro è bianca e la terza (\\(C\\)) è bianca su entrambi i lati. Ponendo su un tavolo una delle tre carte, scelta a caso, ottengo che il lato visibile è di colore rosso. Qual è la probabilità che anche il lato non visibile sia di colore rosso? La risposta intuitiva porta solitamente a rispondere che la probabilità ricercata sia pari al 50%, in quanto solo due carte (la \\(A\\) e la \\(B\\)) possono mostrare il colore rosso e solo una di queste (la \\(A\\)) può mostrare anche sull’altro lato il colore rosso; tuttavia si dimostra che la risposta giusta è 2/3.” (da Wikipedia)\nAlbert & Hu (2019) propongono di risolvere il problema con una simulazione in \\(\\textsf{R}\\): prima di tutto si sceglie una carta a caso, e poi si sceglie un lato della carta. Ci sono tre carte possibili, che chiamiamo “c_rossa”, “c_bianca”, e “c_entrambi”. Per la carta rossa, ci sono due lati rossi; per la carta bianca ci sono due lati bianchi e la carta “entrambi” ha un lato rosso e un lato bianco.\n\nCodicedf <- tibble(\n  Carta = c(\n    \"c_rossa\", \"c_rossa\", \"c_bianca\", \"c_bianca\", \"c_entrambi\", \n    \"c_entrambi\"\n  ),\n  Lato = c(\n    \"rosso\", \"rosso\", \"bianco\", \"bianco\", \"rosso\", \"bianco\"\n  )\n)\ndf\n#> # A tibble: 6 × 2\n#>   Carta      Lato  \n#>   <chr>      <chr> \n#> 1 c_rossa    rosso \n#> 2 c_rossa    rosso \n#> 3 c_bianca   bianco\n#> 4 c_bianca   bianco\n#> 5 c_entrambi rosso \n#> 6 c_entrambi bianco\n\n\nEstraiamo una carta a caso e classifichiamo il risultato ottenuto in base al tipo di carta e lato osservato. Ripetiamo l’esperimento 1,000 volte:\n\nCodiceset.seed(84735)\ncarte <- sample_n(df, 1e3, replace = TRUE)\ntable(carte$Carta, carte$Lato)\n#>             \n#>              bianco rosso\n#>   c_bianca      353     0\n#>   c_entrambi    143   160\n#>   c_rossa         0   344\n\n\nSe si osserva il colore rosso (seconda colonna nella tabella precedente), questo risultato è dovuto ad una carta \\(A\\) (“rossa”) in 344 casi e ad una carta \\(B\\) (“entrambi”) in 160 casi. Quindi, nella simulazione il risultato per cui è stato osservato un colore rosso (344 + 160) è associato ad una carta \\(A\\) (“rossa”) in circa 2/3 dei casi – se il lato visibile è di colore rosso, allora c’è una probabilità di 2/3 che anche il lato non visibile sia di colore rosso.\nQuesto esempio dimostra come le nostre intuizioni a proposito della probabilità condizionata non sono sempre corrette. Consideriamo un altro problema più articolato.\n\nEsempio 7.1 \nSupponiamo che lo screening per la diagnosi precoce del tumore mammario si avvalga di un test che è accurato al 90%, nel senso che classifica correttamente il 90% delle donne colpite dal cancro e il 90% delle donne che non hanno il cancro al seno. Supponiamo che l’1% delle donne sottoposte allo screening abbia effettivamente il cancro al seno (e d’altra parte, il 99% non lo ha). Ci chiediamo: (1) qual è la probabilità che una donna scelta a caso ottenga una mammografia positiva, e (2) se la mammografia è positiva, qual è la probabilità che vi sia effettivamente un tumore al seno?\n\n\nSoluzione. Per risolvere questo problema, supponiamo che il test in questione venga somministrato ad un grande campione di donne, diciamo a 1000 donne. Di queste 1000 donne, 10 (ovvero, l’1%) hanno il cancro al seno. Per queste 10 donne, il test darà un risultato positivo in 9 casi (ovvero, nel 90% dei casi). Per le rimanenti 990 donne che non hanno il cancro al seno, il test darà un risultato positivo in 99 casi (se la probabilità di un vero positivo è del 90%, la probabilità di un falso positivo è del 10%). Questa situazione è rappresentata nella figura Figura 7.1.\nCombinando i due risultati precedenti, vediamo che il test dà un risultato positivo per 9 donne che hanno effettivamente il cancro al seno e per 99 donne che non ce l’hanno, per un totale di 108 risultati positivi. Dunque, la probabilità di ottenere un risultato positivo al test è \\(\\frac{108}{1000}\\) = 11%. Ma delle 108 donne che hanno ottenuto un risultato positivo al test, solo 9 hanno il cancro al seno. Dunque, la probabilità di essere una donna che ha veramente il cancro al seno, dato un risultato positivo al test (che ha le proprietà descritte sopra), è pari a \\(\\frac{9}{108}\\) = 8%.\n\n\n\n\nFigura 7.1: Rappresentazione ad albero che riporta le frequenze attese dei risultati di una mammografia in un campione di 1,000 donne.\n\n\n\n\n\nNell’esercizio precedente, la probabilità dell’evento “ottenere un risultato positivo al test” è una probabilità non condizionata, mentre la probabilità dell’evento “avere il cancro al seno, dato che il test ha prodotto un risultato positivo” è una probabilità condizionata.\nIn termini generali, la probabilità condizionata \\(P(A \\mid B)\\) rappresenta la probabilità che si verifichi l’evento \\(A\\) sapendo che si è verificato l’evento \\(B\\). Arriviamo dunque alla seguente definizione.\n\nDefinizione 7.1 Dato un qualsiasi evento \\(A\\), si chiama probabilità condizionata di \\(A\\) dato \\(B\\) il numero\n\\[\nP(A \\mid B) = \\frac{P(A \\cap B)}{P(B)}, \\quad \\text{con}\\, P(B) > 0,\n\\tag{7.1}\\]\ndove \\(P(A\\cap B)\\) è la probabilità congiunta dei due eventi, ovvero la probabilità che si verifichino entrambi.\n\nConcludiamo con un problema molto semplice per consolidare la nostra comprensione del concetto di probabilità condizionata.\n\nEsempio 7.2 \nDa un mazzo di 52 carte (13 carte per ciascuno dei 4 semi) ne viene estratta una in modo casuale. Qual è la probabilità che esca una figura di cuori? Sapendo che la carta estratta ha il seme di cuori, qual è la probabilità che il valore numerico della carta sia 7, 8 o 9?\n\n\nSoluzione. Ci sono 13 carte di cuori, dunque la risposta alla prima domanda è 1/4. Questa è una probabilità non condizionata, dunque il suo calcolo non presenta alcuna difficoltà. La seconda probabilità cercata è una probabilità condizionata. Anche in questo secondo caso dobbiamo solo contare, ma, in questo caso, considerando solo un sottoinsieme di carte, ovvero le 13 carte di cuori. In questo modo è facile arrivare al risultato cercato, ovvero 3/13. Applicando la formula Equazione 7.1, con \\(A\\) = 7, 8, o 9 e \\(B\\) = cuori, arriviamo allo stesso risulato:\n\\[\nP(A \\mid B) = \\frac{P(A \\cap B)}{P(B)} = \\frac{3/52}{13/52} = \\frac{3}{13}.\n\\]"
  },
  {
    "objectID": "016_conditional_prob.html#la-regola-moltiplicativa",
    "href": "016_conditional_prob.html#la-regola-moltiplicativa",
    "title": "7  Probabilità condizionata",
    "section": "\n7.2 La regola moltiplicativa",
    "text": "7.2 La regola moltiplicativa\nDalla definizione di probabilità condizionata (Equazione 7.1) è possibile esprimere la probabilità congiunta tramite le condizionate. La regola moltiplicativa (o legge delle probabilità composte, o regola della catena) afferma che la probabilità che si verifichino due eventi \\(A\\) e \\(B\\) è pari alla probabilità di uno dei due eventi moltiplicato con la probabilità dell’altro evento condizionato al verificarsi del primo:\n\\[\nP(A \\cap B) = P(B)P(A \\mid B) = P(A)P(B \\mid A).\n\\tag{7.2}\\]\nLa Equazione 7.2 si estende al caso di \\(n\\) eventi \\(A_1, \\dots, A_n\\) nella forma seguente:\n\\[\nP\\left( \\bigcap_{k=1}^n A_k \\right) = \\prod_{k=1}^n P\\left(  A_k  \\ \\Biggl\\lvert \\ \\bigcap_{j=1}^{k-1} A_j \\right)\n\\tag{7.3}\\]\nPer esempio, nel caso di quattro eventi abbiamo\n\\[\n\\begin{split}\nP(A_1 \\cap A_2 \\cap A_3 \\cap A_4) = {}& P(A_1) \\cdot P(A_2 \\mid A_1) \\cdot  P(A_3 \\mid A_1 \\cap A_2) \\cdot \\\\\n& P(A_4 \\mid A_1 \\cap A_2 \\cap A_{3}).\\notag\n\\end{split}\n\\]\n\nEsempio 7.3 Da un’urna contenente 6 palline bianche e 4 nere si estrae una pallina per volta, senza reintrodurla nell’urna. Indichiamo con \\(B_i\\) l’evento: “esce una pallina bianca alla \\(i\\)-esima estrazione” e con \\(N_i\\) l’estrazione di una pallina nera. L’evento: “escono due palline bianche nelle prime due estrazioni” è rappresentato dalla intersezione \\(\\{B_1 \\cap B_2\\}\\) e, per l’Equazione 7.2, la sua probabilità vale\n\\[\nP(B_1 \\cap B_2) = P(B_1)P(B_2 \\mid B_1).\n\\]\n\\(P(B_1)\\) vale 6/10, perché nella prima estrazione \\(\\Omega\\) è costituito da 10 elementi: 6 palline bianche e 4 nere. La probabilità condizionata \\(P(B_2 \\mid B_1)\\) vale 5/9, perché nella seconda estrazione, se è verificato l’evento \\(B_1\\), lo spazio campionario consiste di 5 palline bianche e 4 nere. Si ricava pertanto:\n\\[\nP(B_1 \\cap B_2) = \\frac{6}{10} \\cdot \\frac{5}{9} = \\frac{1}{3}.\n\\]\nIn modo analogo si ha che\n\\[\nP(N_1 \\cap N_2) = P(N_1)P(N_2 \\mid N_1) = \\frac{4}{10} \\cdot \\frac{3}{9} = \\frac{4}{30}.\n\\]\nSe l’esperimento consiste nell’estrazione successiva di 3 palline, la probabilità che queste siano tutte bianche, per la Equazione 7.3, vale\n\\[\nP(B_1 \\cap B_2 \\cap B_3)=P(B_1)P(B_2 \\mid B_1)P(B_3 \\mid B_1 \\cap B_2),\n\\]\ndove la probabilità \\(P(B_3 \\mid B_1 \\cap B_2)\\) si calcola supponendo che si sia verificato l’evento condizionante \\(\\{B_1 \\cap B_2\\}\\). Lo spazio campionario per questa probabilità condizionata è costituito da 4 palline bianche e 4 nere, per cui \\(P(B_3 \\mid B_1 \\cap B_2) = 1/2\\) e quindi:\n\\[\nP (B_1 \\cap B_2 \\cap B_3) = \\frac{6}{10}\\cdot\\frac{5}{9} \\cdot\\frac{4}{8}  = \\frac{1}{6}.\n\\]\nLa probabilità dell’estrazione di tre palline nere è invece:\n\\[\n\\begin{aligned}\nP(N_1 \\cap N_2 \\cap N_3) &= P(N_1)P(N_2 \\mid N_1)P(N_3 \\mid N_1 \\cap N_2)\\notag\\\\\n&= \\frac{4}{10} \\cdot \\frac{3}{9} \\cdot \\frac{2}{8} = \\frac{1}{30}.\\notag\n\\end{aligned}\n\\]"
  },
  {
    "objectID": "016_conditional_prob.html#lindipendendenza-stocastica",
    "href": "016_conditional_prob.html#lindipendendenza-stocastica",
    "title": "7  Probabilità condizionata",
    "section": "\n7.3 L’indipendendenza stocastica",
    "text": "7.3 L’indipendendenza stocastica\nUn concetto molto importante per le applicazioni statistiche della probabilità è quello dell’indipendenza stocastica. L’Equazione 7.1 consente di esprimere il concetto di indipendenza di un evento da un altro in forma intuitiva: se \\(A\\) e \\(B\\) sono eventi indipendenti, allora il verificarsi di \\(A\\) non influisce sulla probabilità del verificarsi di \\(B\\), ovvero non la condiziona, e il verificarsi di \\(B\\) non influisce sulla probabilità del verificarsi di \\(A\\). Infatti, per l’Equazione 7.1, si ha che, se \\(A\\) e \\(B\\) sono due eventi indipendenti, risulta:\n\\[\nP(A \\mid B) = \\frac{P(A)P(B)}{P(B)} = P(A),\n\\]\n\\[\nP(B \\mid A) = \\frac{P(A)P(B)}{P(A)} = P(B).\n\\]\nPossiamo dunque dire che due eventi \\(A\\) e \\(B\\) sono indipendenti se\n\\[\n\\begin{split}\nP(A \\mid B) &= P(A), \\\\\nP(B \\mid A) &= P(B).\n\\end{split}\n\\]\n\nEsempio 7.4 Nel lancio di due dadi non truccati, si considerino gli eventi: \\(A\\) = {esce un 1 o un 2 nel primo lancio} e \\(B\\) = {il punteggio totale è 8}. Gli eventi \\(A\\) e \\(B\\) sono indipendenti?\nRappresentiamo qui sotto lo spazio campione dell’esperimento casuale.\n\n\n\n\nRappresentazione dello spazio campionario dei risultati dell’esperimento casuale corrispondente al lancio di due dadi bilanciati. Sono evidenziati gli eventi elementari che costituiscono l’evento \\(B\\): ‘il punteggio totale è 8’.\n\n\n\n\nGli eventi \\(A\\) e \\(B\\) non sono statisticamente indipendenti. Infatti, le loro probabilità valgono \\(P(A) = 12/36\\) e \\(P(B) = 5/36\\) e la probabilità della loro intersezione è\n\\[\nP(A \\cap B) = 1/36 = 3/108 \\neq P(A)P(B) = 5/108.\n\\]\n\n\nNota. Il concetto di indipendenza è del tutto differente da quello di incompatibilità. Si noti infatti che due eventi A e B incompatibili (per i quali si ha \\(A \\cap B = \\emptyset\\)) sono statisticamente dipendenti, poiché il verificarsi dell’uno esclude il verificarsi dell’altro: \\(P(A \\cap B)=0 \\neq P(A)P(B)\\)."
  },
  {
    "objectID": "016_conditional_prob.html#il-teorema-della-probabilità-totale",
    "href": "016_conditional_prob.html#il-teorema-della-probabilità-totale",
    "title": "7  Probabilità condizionata",
    "section": "\n7.4 Il teorema della probabilità totale",
    "text": "7.4 Il teorema della probabilità totale\nDato un insieme finito \\(A_i\\) di eventi, nel calcolo della probabilità dell’unione di tutti gli eventi, se gli eventi considerati non sono a due a due incompatibili, si deve tenere conto delle loro intersezioni. In particolare, la probabilità dell’unione di due eventi \\(A\\) e \\(B\\) è pari alla somma delle singole probabilità \\(P(A)\\) e \\(P(B)\\) diminuita della probabilità della loro intersezione:\n\\[\nP(A \\cup B) = P(A) + P(B) - P(A \\cap B).\n\\tag{7.4}\\]\nNel caso di tre eventi, si ha\n\\[\n\\begin{split}\nP(A \\cup B \\cup C) &= P(A)+P(B)+P(C)-P(A\\cap B)-P(A\\cap C) - \\\\\n& \\qquad P(B\\cap C) + P(A\\cap B\\cap C).\n\\end{split}\n\\]\nLa formula per il caso di \\(n\\) eventi si ricava per induzione.\nPer il caso di due soli eventi, se \\(A\\) e \\(B\\) sono indipendenti, l’Equazione 7.4 si modifica nella relazione seguente:\n\\[\nP(A \\cup B) = P(A) + P(B) - P(A)P(B).\n\\]\nNel caso di due eventi \\(A\\) e \\(B\\) incompatibili, se cioè \\(P(A \\cap B) = \\varnothing\\), si ha che\n\\[\nA\\cap B=\\varnothing \\Rightarrow P(A\\cup B)=P(A)+P(B).\n\\]\nSi può dimostrare per induzione che ciò vale anche per un insieme finito di eventi \\(A_{n}\\) a due a due incompatibili, ovvero che:\n\\[\nA_i\\cap A_j=\\varnothing, i\\neq j \\Rightarrow P\\left(\\bigcup_{i=1}^n A_i\\right)=\\sum_{i=1}^nP(A_i).\n\\]"
  },
  {
    "objectID": "016_conditional_prob.html#il-teorema-della-probabilità-assoluta",
    "href": "016_conditional_prob.html#il-teorema-della-probabilità-assoluta",
    "title": "7  Probabilità condizionata",
    "section": "\n7.5 Il teorema della probabilità assoluta",
    "text": "7.5 Il teorema della probabilità assoluta\nIl teorema della probabilità assoluta consente di calcolare la probabilità di un evento \\(E\\) di cui sono note le probabilità condizionate rispetto ad altri eventi \\((H_i)_{i\\geq 1}\\), a condizione che essi costituiscano una partizione dell’evento certo \\(\\Omega\\), ovvero\n\n\n\\(\\bigcup_{i=1}^\\infty H_i = \\Omega\\);\n\n\\(H_j \\cap H_j = \\emptyset, i\\neq j\\);\n\n\\(P(H_i) > 0, i = 1, \\dots, \\infty\\).\n\nNel caso di una partizione dello spazio campione in \\(n\\) sottoinsiemi abbiamo\n\\[\nP(E) = \\sum_{i=1}^n P(H_i\\cap E) = \\sum_{i=1}^n P(E \\mid H_i) P(H_i).\n\\]\nConsideriamo, ad esempio, una partizione dell’evento certo in tre sottoinsiemi.\n\n\n\n\nPartizione dell’evento certo \\(\\Omega\\) in tre sottoinsiemi sui quali viene definito l’evento \\(E\\).\n\n\n\n\nIn tali circostanze si ha che\n\\[\nP(E) = P(E \\cap H_1) + P(E \\cap H_2) + P(E \\cap H_3),\n\\tag{7.5}\\]\novvero\n\\[\nP(E) = P(E \\mid H_1) P(H_1) + P(E \\mid H_2) P(H_2) + P(E \\mid H_3) P(H_3).\n\\tag{7.6}\\]\nIn base al teorema della probabilità assoluta, dunque, se l’evento \\(E\\) è costituito da tutti gli eventi elementari in \\(E \\cap H_1\\), \\(E \\cap H_2\\) e \\(E \\cap H_3\\), allora la sua probabilità è data dalla somma delle probabilità condizionate \\(P(E \\mid H_i)\\), ciascuna delle quali pesata per la probabilità dell’evento condizionante \\(H_i\\).\n\nEsempio 7.5 Si considerino tre urne, ciascuna delle quali contiene 100 palline:\n\nUrna 1: 75 palline rosse e 25 palline blu,\nUrna 2: 60 palline rosse e 40 palline blu,\nUrna 3: 45 palline rosse e 55 palline blu.\n\nUna pallina viene estratta a caso da un’urna anch’essa scelta a caso. Qual è la probabilità che la pallina estratta sia di colore rosso?\n\n\nSoluzione. Sia \\(R\\) l’evento “la pallina estratta è rossa” e sia \\(U_i\\) l’evento che corrisponde alla scelta dell’\\(i\\)-esima urna. Sappiamo che\n\\[\nP(R \\mid U_1) = 0.75, \\quad P(R \\mid U_2) = 0.60, \\quad P(R \\mid U_3) = 0.45.\n\\]\nGli eventi \\(U_1\\), \\(U_2\\) e \\(U_3\\) costituiscono una partizione dello spazio campione in quanto \\(U_1\\), \\(U_2\\) e \\(U_3\\) sono eventi mutualmente esclusivi ed esaustivi, ovvero \\(P(U_1 \\cup U_2 \\cup U_3) = 1.0\\). In base al teorema della probabilità assoluta, la probabilità di estrarre una pallina rossa è dunque\n\\[\n\\begin{split}\nP(R) &= P(R \\mid U_1)P(U_1) + P(R \\mid U_2)P(U_2) + P(R \\mid U_3)P(U_3) \\\\\n&= 0.75 \\cdot \\frac{1}{3}+0.60 \\cdot \\frac{1}{3}+0.45 \\cdot \\frac{1}{3} \\\\\n&=0.60.\n\\end{split}\n\\]"
  },
  {
    "objectID": "016_conditional_prob.html#indipendenza-condizionale",
    "href": "016_conditional_prob.html#indipendenza-condizionale",
    "title": "7  Probabilità condizionata",
    "section": "\n7.6 Indipendenza condizionale",
    "text": "7.6 Indipendenza condizionale\nAggiungo qui delle considerazioni sul concetto di indipendenza condizionale a cui si farà riferimento nell’ultima parte della dispensa. L’indipendenza condizionale descrive situazioni in cui un’osservazione è irrilevante o ridondante quando si valuta la certezza di un’ipotesi. L’indipendenza condizionale è solitamente formulata nei termini della probabilità condizionata, come un caso speciale in cui la probabilità dell’ipotesi data un’osservazione non informativa è uguale alla probabilità senza tale osservazione non informativa.\nSe \\(A\\) è l’ipotesi e \\(B\\) e \\(C\\) sono osservazioni, l’indipendenza condizionale può essere espressa come l’uguaglianza:\n\\[\nP(A \\mid B,C)=P(A \\mid C).\n\\]\nDato che \\(P(A \\mid B,C)\\) è uguale a \\(P(A \\mid C)\\), questa uguaglianza corrisponde all’affermazione che \\(B\\) non fornisce alcun contributo alla certezza di \\(A\\). In questo caso si dice che \\(A\\) e \\(B\\) condizionalmente indipendenti dato \\(C\\), scritto simbolicamente come: \\((A \\perp\\!\\!\\!\\!\\perp B \\mid C)\\).\nIn maniera equivalente, l’indipendenza condizionale \\((A \\perp\\!\\!\\!\\!\\perp B \\mid C)\\) si verifica se:\n\\[\nP(A, B \\mid C) = P(A \\mid C) P(B \\mid C).\n\\]\nUn esempio è il seguente (da Wikipedia). Siano due eventi le probabilità che le persone \\(A\\) e \\(B\\) tornino a casa in tempo per la cena, e il terzo evento è il fatto che una tempesta di neve ha colpito la città. Mentre sia \\(A\\) che \\(B\\) hanno una probabilità più piccola di tornare a casa in tempo per la cena di quando non c’è la neve, tali probabilità sono indipendenti l’una dall’altra. Cioè, sapere che \\(A\\) è in ritardo non ci dice nulla sul fatto che \\(B\\) sia in ritardo o meno – \\(A\\) e \\(B\\) potrebbero vivere in quartieri diversi, percorrere distanze diverse e utilizzare mezzi di trasporto diversi. Tuttavia, se sapessimo che \\(A\\) e \\(B\\) vivono nello stesso quartiere, usano lo stesso mezzo di trasporto e lavorano nello stesso luogo, allora i due eventi non sarebbero condizionatamente indipendenti."
  },
  {
    "objectID": "016_conditional_prob.html#commenti-e-considerazioni-finali",
    "href": "016_conditional_prob.html#commenti-e-considerazioni-finali",
    "title": "7  Probabilità condizionata",
    "section": "Commenti e considerazioni finali",
    "text": "Commenti e considerazioni finali\nLa probabilità condizionata è importante perché ci fornisce uno strumento per precisare il concetto di indipendenza statistica. Una delle domande più importanti delle analisi statistiche è infatti quella che si chiede se due variabili siano associate tra loro oppure no. In questo Capitolo abbiamo discusso il concetto di indipendenza (come contrapposto al concetto di associazione). In seguito vedremo come sia possibile fare inferenza sull’associazione tra variabili.\n\n\n\n\n\n\nAlbert, J., & Hu, J. (2019). Probability and bayesian modeling. Chapman; Hall/CRC."
  },
  {
    "objectID": "017_bayes_theorem.html",
    "href": "017_bayes_theorem.html",
    "title": "8  L’interpretazione soggettivista della probabilità",
    "section": "",
    "text": "Il teorema di Bayes assume un ruolo fondamentale nell’interpretazione soggettivista della probabilità perchè descrive l’aggiornamento della credenza che si aveva nel verificarsi dell’ipotesi \\(H\\) (quantificata con la probabilità assegnata all’ipotesi) in conseguenza del verificarsi dell’evidenza \\(E\\)."
  },
  {
    "objectID": "017_bayes_theorem.html#il-teorema-di-bayes",
    "href": "017_bayes_theorem.html#il-teorema-di-bayes",
    "title": "8  L’interpretazione soggettivista della probabilità",
    "section": "\n8.1 Il teorema di Bayes",
    "text": "8.1 Il teorema di Bayes\n\nTeorema 8.1 Sia \\((H_i)_{i\\geq 1}\\) una partizione dell’evento certo \\(\\Omega\\) e sia \\(E \\subseteq \\Omega\\) un evento tale che \\(P(E) > 0\\), allora, per \\(i = 1, \\dots, \\infty\\):\n\\[\n{\\mbox{P}}(H_i \\mid E) = \\frac{{\\mbox{P}}(E \\mid H_i){\\mbox{P}}(H_i)}{\\sum_{j=1}^{\\infty}{\\mbox{P}}(H_j)P(E \\mid H_j)}.\n\\tag{8.1}\\]\n\nL’Equazione 8.1 contiene tre concetti fondamentali. I primi due distinguono il grado di fiducia precedente al verificarsi dell’evidenza \\(E\\) da quello successivo al verificarsi dell’evidenza \\(E\\). Pertanto, dati gli eventi \\(H, E \\subseteq \\Omega,\\) si definisce\n\n\nprobabilità a priori, \\(P(H)\\), la probabilità attribuita al verificarsi dell’ipotesi \\(H\\) prima di sapere che si è verificato l’evento \\(E\\);\n\nprobabilità a posteriori, \\(P(H \\mid E)\\), la probabilità assegnata ad \\(H\\) una volta che sia noto \\(E\\), ovvero l’aggiornamento della probabilità a priori alla luce della nuova evidenza \\(E\\).\n\nIl terzo concetto definisce la probabilità che ha l’evento \\(E\\) di verificarsi quando è vera l’ipotesi \\(H\\), ovvero la probabilità dell’evidenza in base all’ipotesi. Pertanto, dati gli eventi \\(H, E \\subseteq \\Omega\\) si definisce\n\n\nverosimiglianza di \\(H\\) dato \\(E\\), \\(P(E \\mid H)\\), la probabilità condizionata che si verifichi \\(E\\), se è vera \\(H\\).\n\nSi noti che, per il calcolo della quantità a denominatore della Equazione 8.1, si ricorre al teorema della probabilità assoluta.\n\nEsercizio 8.1 \nConsiderando una partizione dell’evento certo \\(\\Omega\\) in due soli eventi che chiamiamo ipotesi \\(H_1\\) e \\(H_2\\). Supponiamo conosciute le probabilità a priori \\(P(H_1)\\) e \\(P(H_2)\\). Consideriamo un terzo evento \\(E \\subseteq \\Omega\\) con probabilità non nulla di cui si conosce la verosimiglianza, ovvero si conoscono le probabilità condizionate \\({\\mbox{P}}(E \\mid H_1)\\) e \\(P(E \\mid H_2)\\). Supponendo che si sia verificato l’evento \\(E\\), vogliamo conoscere le probabilità a posteriori delle ipotesi, ovvero \\(P(H_1 \\mid E)\\) e \\(P(H_2 \\mid E)\\).\n\n\n\n\n\nFigura 8.1: Partizione dell’evento certo in due eventi chiamati ‘ipotesi’. L’evidenza \\(E\\) è un sottoinsieme dello spazio campione.\n\n\n\n\n\nSoluzione. Per trovare le probabilità cercate scriviamo:\n\\[\n\\begin{split}\nP(H_1 \\mid E) &= \\frac{P(E \\cap H_1)}{P(E)}\\notag\\\\\n              &= \\frac{P(E \\mid H_1) P(H_1)}{P(E)}.\n\\end{split}\n\\]\nSapendo che \\(E = (E \\cap H_1) \\cup (E \\cap H_2)\\) e che \\(H_1\\) e \\(H_2\\) sono eventi disgiunti, ovvero \\(H_1 \\cap H_2 = \\emptyset\\), ne segue che possiamo calcolare \\({\\mbox{P}}(E)\\) utilizzando il teorema della probabilità assoluta:\n\\[\n\\begin{split}\nP(E) &= P(E \\cap H_1) + P(E \\cap H_2)\\notag\\\\\n     &= P(E \\mid H_1)P(H_1) + P(E \\mid H_2)P(H_2).\n\\end{split}\n\\]\nSostituendo tale risultato nella formula precedente otteniamo:\n\\[\nP(H_1 \\mid E) = \\frac{P(E \\mid H_1)P(H_1)}{P(E \\mid H_1)P(H_1) + P(E \\mid H_2)P(H_2)}.\n\\tag{8.2}\\]\nUn lettore attento si sarà reso conto che, in precedenza, abbiamo già applicato il teorema di Bayes quando abbiamo risolto l’Esempio 7.1. In quel caso, le due ipotesi erano “malattia presente”, che possiamo denotare con \\(M\\), e “malattia assente”, \\(M^\\complement\\). L’evidenza \\(E\\) era costituita dal risultato positivo al test, ovvero \\(+\\). Con questa notazione l’Equazione 8.2 diventa:\n\\[\nP(M \\mid +) = \\frac{P(+ \\mid M) P(M)}{P(+ \\mid M) P(M) + P(+ \\mid M^\\complement) P(M^\\complement)}\n\\]\nInserendo i dati nella formula, otteniamo\n\\[\n\\begin{align}\nP(M \\mid +) &= \\frac{0.9 \\cdot 0.01}{0.9 \\cdot 0.01 + 0.1 \\cdot 0.99} \\notag\\\\\n&= \\frac{9}{108} \\notag\\\\\n&\\approx 0.083.\\notag\n\\end{align}\n\\]"
  },
  {
    "objectID": "017_bayes_theorem.html#commenti-e-considerazioni-finali",
    "href": "017_bayes_theorem.html#commenti-e-considerazioni-finali",
    "title": "8  L’interpretazione soggettivista della probabilità",
    "section": "Commenti e considerazioni finali",
    "text": "Commenti e considerazioni finali\nIl teorema di Bayes rende esplicito il motivo per cui la probabilità non possa essere pensata come uno stato oggettivo, quanto piuttosto come un’inferenza soggettiva e condizionata. Il denominatore del membro di destra della Equazione 8.1 è un semplice fattore di normalizzazione. Nel numeratore compaiono invece due quantità: \\({\\mbox{P}}(H_i\\)) e \\({\\mbox{P}}(E \\mid H_i)\\). La probabilità \\({\\mbox{P}}(H_i\\)) è la probabilità probabilità a priori (prior) dell’ipotesi \\(H_i\\) e rappresenta l’informazione che l’agente bayesiano possiede a proposito dell’ipotesi \\(H_i\\). Diremo che \\({\\mbox{P}}(H_i)\\) codifica il grado di fiducia che l’agente ripone in \\(H_i\\) precedentemente al verificarsi dell’evidenza \\(E\\). Nell’interpretazione bayesiana, \\({\\mbox{P}}(H_i)\\) rappresenta un giudizio personale dell’agente e non esistono criteri esterni che possano determinare se tale giudizio sia coretto o meno. La probabilità condizionata \\({\\mbox{P}}(E \\mid H_i)\\) rappresenta invece la verosimiglianza di \\(H_i\\) dato \\(E\\) e descrive la plausibilità che si verifichi l’evento \\(E\\) se è vera l’ipotesi \\(H_i\\). Il teorema di Bayes descrive la regola che l’agente deve seguire per aggiornare il suo grado di fiducia nell’ipotesi \\(H_i\\) alla luce del verificarsi dell’evento \\(E\\). La \\({\\mbox{P}}(H_i \\mid E)\\) è chiamata probabilità a posteriori dato che rappresenta la nuova probabilità che l’agente assegna all’ipotesi \\(H_i\\) affinché rimanga consistente con le nuove informazioni fornitegli da \\(E\\).\nLa probabilità a posteriori dipende sia dall’evidenza \\(E\\), sia dalla conoscenza a priori dell’agente \\({\\mbox{P}}(H_i)\\). È dunque chiaro come non abbia senso parlare di una probabilità oggettiva: per il teorema di Bayes la probabilità è definita condizionatamente alla probabilità a priori, la quale a sua volta, per definizione, è un’assegnazione soggettiva. Ne segue pertanto che ogni probabilità deve essere considerata come una rappresentazione del grado di fiducia soggettiva dell’agente. Dato che ogni assegnazione probabilistica rappresenta uno stato di conoscenza e che ciascun particolare stato di conoscenza è arbitrario, un accordo tra agenti diversi non è richiesto.\nCiò nonostante, la teoria delle probabilità ci fornisce uno strumento che, alla luce di nuove evidenze, consente di aggiornare in un modo razionale il grado di fiducia che attribuiamo ad un’ipotesi, via via che nuove evidenze vengono raccolte, in modo tale da formulare un’ipotesi a posteriori la quale non è mai definitiva, ma può sempre essere aggiornata in base alle nuove evidenze disponibili. Questo processo si chiama aggiornamento bayesiano. Vedremo nel Capitolo @sec-intro-bayes-inference come estendere l’Equazione 8.1 al caso continuo."
  },
  {
    "objectID": "018_joint_prob.html",
    "href": "018_joint_prob.html",
    "title": "9  Probabilità congiunta",
    "section": "",
    "text": "La probabilità congiunta è la probabilità che due o più eventi si verifichino contemporaneamente. In questo Capitolo verrà esaminato il caso discreto."
  },
  {
    "objectID": "018_joint_prob.html#sec-fun-join-prob",
    "href": "018_joint_prob.html#sec-fun-join-prob",
    "title": "9  Probabilità congiunta",
    "section": "\n9.1 Funzione di probabilità congiunta",
    "text": "9.1 Funzione di probabilità congiunta\nDopo aver trattato della distribuzione di probabilità di una variabile casuale, la quale associa ad ogni evento elementare dello spazio campione uno ed un solo numero reale, è naturale estendere questo concetto al caso di due o più variabili casuali. Iniziamo a descrivere il caso discreto con un esempio. Consideriamo l’esperimento casuale corrispondente al lancio di tre monete equilibrate. Lo spazio campione è\n\\[\n\\Omega = \\{TTT, TTC, TCT, CTT, CCT, CTC, TCC, CCC\\}.\n\\]\nDato che i tre lanci sono tra loro indipendenti, non c’è ragione di aspettarsi che uno degli otto risultati possibili dell’esperimento sia più probabile degli altri, dunque possiamo associare a ciascuno degli otto eventi elementari dello spazio campione la stessa probabilità, ovvero 1/8.\nDefiniamo sullo spazio campione \\(\\Omega\\) le seguenti variabili casuali:\n\n\n\\(X \\in \\{0, 1, 2, 3\\}\\) = “numero di realizzazioni con il risultato testa nei tre lanci”,\n\n\\(Y \\in \\{0, 1\\}\\) = “numero di realizzazioni con il risultato testa nel primo lancio”.\n\nIndicando con T = ‘testa’ e C = ‘croce’, si ottiene la situazione riportata nella Tabella 9.1.\n\n\nTabella 9.1: Spazio campione dell’esperimento consistente nel lancio di tre monete equilibrate su cui sono state definite le variabili aleatorie \\(X\\) = ‘numero di realizzazioni con il risultato testa nei tre lanci’ e \\(Y\\) = ‘numero di realizzazioni con il risultato testa nel primo lancio’.\n\n\\(\\omega\\)\n\\(X\\)\n\\(Y\\)\n\\(P(\\omega)\\)\n\n\n\n\n\\(\\omega_1\\) = TTT\n3\n1\n1/8\n\n\n\n\\(\\omega_2\\) = TTC\n2\n1\n1/8\n\n\n\n\\(\\omega_3\\) = TCT\n2\n1\n1/8\n\n\n\n\\(\\omega_4\\) = CTT\n2\n0\n1/8\n\n\n\n\\(\\omega_5\\) = CCT\n1\n0\n1/8\n\n\n\n\\(\\omega_6\\) = CTC\n1\n0\n1/8\n\n\n\n\\(\\omega_7\\) = TCC\n1\n1\n1/8\n\n\n\n\\(\\omega_8\\) = CCC\n0\n0\n1/8\n\n\n\n\nCi poniamo il problema di associare un valore di probabilità ad ogni coppia \\((x, y)\\) definita su \\(\\Omega\\). La coppia \\((X = 0, Y = 0)\\) si realizza in corrispondenza di un solo evento elementare, ovvero CCC; avrà dunque una probabilità pari a\n\\[\nP(X=0, Y=0) = P(CCC) = 1/8.\n\\]\nNel caso della coppia \\((X = 1, Y = 0)\\) ci sono due eventi elementari che danno luogo al risultato considerato, ovvero, CCT e CTC. La probabilità dell’evento composto \\(P(X=1, Y=0)\\) è dunque uguale alla somma delle probabilità dei due eventi elementari che lo costituiscono, cioé\n\\[\nP(X=1, Y=0) = P(\\mbox{CCT}) + P(\\mbox{CTC}) = 1/8 + 1/8 = 1/4.\n\\]\nDi seguito sono riportati i calcoli per tutte le possibili coppie \\(X, Y\\):\n\\[\n\\begin{align}\nP(X = 0, Y = 0) &= P(\\omega_8 = CCC) = 1/8; \\notag\\\\\nP(X = 1, Y = 0) &= P(\\omega_5 = CCT) + P(\\omega_6 = CTC) = 2/8; \\notag\\\\\nP(X = 1, Y = 1) &= P(\\omega_7 = TCC) = 1/8; \\notag\\\\\nP(X = 2, Y = 0) &= P(\\omega_4 = CTT) = 1/8; \\notag\\\\\nP(X = 2, Y = 1) &= P(\\omega_3 = TCT) + P(\\omega_2 = TTC) = 2/8; \\notag\\\\\nP(X = 3, Y = 1) &= P(\\omega_1 = TTT) = 1/8; \\notag\n\\end{align}\n\\]\nLe probabilità così trovate sono riportate nella Tabella 9.2 che descrive la distribuzione di probabilità congiunta delle variabili casuali \\(X\\) (“numero di realizzazioni con il risultato testa nei tre lanci”) e \\(Y\\) (“numero di realizzazioni con il risultato testa nel primo lancio”) per l’esperimento casuale che consiste nel lancio di tre monete equilibrate.\n\n\nTabella 9.2: Distribuzione di probabilità congiunta per i risultati dell’esperimento consistente nel lancio di tre monete equilibrate.\n\n\\(x \\textbackslash y\\)\n0\n1\n\n\n\n0\n1/8\n0\n\n\n1\n2/8\n1/8\n\n\n2\n1/8\n2/8\n\n\n3\n0\n1/8\n\n\n\n\nIn generale, possiamo dire che, dato uno spazio campione discreto \\(\\Omega\\), è possibile associare ad ogni evento elementare \\(\\omega_i\\) dello spazio campione una coppia di numeri reali \\((x, y)\\), essendo \\(x = X(\\omega)\\) e \\(y = Y(\\omega)\\), il che ci conduce alla seguente definizione.\n\nDefinizione 9.1 Siano \\(X\\) e \\(Y\\) due variabili casuali. La funzione che associa ad ogni coppia \\((x, y)\\) un valore di probabilità prende il nome di funzione di probabilità congiunta:\n\\[\nP(x, y) = P(X = x, Y = y).\n\\]\n\nIl termine “congiunta” deriva dal fatto che questa probabilità è legata al verificarsi di una coppia di valori, il primo associato alla variabile casuale \\(X\\) ed il secondo alla variabile casuale \\(Y\\). Nel caso di due sole variabili casuali si parla di distribuzione bivariata, mentre nel caso di più variabili casuali si parla di distribuzione multivariata.\n\n9.1.1 Proprietà\nUna distribuzione di massa di probabilità congiunta bivariata deve soddisfare due proprietà:\n\n\n\\(0 \\leq P(x_i, y_j) \\leq 1\\);\nla probabilità totale deve essere uguale a 1: \\(\\sum_{i} \\sum_{j} P(x_i, y_j) = 1.\\)\n\n\n9.1.2 Eventi\nSi noti che dalla probabilità congiunta possiamo calcolare la probabilità di qualsiasi evento definito in base alle variabili aleatorie \\(X\\) e \\(Y\\). Per capire come questo possa essere fatto, consideriamo nuovamente l’esperimento casuale discusso in precedenza.\n\nEsercizio 9.1 \nPer la distribuzione di massa di probabilità congiunta riportata nella tabella Tabella 9.2 si trovi la probabilità dell’evento \\(X+Y \\leq 1\\).\n\n\nSoluzione. Per trovare la probabilità richiesta dobbiamo sommare le probabilità associate a tutte le coppie \\((x,y)\\) che soddisfano la condizione \\(X+Y \\leq 1\\), ovvero\n\\[\nP_{XY}(X+Y \\leq 1) = P_{XY}(0, 0)+ P_{XY}(0, 1) + P_{XY}(1, 0) = 3/8.\n\\]\n\n\n9.1.3 Funzioni di probabilità marginali\nLa distribuzione marginale di un sottoinsieme di variabili casuali è la distribuzione di probabilità delle variabili contenute nel sottoinsieme. Come spiegato da Wikipedia: > il termine variabile marginale è usato per riferirsi a quelle variabili nel sottoinsieme delle variabili che vengono trattenute ovvero utilizzate. Questo termine, marginale, è attribuito ai valori ottenuti ad esempio sommando in una tabella di valori lungo le righe oppure lungo le colonne, trascrivendo il risultato appunto a margine rispettivamente della riga o colonna sommata. La distribuzione delle variabili marginali (la distribuzione marginale) è ottenuta mediante marginalizzazione sopra le variabili da “scartare”, e le variabili scartate sono dette fuori marginalizzate.\nNel caso di due variabili casuali discrete \\(X\\) e \\(Y\\) di cui conosciamo la distribuzione congiunta, la distribuzione marginale di \\(X\\), \\(P(X=x)\\), è dunque\n\\[\nP(X = x) = \\sum_y P(X, Y = y) = \\sum_y P(X \\mid Y = y) P(Y = y),\n\\]\ndove \\(P(X = x,Y = y)\\) è la distribuzione congiunta di \\(X, Y\\), mentre \\(P(X = x \\mid Y = y)\\) è la distribuzione condizionata di \\(X\\) dato \\(Y\\).\nLe probabilità bivariate marginali e congiunte di variabili casuali discrete sono spesso rappresentate mediante tabelle di contingenza. Si noti che \\(P(X = x)\\) e \\(P(Y = y)\\) sono normalizzate:\n\\[\n\\sum_x P(X=x) = 1.0, \\quad \\sum_y P(Y=y) = 1.0.\n\\]\nNel caso continuo si sostituisce l’integrazione alla somma – si veda la Sezione 9.1.4.\n\nEsercizio 9.2 \nPer l’esperimento casuale descritto nella Sezione 9.1, si calcolino le probabilità marginali di \\(X\\) e \\(Y\\).\n\n\nSoluzione. Come indicato nella Tabella 9.3, \\(P_X\\) si ottiene sommando su ciascuna riga fissata la colonna \\(j\\), \\(P_X(X = j) = \\sum_y p_{xy}(x = j, y)\\) e \\(P_Y\\) si trova sommando su ciascuna colonna fissata la riga \\(i,\\) \\(P_Y (Y = i) = \\sum_x p_{xy}(x, y = i)\\).\n\n\nTabella 9.3: Distribuzione di probabilità congiunta \\(P(X,Y)\\) per i risultati dell’esperimento consistente nel lancio di tre monete equilibrate e probabilità marginali \\(P(X)\\) e \\(P(Y)\\).\n\n\\(x \\textbackslash y\\)\n0\n1\n\\(P(x)\\)\n\n\n\n0\n1/8\n0\n1/8\n\n\n1\n2/8\n1/8\n3/8\n\n\n2\n1/8\n2/8\n3/8\n\n\n3\n0\n1/8\n1/8\n\n\n\\(P(y)\\)\n4/8\n4/8\n1.0\n\n\n\n\n\n\n9.1.4 Marginalizzazione di variabili casuali continue\nNella trattazione della statistca bayesiana useremo spesso il concetto di “marginalizzazione” e vedremo equazioni come la seguente:\n\\[\np(y) = \\int_{\\theta} p(y, \\theta) = \\int_{\\theta} p(y \\mid \\theta) p(\\theta),\n\\tag{9.1}\\]\nladdove \\(y\\) e \\(\\theta\\) sono due variabili casuali continue – nello specifico, con \\(y\\) denoteremo i dati e con \\(\\theta\\) i parametri di un modello statistico. Alla luce di quanto detto sopra, è possibiile pensare al caso continuo indicato nella Equazione 9.1 come all’estensione dell’esempio discusso in questo capitolo ad un numero infinito di valori delle due variabili continue (qui \\(y\\) e \\(\\theta\\))."
  },
  {
    "objectID": "018_joint_prob.html#valore-atteso-di-una-funzione-di-una-variabile-casuale",
    "href": "018_joint_prob.html#valore-atteso-di-una-funzione-di-una-variabile-casuale",
    "title": "9  Probabilità congiunta",
    "section": "\n9.2 Valore atteso di una funzione di una variabile casuale",
    "text": "9.2 Valore atteso di una funzione di una variabile casuale\nA volte ci viene data una variabile casuale $ X$e dobbiamo lavorare con una funzione di \\(X\\). Se \\(X\\) è una variabile casuale e \\(h(X)\\) è una funzione di \\(X\\), allora anche \\(h(X)\\) è una variabile casuale. Se si vuole calcolare il valore atteso di \\(h(X)\\), lo si può fare usando la funzione di massa di probabilità o la funzione di densità di probabilità di \\(X\\); non è necessario conoscere la funzione di massa di probabilità (o la funzione di densità di probabilità) di \\(h(X)\\).\n\nEsercizio 9.3 \nSia \\(X\\) una variabile casuale discreta. Si trovi \\(\\mathbb{E}(aX + b)\\).\n\n\nSoluzione. \\(\\mathbb{E}(aX + b) = a\\mathbb{E}(X) + b = a \\sum_{x \\in \\Omega} xP(x) + b.\\) Si noti che la soluzione ha richiesto l’uso \\(P(x)\\), e non di \\(P(aX + b)\\).\n\n\nNota. Il risultato precedente è valido per variabili casuali continua dove la somma viene sostituita da un integrale."
  },
  {
    "objectID": "018_joint_prob.html#valore-atteso-di-una-funzione-di-molteplici-variabili-casuali",
    "href": "018_joint_prob.html#valore-atteso-di-una-funzione-di-molteplici-variabili-casuali",
    "title": "9  Probabilità congiunta",
    "section": "\n9.3 Valore atteso di una funzione di molteplici variabili casuali",
    "text": "9.3 Valore atteso di una funzione di molteplici variabili casuali\nA volte ci vengono fornite due variabili casuali \\(X\\) e \\(Y\\) e dobbiamo lavorare con una funzione di \\(X\\) e \\(Y\\). Se \\(X\\) e \\(Y\\) sono variabili casuali e \\(h(X, Y)\\) è una funzione di \\(X\\) e \\(Y\\), allora anche \\(h( X, Y)\\) è una variabile casuale. Se si desidera calcolare la media di \\(h(X, Y)\\), lo si può fare utilizzando la funzione di massa di probabilità congiunta (o la funzione di densità di probabilità congiunta di \\(X\\) e \\(Y\\)); non è necessario conoscere la funzione di massa di probabilità congiunta (o la funzione di massa congiunta funzione di densità di probabilità) di \\(h(X, Y)\\).\n\nEsercizio 9.4  \nSiano \\(X\\) e \\(Y\\) due variabili casuali discrete con distribuzione di massa di probabilità congiunta\n\\[\nP_{XY} (1,1) = 1/3; \\quad P_{XY}  (1,2) = 1/8; \\quad P_{XY} (2,1) = 1/2; \\quad P_{XY} (2,2) = 1/24.\n\\]\nSi trovi il valore atteso di \\(g(X, Y) = XY\\).\n\n\nSoluzione. \\[\n\\begin{align}\n\\mathbb{E}g(X, Y) &= \\mathbb{E}(XY) \\notag\\\\\n&= \\sum_{x=1}^2 \\sum_{y=1}^2 x y P_{XY}(x, y) \\notag\\\\\n&= 1 \\cdot 1 \\cdot \\frac{1}{3} +  \n   1 \\cdot 2 \\cdot \\frac{1}{8} +\n   2 \\cdot 1 \\cdot \\frac{1}{2} +\n   2 \\cdot 2 \\cdot \\frac{1}{24}\\notag\\\\\n&= \\frac{7}{4}.\\notag\n\\end{align}\n\\]\n\n\nEsercizio 9.5 \nSia \\(X_1, X_2, \\dots, X_n\\) una sequenza di variabili casuali i.i.d., ciascuna con media \\(\\mu\\) e varianza \\(\\sigma^2\\). Si trovi il valore atteso di \\(X = X_1 + X_2 + \\dots + X_n\\).\n\n\nSoluzione. \\(\\mathbb{E}(X) = \\mathbb{E}(X_1) + \\mathbb{E}(X_2) + \\dots + \\mathbb{E}(X_n) = \\sum_{i=1}^n \\mathbb{E}(X_i) = n \\mu.\\)\n\n\nEsercizio 9.6 \nSia \\(X_1, X_2, \\dots, X_n\\) una sequenza di variabili casuali i.i.d., ciascuna con media \\(\\mu\\) e varianza \\(\\sigma^2\\). Si definisca una nuova variabile casuale\n\\[\n\\bar{X} = \\frac{X_1 + X_2 + \\dots + X_n}{n}\n\\]\ndetta media campionaria. Si trovi il valore atteso di \\(\\bar{X}\\).\n\n\nSoluzione. \\(\\mathbb{E}(\\bar{X}) = \\frac{1}{n} \\sum_{i=1}^n \\mathbb{E}(X_i) = \\mu.\\)"
  },
  {
    "objectID": "018_joint_prob.html#distribuzioni-condizionali",
    "href": "018_joint_prob.html#distribuzioni-condizionali",
    "title": "9  Probabilità congiunta",
    "section": "\n9.4 Distribuzioni condizionali",
    "text": "9.4 Distribuzioni condizionali\nSe \\(X\\) e \\(Y\\) sono variabili casuali distribuite congiuntamente, conoscere il valore di \\(X\\) può modificare le probabilità relative alla variabile casuale \\(Y\\). Per calcolare questa nuova probabilità, è necessaria l’idea di una distribuzione condizionale.\n\nDefinizione 9.2 Siano \\(X\\) e \\(Y\\) variabili casuali discrete distribuite congiuntamente. Definiamo la funzione di massa di probabilità condizionata di \\(X\\) dato che \\(Y = y\\) nei termini seguenti:\n\\[\nP_{X \\mid Y} (x \\mid y) = P(X = x \\mid Y = y) = \\frac{P_{XY} (x, y)}{P_Y(y)}\n\\]\n\n\nEsercizio 9.7 \nSupponiamo che \\(X\\) e \\(Y\\) siano variabili casuali discrete con valori 1, 2, 3, 4 e che per \\(x,y = 1, 2, 3, 4\\) la funzione di massa di probabilità congiunta sia data da\n\\[\n\\begin{equation}\n  P_{XY}(x,y) =\n    \\begin{cases}\n      \\frac{1}{16} & \\text{se $x = y$}\\\\\n      \\frac{2}{16} & \\text{se $x < y$}\\\\\n      0 & \\text{se $x > y$}\n    \\end{cases}       \n\\end{equation}\n\\]\nSi trovi la funzione di probabilità condizionata di \\(Y\\) dato che \\(X = 3\\).\n\n\nSoluzione. La distribuzione congiunta di massa di probabilità è la seguente:\n\n\n\\(x \\textbackslash y\\)\n1\n2\n3\n4\n\\(P_X(x)\\)\n\n\n\n1\n1/16\n2/16\n2/16\n2/16\n7/16\n\n\n2\n0\n1/16\n2/16\n2/16\n5/16\n\n\n3\n0\n0\n1/16\n2/16\n3/16\n\n\n4\n0\n0\n0\n1/16\n1/16\n\n\n\\(P_Y(y)\\)\n1/16\n3/16\n5/16\n7/16\n1.0\n\n\n\nDunque otteniamo\n\\[\nP_{Y\\mid X}(1 \\mid 3) =  \\frac{P_{XY}(3,1)}{P_X(3)} = 0\n\\]\n\\[\nP_{Y\\mid X}(2 \\mid 3) =  \\frac{P_{XY}(3,2)}{P_X(3)} = 0\n\\]\n\\[\nP_{Y\\mid X}(3 \\mid 3) =  \\frac{P_{XY}(3,3)}{P_X(3)} = \\frac{(1/16)}{(3/16)} = \\frac{1}{3}\n\\]\n\\[\nP_{Y\\mid X}(4 \\mid 3) =  \\frac{P_{XY}(3,4)}{P_X(3)} = \\frac{(2/16)}{(3/16)} = \\frac{2}{3}\n\\]"
  },
  {
    "objectID": "018_joint_prob.html#valore-atteso-condizionato",
    "href": "018_joint_prob.html#valore-atteso-condizionato",
    "title": "9  Probabilità congiunta",
    "section": "\n9.5 Valore atteso condizionato",
    "text": "9.5 Valore atteso condizionato\nUn valore atteso condizionato è un valore atteso, o media, calcolato utilizzando una funzione di massa di probabilità condizionale (o una funzione di densità di probabilità condizionale).\n\nDefinizione 9.3 Siano \\(X\\) e \\(Y\\) variabili casuali discrete congiunte. Definiamo il valore atteso condizionato di \\(X\\) dato che \\(Y = y\\) come\n\\[\n\\begin{align}\n\\mathbb{E} (X \\mid Y = y) &= \\sum_x x P(X = x \\mid Y = y)\\notag\\\\\n&= \\sum_x x P_{X \\mid Y}(x \\mid y) \\notag\n\\end{align}\n\\]\n\n\nEsercizio 9.8 \nSi trovi il valore atteso condizionato dell’Esercizio 9.7 dato che \\(X = 3\\).\n\n\nSoluzione. Abbiamo che\n\\[\n\\begin{align}\n\\mathbb{E} (X \\mid Y = 3) &= \\sum_x x P(X = x \\mid Y = 3)\\notag\\\\\n&= \\frac{1 \\cdot P_{XY}(3,1)}{P_X(3)} + \\frac{2 \\cdot P_{XY}(3,2)}{P_X(3)} +\n\\frac{3 \\cdot P_{XY}(3,3)}{P_X(3)} + \\frac{4 \\cdot P_{XY}(3,4)}{P_X(3)} \\notag\\\\\n&= 3 \\cdot \\frac{1}{3} + 4 \\cdot \\frac{2}{3} \\notag\\\\\n&= \\frac{11}{3} \\notag\n\\end{align}\n\\]"
  },
  {
    "objectID": "018_joint_prob.html#indipendenza",
    "href": "018_joint_prob.html#indipendenza",
    "title": "9  Probabilità congiunta",
    "section": "\n9.6 Indipendenza",
    "text": "9.6 Indipendenza\nLa nozione di indipendenza per le variabili casuali è molto simile alla nozione di indipendenza per gli eventi. Due variabili casuali sono indipendenti se la conoscenza relativa a una di esse non influisce sulle probabilità dell’altra. Nel caso di due variabili casuali discrete, presentiamo qui una definizione di indipendenza formulatanei termini della loro distribuzione di massa di probabilità congiunta.\n\nDefinizione 9.4 Due variabili casuali \\(X\\) e \\(Y\\) distribuite congiuntamente si dicono indipendenti se e solo se\n\\[\nP_{X, Y}(x, y) = P_X(x) P_Y(y).\n\\]\n\nA parole, se due variabili discrete \\(X\\) e \\(Y\\) non si influenzano, ovvero se sono statisticamente indipendenti, allora la distribuzione di massa di probabilità congiunta si ottiene come prodotto delle funzioni di probabilità marginali di \\(X\\) e \\(Y\\). Se \\(P_{X, Y}(x, y) \\neq P_X(x) P_Y(y)\\), allora le due variabili si dicono associate.\nVedremo in seguito come una misura del grado di associazione lineare tra due variabili casuali è fornita dalla covarianza (o dalla correlazione)."
  },
  {
    "objectID": "018_joint_prob.html#commenti-e-considerazioni-finali",
    "href": "018_joint_prob.html#commenti-e-considerazioni-finali",
    "title": "9  Probabilità congiunta",
    "section": "Commenti e considerazioni finali",
    "text": "Commenti e considerazioni finali\nIn alcuni casi, diverse variabili casuali possono essere associate a ciascuna unità statistica della popolazione. Ad esempio, immaginiamo di scegliere uno studente a caso dall’elenco di tutti gli studenti iscritti a un’università e di misurare l’altezza e il peso di quello studente. A ogni individuo nella popolazione degli studenti corrispondono dunque due variabili casuali, altezza e peso. Quando due o più variabili casuali sono associate a ciascun elemento di una popolazione, si dice che le variabili casuali sono distribuite congiuntamente. In questo capitolo abbiamo visto come si possa rappresentare la distribuzione di massa di probabilità congiunta di due variabili casuali discrete e come si possano ottenere le distribuzioni marginali delle due variabili. Abbiamo anche esaminato i concetti di distribuzione marginale, distribuzione condizionata e indipendenza."
  },
  {
    "objectID": "019_density_func.html",
    "href": "019_density_func.html",
    "title": "10  La densità di probabilità",
    "section": "",
    "text": "Finora abbiamo considerato solo variabili casuali discrete, cioè variabili che assumono solo valori interi. Ma cosa succede se vogliamo usare variabili casuali per rappresentare lunghezze, o volumi, o distanze, o una qualsiasi delle altre proprietà continue nel mondo fisico o psicologico? È necessario generalizzare l’approccio usato finora.\nLe variabili casuali continue assumono valori reali. L’insieme dei numeri reali è non numerabile perché è più grande dell’insieme degli interi.1 Le leggi della probabilità sono le stesse per le variabili casuali discrete e quelle continue. La nozione di funzione di massa di probabilità, invece, deve essere sostituita dal suo equivalente continuo, ovvero dalla funzione di densità di probabilità. Lo scopo di questo Capitolo è quello di chiarire il significato di questa nozione, usando un approccio basato sulle simulazioni."
  },
  {
    "objectID": "019_density_func.html#spinner-e-variabili-casuali-continue-uniformi",
    "href": "019_density_func.html#spinner-e-variabili-casuali-continue-uniformi",
    "title": "10  La densità di probabilità",
    "section": "\n10.1 Spinner e variabili casuali continue uniformi",
    "text": "10.1 Spinner e variabili casuali continue uniformi\nConsideriamo il seguente esperimento casuale. Facciamo ruotare ad alta velocità uno spinner simmetrico imperniato su un goniometro e osserviamo la posizione in cui si ferma (individuata dall’angolo acuto con segno tra il suo asse e l’asse orizzontale del goniometro). Chiamiamo \\(\\Theta\\) la variabile casuale “pendenza dello spinner” – Figura 10.1. Nella trattazione seguente useremo i gradi e, di conseguenza, \\(\\Theta \\in [0, 360]\\).\n\n\n\n\nFigura 10.1: Uno spinner che riposa a 36 gradi, o il dieci percento del percorso intorno al cerchio. La pendenza dello spinner può assumere qualunque valore tra 0 e 360 gradi.\n\n\n\n\nCosa implica per \\(\\Theta\\) dire che lo spinner è simmetrico? Possiamo dire che, in ciascuna prova, la rotazione dello spinner produce un angolo qualunque da 0 a 360 gradi. In altri termini, un valore \\(\\Theta\\) compreso tra 0 e 36 gradi ha la stessa probabilità di essere osservato di un valore \\(\\Theta\\) compreso tra 200 e 236 gradi. Inoltre, poiché 36 gradi è un decimo del percorso intorno al cerchio, la probabilità di ottenere un qualsiasi intervallo di 36 gradi sarà sempre uguale al 10%. Ovvero \\(\\mbox{P}(0 \\leq \\Theta \\leq 36) \\ = \\ \\frac{1}{10}\\) e \\(\\mbox{P}(200 \\leq \\Theta \\leq 236) \\ = \\ \\frac{1}{10}\\).\nÈ importante notare che le probabilità precedenti non si riferiscono al fatto che \\(\\Theta\\) assume uno specifico valore, ma piuttosto all’evento di osservare \\(\\Theta\\) in un intervallo di valori. In generale, la probabilità che la pendenza \\(\\Theta\\) dello spinner cada in intervallo è la frazione del cerchio rappresentata dall’intervallo, cioè,\n\\[\n\\mbox{P}(\\theta_1 \\leq \\Theta \\leq \\theta_2) = \\frac{\\theta_2 - \\theta_1}{360}, \\qquad 0 \\leq \\theta_1 \\leq \\theta_2 \\leq 360.\n\\]\nLa ragione di questo è che le variabili casuali continue non hanno una massa di probabilità. Invece, una massa di probabilità viene assegnata alla realizzazione della variabile casuale in un intervallo di valori.\n\n10.1.1 Il paradosso delle variabili casuali continue\nNel nostro esempio, la pendenza dello spinner è esattamente 36 gradi; ma avrebbe anche potuto essere 36.0376531 gradi, o qualunque altro valore in quell’intorno. Qual è la probabilità che la pendenza dello spinner sia esattamente 36? Paradossalmente, la risposta è zero:\n\\[\n\\mbox{P}(\\Theta = 36) = 0.\n\\]\nInfatti, se la probabilità di un qualunque valore fosse maggiore di zero, ogni altro possibile valore dovrebbe avere la stessa probabilità, dato che abbiamo assunto che tutti i valori \\(\\Theta\\) siano egualmente probabili. Ma se poi andiamo a sommare tutte queste probabilità il totale diventerà maggiore di uno, il che non è possibile.\nNel caso delle variabili casuali continue dobbiamo dunque rinunciare a qualcosa, e quel qualcosa è l’idea che, in una distribuzione continua, ciascun valore puntuale della variabile casuale possa avere una massa di probabilità maggiore di zero. Il paradosso sorge perché una realizzazione della variabile casuale continua produce sempre un qualche numero, ma ciscuno di tali numeri ha probabilità nulla."
  },
  {
    "objectID": "019_density_func.html#la-funzione-di-ripartizione-per-una-variabile-casuale-continua",
    "href": "019_density_func.html#la-funzione-di-ripartizione-per-una-variabile-casuale-continua",
    "title": "10  La densità di probabilità",
    "section": "\n10.2 La funzione di ripartizione per una variabile casuale continua",
    "text": "10.2 La funzione di ripartizione per una variabile casuale continua\nSupponiamo che \\(\\Theta \\sim \\mathcal{U}(0, 360)\\) sia la pendenza dello spinner. La funzione di ripartizione (ovvero, la distribuzione cumulativa) è definita esattamente come nel caso delle variabili casuali discrete:\n\\[\nF_{\\Theta}(\\theta) = \\mbox{P}(\\Theta \\leq \\theta).\n\\]\nCioè, è la probabilità che la variabile casuale \\(\\Theta\\) assuma un valore minore di o uguale a \\(\\theta\\). In questo caso, poiché si presume che lo spinner sia simmetrico, la funzione di distribuzione cumulativa è\n\\[\nF_{\\Theta}(\\theta) = \\frac{\\theta}{360}.\n\\]\nQuesta è una funzione lineare di \\(\\theta\\), cioè \\(\\frac{1}{360} \\cdot \\theta\\), come indicato dal grafico della Figura 10.2.\n\n\n\n\nFigura 10.2: Funzione di distribuzione cumulativa per l’angolo \\(\\theta\\) (in gradi) risultante da una rotazione di uno spinner simmetrico. La linea tratteggiata mostra il valore a 180 gradi, che corrisponde ad una probabilità di 0.5, e la linea tratteggiata a 270 gradi, che corrisponde ad una probabilità di 0.75.\n\n\n\n\nPossiamo verificare questo risultato mediante simulazione. Per stimare la funzione di ripartizione, simuliamo \\(M\\) valori \\(\\theta^{(m)}\\) e poi li ordiniamo in ordine crescente.\n\nCodiceM <- 1000\ntheta <- runif(M, 0, 360)\ntheta_asc <- sort(theta)\nprob <- (1:M) / M\nunif_cdf_df <- data.frame(\n  theta = theta_asc,\n  prob = prob\n)\nunif_cdf_plot <-\n  unif_cdf_df %>%\n  ggplot(aes(x = theta, y = prob)) +\n  geom_line() +\n  scale_x_continuous(breaks = c(0, 90, 180, 270, 360)) +\n  scale_y_continuous(breaks = c(0, 0.25, 0.5, 0.75, 1.0)) +\n  xlab(expression(theta)) +\n  ylab(expression(F(Theta)(theta)))\nunif_cdf_plot\n\n\n\nFigura 10.3: Grafico della funzione di ripartizione di una variabile casuale \\(\\Theta\\) che rappresenta il risultato di una rotazione di uno spinner simmetrico. Come previsto, tale funzione è una semplice funzione lineare perché la variabile sottostante \\(\\Theta\\) ha una distribuzione uniforme.\n\n\n\n\nAnche con M = 1000, tale grafico è praticamente indistinguibile da quello prodotto per via analitica.\nCome nel caso delle variabili casuali discrete, la funzione di ripartizione può essere utilizzata per calcolare la probabilità che la variabile casuale assuma valori in un certo intervallo. Ad esempio\n\\[\\begin{align}\n\\mbox{P}(180 < \\Theta \\leq 270) &= \\mbox{P}(\\Theta \\leq 270) \\ - \\ \\mbox{P}(\\Theta \\leq 180) \\notag\\\\\n&= F_{\\Theta}(270) - F_{\\Theta}(180)\\notag\\\\\n&= \\frac{3}{4} - \\frac{1}{2} \\notag\\\\\n&= \\frac{1}{4}.\n\\end{align}\\]"
  },
  {
    "objectID": "019_density_func.html#la-distribuzione-uniforme",
    "href": "019_density_func.html#la-distribuzione-uniforme",
    "title": "10  La densità di probabilità",
    "section": "\n10.3 La distribuzione uniforme",
    "text": "10.3 La distribuzione uniforme\nDopo avere visto come generare numeri casuali uniformi da 0 a 360, consideriamo ora una variabile casuale che assume valori nell’intervallo da 0 a 1. Chiamiamo tale variabile casuale \\(\\Theta\\) e assumiamo che abbia una distribuzione continua uniforme sull’intervallo [0, 1]:\n\\[\n\\Theta \\sim \\mathcal{U}(0, 1).\n\\]\nPoiché le probabilità assumono valori nell’intervallo [0, 1], possiamo pensare a \\(\\Theta\\) come ad un valore di probabilità preso a caso in ciascuna realizzazione dell’esperimento casuale.\nLa distribuzione uniforme è la più semplice delle distribuzioni di densità di probabilità. Per chiarire le proprietà di tale distribuzione, iniziamo con una simulazione e generiamo 10,000 valori casuali di \\(\\Theta\\). I primi 10 di tali valori sono stampati qui di seguito:\n\nCodiceset.seed(1234)\nM <- 10000\ntheta <- runif(M)\ntheta[1:10]\n#>  [1] 0.113703411 0.622299405 0.609274733 0.623379442 0.860915384 0.640310605\n#>  [7] 0.009495756 0.232550506 0.666083758 0.514251141\n\n\nCreiamo ora un istogramma che descrive la distribuzione delle 10,000 realizzazioni \\(\\Theta\\) che abbiamo trovato:\n\nCodicedf_prob_unif <- data.frame(theta = theta)\nunif_prob_plot <-\n  ggplot(df_prob_unif, aes(theta)) +\n  geom_histogram(\n    binwidth = 1 / 34, center = 1 / 68, color = \"black\",\n    size = 0.25\n  ) +\n  scale_x_continuous(breaks = c(0, 0.25, 0.5, 0.75, 1)) +\n  scale_y_continuous(lim = c(0, 1000), breaks = c(500, 1000)) +\n  xlab(expression(paste(Theta, \" ~ Uniform(0, 1)\")))\nunif_prob_plot\n\n\n\nFigura 10.4: Istogramma di \\(10\\,000\\) realizzazioni \\(\\Theta \\sim \\mbox{Uniform}(0, 1)\\).\n\n\n\n\nÈ chiaro che, all’aumentare del numero delle realizzazioni \\(\\Theta\\), il profilo dell’istogramma tenderà a diventare una linea retta. Ciò significa che la funzione di densità di una variabile casuale uniforme continua è una costante. Cioè, se \\(\\Theta \\sim \\mathcal{U} (a, b)\\), allora \\(p_{\\Theta}(\\theta) = c\\), dove \\(c\\) è una costante.\n\nCodiceuniform_pdf_df <- data.frame(y = c(0, 1), p_y = c(1, 1))\nuniform_pdf_plot <-\n  ggplot(uniform_pdf_df, aes(x = y, y = p_y)) +\n  geom_line(size = 0.5, color = \"#333333\") +\n  geom_point(size = 1.5, color = \"#333333\") +\n  scale_x_continuous(breaks = c(0, 1), labels = c(\"a\", \"b\")) +\n  scale_y_continuous(\n    lim = c(0, 1), breaks = c(0, 1),\n    labels = c(\"0\", \"c\")\n  ) +\n  xlab(expression(theta)) +\n  ylab(expression(paste(p[Theta], \"(\", theta, \" | a, b)\"))) +\n  geom_segment(aes(x = 0, y = 0, xend = 0, yend = 1),\n    linetype = \"dotted\"\n  ) +\n  geom_segment(aes(x = 1, y = 0, xend = 1, yend = 1),\n    linetype = \"dotted\"\n  ) +\n  geom_segment(aes(x = 0, y = 0, xend = 1, yend = 0),\n    linetype = \"dotted\"\n  ) +\n  geom_segment(aes(x = -0.25, y = 0, xend = 0, yend = 0)) +\n  geom_segment(aes(x = 1, y = 0, xend = 1.25, yend = 0)) +\n  geom_point(aes(x = 0, y = 0),\n    size = 1.5, shape = 21,\n    fill = \"#ffffe6\"\n  ) +\n  geom_point(aes(x = 1, y = 0),\n    size = 1.5, shape = 21,\n    fill = \"#ffffe6\"\n  )\nuniform_pdf_plot\n\n\n\nFigura 10.5: Distribuzione uniforme\n\n\n\n\nDalla Figura 10.5 vediamo che l’area sottesa alla funzione di densità è \\((b - a)\\cdot c\\). Dato che tale area deve essere unitaria, ovvero, \\((b - a) \\cdot c = 1\\), possiamo trovare \\(c\\) dividendo entrambi i termini per \\(b - a\\),\n\\[\nc  = \\frac{\\displaystyle{1}}{\\displaystyle b - a}.\n\\]\nOvvero, se \\(\\Theta \\sim \\mathcal{U}(a, b)\\), allora\n\\[\np_{\\Theta}(\\theta) = \\mathcal{U}(\\theta \\mid a, b),\n\\]\nladdove\n\\[\n\\mathcal{U}(\\theta \\mid a, b) = \\frac{1}{b - a}.\n\\]\nIn conclusione, la densità di una variabile casuale uniforme continua non dipende da \\(\\theta\\) — è costante e identica per ogni possibile valore \\(\\theta\\).2 Vedremo nel prossimo Paragrafo che, eseguendo una trasformazione su questa variabile casuale uniforme, possiamo creare altre variabili casuali di interesse.\n\nSi consideri una variabile casuale uniforme \\(X\\) definita sull’intervallo [0, 100]. Si trovi la probabilità \\(P(20 < X < 60)\\).\nPer trovare la soluzione è sufficiente calcolare l’area di un rettangolo di base \\(60 - 20 = 40\\) e di altezza 1/100. La probabilità cercata è dunque \\(P(20 < X < 60) = 40 \\cdot 0.01 = 0.4\\)."
  },
  {
    "objectID": "019_density_func.html#dagli-istogrammi-alle-densità",
    "href": "019_density_func.html#dagli-istogrammi-alle-densità",
    "title": "10  La densità di probabilità",
    "section": "\n10.4 Dagli istogrammi alle densità",
    "text": "10.4 Dagli istogrammi alle densità\nNon esiste l’equivalente di una funzione di massa di probabilità per le variabili casuali continue. Esiste invece una funzione di densità di probabilità la quale, nei termini di una simulazione, può essere concepita nel modo seguente: avendo a disposizione un numero enorme di casi, quando l’intervallo \\(\\Delta\\) di ciascuna classe \\(\\rightarrow\\) 0, il profilo dell’istogramma delle frequenze delle classi di ampiezza \\(\\Delta\\) tende a diventare una curva continua. Tale curva continua \\(f(x)\\) è detta funzione di densità di probabilità.\nCome si trasformano gli istogrammi all’aumentare del numero di osservazioni? Per fare un esempio, considereremo una funzione di una variabile casuale uniforme \\([0, 1]\\). Nello specifico, esamineremo la funzione logit:\n\\[\n\\alpha = \\log \\left(\\frac{\\theta}{1-\\theta}\\right)\n\\]\nAlcuni valori \\(\\alpha\\) presi a caso sono i seguenti:\n\nCodiceset.seed(1234)\nM <- 10000\nlogit <- function(x) log(x / (1 - x))\ntheta <- runif(M)\nalpha <- logit(theta)\nfor (m in 1:10)\n  print(alpha[m])\n#> [1] -2.053458\n#> [1] 0.4993195\n#> [1] 0.4442646\n#> [1] 0.5039172\n#> [1] 1.822914\n#> [1] 0.5767125\n#> [1] -4.647369\n#> [1] -1.193965\n#> [1] 0.6905252\n#> [1] 0.05702001\n\n\nNei grafici seguenti, la numerosità cresce da \\(10\\) a \\(1\\,000\\,000\\).\n\nCodicedf_log_odds_growth <- data.frame()\nfor (log10M in 1:6) {\n  M <- 10^log10M\n  alpha <- logit(runif(M))\n  df_log_odds_growth <- rbind(\n    df_log_odds_growth,\n    data.frame(\n      alpha = alpha,\n      M = rep(sprintf(\"M = %d\", M), M)\n    )\n  )\n}\nlog_odds_growth_plot <-\n  df_log_odds_growth %>%\n  ggplot(aes(alpha)) +\n  geom_histogram(color = \"black\", bins = 75) +\n  facet_wrap(~M, scales = \"free\") +\n  scale_x_continuous(\n    lim = c(-8.5, 8.5), breaks = c(-5, 0, 5)\n  ) +\n  xlab(expression(paste(Phi, \" = \", logit(Theta)))) +\n  ylab(\"proportion of draws\") +\n  theme(\n    axis.text.y = element_blank(),\n    axis.ticks.y = element_blank(),\n    panel.spacing.x = unit(2, \"lines\"),\n    panel.spacing.y = unit(2, \"lines\")\n  )\nlog_odds_growth_plot\n\n\n\nFigura 10.6: Istogramma di \\(M\\) campioni casuali \\(\\Theta \\sim \\mbox{Uniform}(0, 1)\\) trasformati in valori \\(\\Phi = \\mbox{logit}(\\Theta).\\) Il profilo limite dell’istogramma è evidenziato nella figura in basso a destra che è stata costruita usando \\(1\\,000\\,000\\) di osservazioni.\n\n\n\n\nIn un istogramma, l’area di ciascuna barra è proporzionale alla frequenza relativa delle osservazioni in quel’intervallo. Perché tutti gli intervalli hanno la stessa ampiezza, anche l’altezza di ciascuna barra sarà proporzionale alla frequenza relativa delle osservazioni in quel’intervallo.\nNella simulazione, possiamo pensare all’area di ciascuna barra dell’istogramma come alla stima della probabilità che la variabile casuale assuma un valore compreso nell’intervallo considerato. All’aumentare del numero \\(M\\) di osservazioni, le probabilità stimate si avvicinano sempre di più ai veri valori della probabilità. All’aumentare del numero degli intervalli (quando l’ampiezza \\(\\Delta\\) dell’intervallo \\(\\rightarrow\\) 0), il profilo dell’istogramma tende a diventare una curva continua. Tale curva continua è la funzione di densità di probabilità della variabile casuale. Per l’esempio presente, con \\(M =1\\,000\\,000\\), otteniamo il grafico riportato nella figura @ref(fig:hist-dens-example).\n\nCodiceM <- 1e6\nalpha <- logit(runif(M))\ndensity_limit_df <- data.frame(alpha = alpha)\ndensity_limit_plot <-\n  density_limit_df %>%\n  ggplot(aes(alpha)) +\n  geom_histogram(\n    stat = \"density\", n = 75, color = \"black\", size = 0.15\n  ) +\n  stat_function(\n    fun = dlogis,\n    args = list(location = 0, scale = 1),\n    col = \"black\",\n    size = 0.3\n  ) +\n  scale_x_continuous(\n    lim = c(-9, 9),\n    breaks = c(-6, -4, -2, 0, 2, 4, 6)\n  ) +\n  xlab(\n    expression(paste(Phi, \" = \", logit(Theta)))\n  ) +\n  ylab(\"Frequenza relativa\") +\n  theme(\n    axis.text.y = element_blank(),\n    axis.ticks.y = element_blank()\n  )\ndensity_limit_plot\n\n\n\nFigura 10.7: Istogramma di \\(M = 1\\,000\\,000\\) campioni casuali \\(\\Theta \\sim \\mbox{Uniform}(0,1)\\) trasformati in valori \\(\\Phi = \\mbox{logit}(\\Theta)\\). La spezzata nera congiunge i punti centrali superiori delle barre dell’istogramma. Nel limite, quando il numero di osservazioni e di barre tende all’infinito, tale spezzata approssima la funzione di densità di probabilità della variabile casuale.\n\n\n\n\nNella statistica descrittiva abbiamo già incontrato una rappresentazione che ha lo stesso significato della funzione di densità, ovvero il kernel density plot. La stima della densità del kernel (KDE), infatti, è un metodo non parametrico per stimare la funzione di densità di probabilità di una variabile casuale."
  },
  {
    "objectID": "019_density_func.html#funzione-di-densità-di-probabilità",
    "href": "019_density_func.html#funzione-di-densità-di-probabilità",
    "title": "10  La densità di probabilità",
    "section": "\n10.5 Funzione di densità di probabilità",
    "text": "10.5 Funzione di densità di probabilità\nPer descrivere le probabilità che possono essere associate ad una variabile casuale continua \\(X\\) è necessario definire una funzione \\(p(X)\\) che deve soddisfare le seguenti due proprietà:\n\n\n\\(p(x) \\geq 0, \\forall x\\), ovvero, l’ordinata della funzione di densità è 0 o positiva;\n\n\\(\\int_{-\\infty}^{\\infty} p(x) \\,\\operatorname {d}\\!x = 1\\), ovvero, l’area sottesa dalla \\(p(x)\\) è unitaria3;\n\n\\(p(a < x < b) = \\int_a^b p(x) \\,\\operatorname {d}\\!x\\), se \\(a \\leq b\\), ovvero, l’area sottesa dalla \\(p(y)\\) tra due punti \\(a\\) e \\(b\\) corrisponde alla probabilità che la v.c. \\(x\\) assuma un valore compresto tra questi due estremi.\n\nInterpretazione. È possibile che \\(p(x) > 1\\), quindi una densità di probabilità non può essere interpretata come una probabilità. Piuttosto, la densità \\(p(x)\\) può essere utilizzata per confrontare la fiducia relativa che può essere assegnata a diversi valori \\(x\\). Considerata una variabile casuale \\(X\\) di cui è disponibile un insieme di realizzazioni, possiamo dire che, se consideriamo due valori \\(x_k\\) e \\(x_l\\) con \\(p(x_k) > p(x_l)\\), allora possiamo concludere che è più probabile, in termini relativi, osservare realizzazioni \\(X\\) nell’intorno di \\(x_k\\) piuttosto che nell’intorno di \\(x_l\\)."
  },
  {
    "objectID": "019_density_func.html#la-funzione-di-ripartizione",
    "href": "019_density_func.html#la-funzione-di-ripartizione",
    "title": "10  La densità di probabilità",
    "section": "\n10.6 La funzione di ripartizione",
    "text": "10.6 La funzione di ripartizione\nLa funzione di ripartizione \\(F(X)\\) è quella funzione che associa a ogni valore di una variabile casuale \\(X\\) la probabilità che la variabile assuma valore minore o uguale a un prefissato valore \\(x_k\\). Come nel caso discreto, anche nel caso continuo la funzione di ripartizione è sempre non negativa, monotona non decrescente tra \\(0\\) e \\(1\\), tale che:\n\\[\n\\lim_{x \\to -\\infty} F_x(X) = F_X(-\\infty) = 0, \\quad \\lim_{x \\to +\\infty} F_X(X) = F_X(+\\infty) = 1.\n\\]\n\n\n\n\n\nSe \\(X\\) è una variabile aleatoria continua, la funzione di ripartizione è:\n\\[\nF(x_k) = P(X \\leq x_k) = \\int_{-\\infty}^{x_k} f(x) \\,\\operatorname {d}\\!x .\n\\]"
  },
  {
    "objectID": "019_density_func.html#media-e-mediana",
    "href": "019_density_func.html#media-e-mediana",
    "title": "10  La densità di probabilità",
    "section": "\n10.7 Media e mediana",
    "text": "10.7 Media e mediana\nConcludiamo questo capitolo con alcune considerazioni relative al contronto tra la media (valore atteso) e la mediana, nel caso di variabili casuali continue.\nPer distribuzioni simmetriche, sappiamo che la media e la mediana sono uguali. Chiediamoci ora cosa succede, nel caso di variabili casuali continue, nel caso di distribuzioni asimmetriche.\nLa mediana indica il punto in cui la “massa totale” della distribuzione è suddivisa in due porzioni uguali. Nel caso della densità di probabilità, ciascuna di queste porzioni rappresenta un’area uguale, \\(A_1 = A_2 = 1/2\\) poiché l’area totale sottesa alla funzione di densità è 1 per definizione.\n\n\n\n\nFigura 10.8: Qual è la differenza tra mediana e media in una funzione di densità?\n\n\n\n\nLa Figura 10.8 mostra come differiscono i due concetti di mediana (indicata dalla linea verticale) e media (indicata dal “punto di equilibrio” triangolare). A sinistra, per una densità di probabilità simmetrica, la media e la mediana coincidono. A destra, una piccola porzione della distribuzione è stata spostata all’estremo destro. Questa modifica non ha influito sulla posizione della mediana, poiché le aree a destra e a sinistra della linea verticale sono ancora uguali. In altri termini, la mediana, \\(x_m\\), divide l’area sottesa alla funzione di densità in due porzioni uguali:\n\\[\n\\int_{-\\infty}^{x_m} p(x) dx = \\int_{x_m}^{-\\infty} p(x) dx = \\frac{1}{2}.\n\\]\nSegue da tale definizione che la mediana è il valore \\(x\\) per il quale la distribuzione cumulativa soddisfa\n\\[\nF(x_m) = \\frac{1}{2}.\n\\]\nTuttavia, il fatto che una parte della massa sia stata allontanata verso destra porta a uno spostamento della media della distribuzione, per compensare tale cambiamento. In altre parole, la media contiene più informazioni sulla distribuzione “spaziale” delle osservazioni, rispetto alla mediana. Ciò deriva dal fatto che la media della distribuzione (il valore atteso) è una “somma” – cioè è un integrale – di termini cha hanno la forma \\(x p(x) \\Delta x\\). Quindi la posizione lungo l’asse \\(x\\), ovvero \\(x\\), e non solo la “massa”, \\(p(x) \\Delta x\\), influenza il contributo che le componenti della distribuzione hanno sulla media."
  },
  {
    "objectID": "020_expval_var.html",
    "href": "020_expval_var.html",
    "title": "11  Valore atteso e varianza",
    "section": "",
    "text": "Spesso risulta utile fornire una rappresentazione sintetica della distribuzione di una variabile casuale attraverso degli indicatori caratteristici piuttosto che fare riferimento ad una sua rappresentazione completa mediante la funzione di ripartizione, o la funzione di massa o di densità di probabilità. Una descrizione più sintetica di una variabile casuale, tramite pochi valori, ci consente di cogliere le caratteristiche essenziali della distribuzione, quali: la posizione, cioè il baricentro della distribuzione di probabilità; la variabilità, cioè la dispersione della distribuzione di probabilità attorno ad un centro; la forma della distribuzione di probabilità, considerando la simmetria e la curtosi (pesantezza delle code). In questo Capitolo introdurremo quegli indici sintetici che descrivono il centro di una distribuzione di probabilità e la sua variabilità."
  },
  {
    "objectID": "020_expval_var.html#valore-atteso",
    "href": "020_expval_var.html#valore-atteso",
    "title": "11  Valore atteso e varianza",
    "section": "\n11.1 Valore atteso",
    "text": "11.1 Valore atteso\nQuando vogliamo conoscere il comportamento tipico di una variabile casuale spesso vogliamo sapere qual è il suo “valore tipico”. La nozione di “valore tipico”, tuttavia, è ambigua. Infatti, essa può essere definita in almeno tre modi diversi:\n\nla media (somma dei valori divisa per il numero dei valori),\nla mediana (il valore centrale della distribuzione, quando la variabile è ordinata in senso crescente o decrescente),\nla moda (il valore che ricorre più spesso).\n\nPer esempio, la media di \\(\\{3, 1, 4, 1, 5\\}\\) è \\(\\frac{3+1+4+1+5}{5} = 2.8\\), la mediana è \\(3\\) e la moda è \\(1\\). Tuttavia, la teoria delle probabilità si occupa di variabili casuali piuttosto che di sequenze di numeri. Diventa dunque necessario precisare che cosa intendiamo per “valore tipico” quando facciamo riferimento alle variabili casuali. Giungiamo così alla seguente definizione. \n\nDefinizione 11.1 Sia \\(Y\\) è una variabile casuale discreta che assume i valori \\(y_1, \\dots, y_n\\) con distribuzione \\(P(Y = y_i) = p(y_i)\\). Per definizione il valore atteso di \\(Y\\), \\(\\mathbb{E}(Y)\\), è\n\\[\n\\mathbb{E}(Y) = \\sum_{i=1}^n y_i \\cdot p(y_i).\n\\tag{11.1}\\]\n\nA parole: il valore atteso (o speranza matematica, o aspettazione, o valor medio) di una variabile casuale è definito come la somma di tutti i valori che la variabile casuale può prendere, ciascuno pesato dalla probabilità con cui il valore è preso.\n\nEsercizio 11.1 \nSi calcoli il valore atteso della variabile casuale \\(Y\\) corrispondente al lancio di una moneta equilibrata (testa: Y = 1; croce: Y = 0).\n\n\nSoluzione. Abbiamo\n\\[\n\\mathbb{E}(Y) = \\sum_{i=1}^{2} y_i \\cdot P(y_i) = 0 \\cdot \\frac{1}{5} + 1 \\cdot \\frac{1}{5} = 0.5.\n\\]\n\n\nEsercizio 11.2 \nSi calcoli il valore atteso della variabile casuale \\(Y\\) corrispondente ai punti ottenuti dal lancio di un dado equilibrato.\n\n\nSoluzione. Il valore atteso di \\(Y\\) è\n\\[\n\\mathbb{E}(Y) = \\sum_{i=1}^{6} y_i \\cdot P(y_i) = 1 \\cdot \\frac{1}{6} + 2 \\cdot \\frac{1}{6} + \\dots + 6 \\cdot \\frac{1}{6} = \\frac{21}{6} = 3.5.\n\\]\n\n\n11.1.1 Interpretazione\nChe interpretazione può essere assegnata alla nozione di valore atteso? Bruno de Finetti adottò lo stesso termine di previsione (e lo stesso simbolo) tanto per la probabilità che per la speranza matematica. Si può pertanto dire che, dal punto di vista bayesiano, la speranza matematica è l’estensione naturale della nozione di probabilità soggettiva.\n\n11.1.2 Proprietà del valore atteso\nLa proprietà più importante del valore atteso è la linearità: il valore atteso di una somma di variabili casuali è uguale alla somma dei lori rispettivi valori attesi:\n\\[\n\\mathbb{E}(X + Y) = \\mathbb{E}(X) + \\mathbb{E}(Y).\n\\tag{11.2}\\]\nL’Equazione 11.2 sembra ragionevole quando \\(X\\) e \\(Y\\) sono indipendenti, ma è anche vera quando \\(X\\) e \\(Y\\) sono associati. Abbiamo anche che\n\\[\n\\mathbb{E}(cY) = c \\mathbb{E}(Y).\n\\tag{11.3}\\]\nL’Equazione 11.3 ci dice che possiamo estrarre una costante dall’operatore di valore atteso. Tale proprietà si estende a qualunque numero di variabili casuali. Infine, se due variabili casuali \\(X\\) e \\(Y\\) sono indipendenti, abbiamo che\n\\[\n\\mathbb{E}(X Y) = \\mathbb{E}(X) \\mathbb{E}(Y).\n\\tag{11.4}\\]\n\nEsercizio 11.3 \nSi considerino le seguenti variabili casuali: \\(Y\\), ovvero il numero che si ottiene dal lancio di un dado equilibrato, e \\(Y\\), il numero di teste prodotto dal lancio di una moneta equilibrata. Si trovi il valore atteso di \\(X+Y\\).\n\n\nSoluzione. Per risolvere il problema iniziamo a costruire lo spazio campionario dell’esperimento casuale consistente nel lancio di un dado e di una moneta.\n\n\n\n\n\n\n\n\n\n\n\n\\(x \\textbackslash y\\)\n1\n2\n3\n4\n5\n6\n\n\n\n0\n(0, 1)\n(0, 2)\n(0, 3)\n(0, 4)\n(0, 5)\n(0, 6)\n\n\n1\n(1, 1)\n(1, 2)\n(1, 3)\n(1, 4)\n(1, 5)\n(1, 6)\n\n\n\novvero\n\n\n\\(x \\textbackslash y\\)\n1\n2\n3\n4\n5\n6\n\n\n\n0\n1\n2\n3\n4\n5\n6\n\n\n1\n2\n3\n4\n5\n6\n7\n\n\n\nIl risultato del lancio del dado è indipendente dal risultato del lancio della moneta. Pertanto, ciascun evento elementare dello spazio campionario avrà la stessa probabilità di verificarsi, ovvero \\(P(\\omega) = \\frac{1}{12}\\). Il valore atteso di \\(X+Y\\) è dunque uguale a:\n\\[\n\\mathbb{E}(X+Y) = 1 \\cdot \\frac{1}{12} + 2 \\cdot \\frac{1}{12} + \\dots + 7 \\cdot \\frac{1}{12} = 4.0.\n\\]\nLo stesso risultato si ottiene nel modo seguente:\n\\[\n\\mathbb{E}(X+Y) = \\mathbb{E}(X) + E(Y) = 3.5 + 0.5 = 4.0.\n\\]\n\n\nEsercizio 11.4 \nSi considerino le variabili casuali \\(X\\) e \\(Y\\) definite nel caso del lancio di tre monete equilibrate, dove \\(X\\) conta il numero delle teste nei tre lanci e \\(Y\\) conta il numero delle teste al primo lancio. Si calcoli il valore atteso del prodotto delle variabili casuali \\(X\\) e \\(Y\\).\n\n\nSoluzione. La distribuzione di probabilità congiunta \\(P(X, Y)\\) è fornita nella tabella seguente.\n\n\n\\(x \\textbackslash y\\)\n0\n1\n\\(p(Y)\\)\n\n\n\n0\n1/8\n0\n1/8\n\n\n1\n2/8\n1/8\n3/8\n\n\n2\n1/8\n2/8\n3/8\n\n\n3\n0\n1/8\n1/8\n\n\n\\(p(y)\\)\n4/8\n4/8\n1.0\n\n\n\nIl calcolo del valore atteso di \\(XY\\) si riduce a\n\\[\n\\mathbb{E}(XY) = 1 \\cdot \\frac{1}{8} + 2 \\cdot \\frac{2}{8} + 3 \\cdot \\frac{1}{8} = 1.0.\n\\]\nSi noti che le variabili casuali \\(Y\\) e \\(Y\\) non sono indipendenti. Dunque non possiamo usare la proprietà del ?thm-prodindrv. Infatti, il valore atteso di \\(X\\) è\n\\[\n\\mathbb{E}(X) = 1 \\cdot \\frac{3}{8} + 2 \\cdot \\frac{3}{8} + 3 \\cdot \\frac{1}{8} = 1.5\n\\]\ne il valore atteso di \\(Y\\) è\n\\[\n\\mathbb{E}(Y) = 0 \\cdot \\frac{4}{8} + 1 \\cdot \\frac{4}{8} = 0.5.\n\\]\nPerciò\n\\[\n1.5 \\cdot 0.5 \\neq 1.0.\n\\]\n\n\n11.1.3 Variabili casuali continue\nNel caso di una variabile casuale continua \\(Y\\) il valore atteso diventa:\n\\[\n\\mathbb{E}(Y) = \\int_{-\\infty}^{+\\infty} y p(y) \\,\\operatorname {d}\\!y.\n\\tag{11.5}\\]\nAnche in questo caso il valore atteso è una media ponderata della \\(y\\), nella quale ciascun possibile valore \\(y\\) è ponderato per il corrispondente valore della densità \\(p(y)\\). Possiamo leggere l’integrale pensando che \\(y\\) rappresenti l’ampiezza delle barre infinitamente strette di un istogramma, con la densità \\(p(y)\\) che corrisponde all’altezza di tali barre e la notazione \\(\\int_{-\\infty}^{+\\infty}\\) che corrisponde ad una somma.\nUn’altra misura di tendenza centrale delle variabili casuali continue è la moda. La moda della \\(Y\\) individua il valore \\(y\\) più plausibile, ovvero il valore \\(y\\) che massimizza la funzione di densità \\(p(y)\\):\n\\[\n\\mbox{Mo}(Y) = \\mbox{argmax}_y p(y).\n\\tag{11.6}\\]"
  },
  {
    "objectID": "020_expval_var.html#varianza",
    "href": "020_expval_var.html#varianza",
    "title": "11  Valore atteso e varianza",
    "section": "\n11.2 Varianza",
    "text": "11.2 Varianza\nLa seconda più importante proprietà di una variabile casuale, dopo che conosciamo il suo valore atteso, è la varianza.\n\nDefinizione 11.2 Se \\(Y\\) è una variabile casuale discreta con distribuzione \\(p(y)\\), per definizione la varianza di \\(Y\\), \\(\\mathbb{V}(Y)\\), è\n\\[\n\\mathbb{V}(Y) = \\mathbb{E}\\Big[\\big(Y - \\mathbb{E}(Y)\\big)^2\\Big].\n\\tag{11.7}\\]\n\nA parole: la varianza è la deviazione media quadratica della variabile dalla sua media.1 Se denotiamo \\(\\mathbb{E}(Y) = \\mu\\), la varianza \\(\\mathbb{V}(Y)\\) diventa il valore atteso di \\((Y - \\mu)^2\\).\n\nEsercizio 11.5 \nPosta \\(S\\) uguale alla somma dei punti ottenuti nel lancio di due dadi equilibrati, si calcoli la varianza di \\(S\\).\n\n\nSoluzione. La variabile casuale \\(S\\) ha la seguente distribuzione di probabilità:\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\\(s\\)\n2\n3\n4\n5\n6\n7\n8\n9\n10\n11\n12\n\n\n\\(P(S = s)\\)\n\\(\\frac{1}{36}\\)\n\\(\\frac{2}{36}\\)\n\\(\\frac{3}{36}\\)\n\\(\\frac{4}{36}\\)\n\\(\\frac{5}{36}\\)\n\\(\\frac{6}{36}\\)\n\\(\\frac{5}{36}\\)\n\\(\\frac{4}{36}\\)\n\\(\\frac{3}{36}\\)\n\\(\\frac{2}{36}\\)\n\\(\\frac{1}{36}\\)\n\n\nEssendo \\(\\mathbb{E}(S) = 7\\), la varianza diventa\n\\[\n\\begin{align}\n\\mathbb{V}(S) &= \\sum \\left(S- \\mathbb{E}(S)\\right)^2 \\cdot P(S) \\notag\\\\\n&= (2 - 7)^2 \\cdot 0.0278 + (3-7)^2 \\cdot 0.0556 + \\dots + (12 - 7)^2 \\cdot 0.0278 \\notag\\\\\n&= 5.8333.\\notag\n\\end{align}\n\\]\n\n\n11.2.1 Formula alternativa per la varianza\nC’è un modo più semplice per calcolare la varianza:\n\\[\n\\begin{align}\n\\mathbb{E}\\Big[\\big(Y - \\mathbb{E}(Y)\\big)^2\\Big] &= \\mathbb{E}\\big(Y^2 - 2Y\\mathbb{E}(Y) + \\mathbb{E}(Y)^2\\big)\\notag\\\\\n&= \\mathbb{E}(Y^2) - 2\\mathbb{E}(Y)\\mathbb{E}(Y) + \\mathbb{E}(Y)^2,\n\\end{align}\n\\]\ndato che \\(\\mathbb{E}(Y)\\) è una costante. Pertanto\n\\[\n\\mathbb{V}(Y) = \\mathbb{E}(Y^2) - \\big(\\mathbb{E}(Y) \\big)^2.\n\\tag{11.8}\\]\nA parole: la varianza è la media dei quadrati meno il quadrato della media.\n\nEsercizio 11.6 \nConsideriamo la variabile casuale \\(Y\\) che corrisponde al numero di teste che si osservano nel lancio di una moneta truccata con probabilità di testa uguale a 0.8. Si trovi la varianza di \\(Y\\).\n\n\nSoluzione. Il valore atteso di \\(Y\\) è\n\\[\n\\mathbb{E}(Y) = 0 \\cdot 0.2 + 1 \\cdot 0.8 = 0.8.\n\\]\nUsando la formula tradizionale della varianza otteniamo:\n\\[\n\\mathbb{V}(Y) = (0 - 0.8)^2 \\cdot 0.2 + (1 - 0.8)^2 \\cdot 0.8 = 0.16.\n\\]\nLo stesso risultato si trova con la formula alternativa della varianza. Il valore atteso di \\(Y^2\\) è\n\\[\n\\mathbb{E}(Y^2) = 0^2 \\cdot 0.2 + 1^2 \\cdot 0.8 = 0.8.\n\\]\ne la varianza diventa\n\\[\n\\mathbb{V}(Y) = \\mathbb{E}(Y^2) - \\big(\\mathbb{E}(Y) \\big)^2 = 0.8 - 0.8^2 = 0.16.\n\\]\n\n\n11.2.2 Variabili casuali continue\nNel caso di una variabile casuale continua \\(Y\\), la varianza diventa:\n\\[\n\\mathbb{V}(Y) = \\int_{-\\infty}^{+\\infty} \\large[y - \\mathbb{E}(Y)\\large]^2 p(y) \\,\\operatorname {d}\\!y.\n\\tag{11.9}\\]\nCome nel caso discreto, la varianza di una v.c. continua \\(Y\\) misura approssimativamente la distanza al quadrato tipica o prevista dei possibili valori \\(Y\\) dalla loro media."
  },
  {
    "objectID": "020_expval_var.html#deviazione-standard",
    "href": "020_expval_var.html#deviazione-standard",
    "title": "11  Valore atteso e varianza",
    "section": "\n11.3 Deviazione standard",
    "text": "11.3 Deviazione standard\nQuando lavoriamo con le varianze, i termini sono innalzati al quadrato e quindi i numeri possono diventare molto grandi (o molto piccoli). Per trasformare nuovamente i valori nell’unità di misura della scala originaria si prende la radice quadrata. Il valore risultante viene chiamato deviazione standard e solitamente è denotato dalla lettera greca \\(\\sigma\\).\n\nDefinizione 11.3 Si definisce scarto quadratico medio (o deviazione standard o scarto tipo) la radice quadrata della varianza:\n\\[\n\\sigma_Y = \\sqrt{\\mathbb{V}(Y)}.\n\\tag{11.10}\\]\n\nInterpretiamo la deviazione standard di una variabile casuale come nella statistica descrittiva: misura approssimativamente la distanza tipica o prevista dei possibili valori \\(y\\) dalla loro media.\n\nEsercizio 11.7 \nPer i dadi equilibrati dell’Esercizio 11.5, la deviazione standard della variabile casuale \\(S\\) è uguale a \\(\\sqrt{5.833} = 2.415\\)."
  },
  {
    "objectID": "020_expval_var.html#standardizzazione",
    "href": "020_expval_var.html#standardizzazione",
    "title": "11  Valore atteso e varianza",
    "section": "\n11.4 Standardizzazione",
    "text": "11.4 Standardizzazione\n\nDefinizione 11.4 Data una variabile casuale \\(Y\\), si dice variabile standardizzata di \\(Y\\) l’espressione\n\\[\nZ = \\frac{Y - \\mathbb{E}(Y)}{\\sigma_Y}.\n\\tag{11.11}\\]\n\nSolitamente, una variabile standardizzata viene denotata con la lettera \\(Z\\)."
  },
  {
    "objectID": "020_expval_var.html#momenti-di-variabili-casuali",
    "href": "020_expval_var.html#momenti-di-variabili-casuali",
    "title": "11  Valore atteso e varianza",
    "section": "\n11.5 Momenti di variabili casuali",
    "text": "11.5 Momenti di variabili casuali\n\nSi chiama momento di ordine \\(q\\) di una v.c. \\(X\\), dotata di densità \\(p(x)\\), la quantità\n\\[\n\\mathbb{E}(X^q) = \\int_{-\\infty}^{+\\infty} x^q p(x) \\; dx.\n\\tag{11.12}\\]\nSe \\(X\\) è una v.c. discreta, i suoi momenti valgono:\n\\[\n\\mathbb{E}(X^q) = \\sum_i x_i^q P(x_i).\n\\tag{11.13}\\]\n\nI momenti sono importanti parametri indicatori di certe proprietà di \\(X\\). I più noti sono senza dubbio quelli per \\(q = 1\\) e \\(q = 2\\). Il momento del primo ordine corrisponde al valore atteso di \\(X\\). Spesso i momenti di ordine superiore al primo vengono calcolati rispetto al valor medio di \\(X\\), operando una traslazione \\(x_0 = x − \\mathbb{E}(X)\\) che individua lo scarto dalla media. Ne deriva che il momento centrale di ordine 2 corrisponde alla varianza."
  },
  {
    "objectID": "020_expval_var.html#covarianza",
    "href": "020_expval_var.html#covarianza",
    "title": "11  Valore atteso e varianza",
    "section": "\n11.6 Covarianza",
    "text": "11.6 Covarianza\nLa covarianza quantifica la tendenza delle variabili aleatorie \\(X\\) e \\(Y\\) a “variare assieme”. Per esempio, l’altezza e il peso delle giraffe producono una covarianza positiva perché all’aumentare di una di queste due quantità tende ad aumentare anche l’altra. La covarianza misura la forza e la direzione del legame lineare tra due variabili aleatorie \\(X\\) ed \\(Y\\). Si utilizza la notazione \\(\\mbox{Cov}(X,Y)=\\sigma_{xy}\\).\n\nDefinizione 11.5 Date due variabili aleatorie \\(X\\), \\(Y\\), chiamiamo covarianza tra \\(X\\) ed \\(Y\\) il numero\n\\[\n\\mbox{Cov}(X,Y) = \\mathbb{E}\\Bigl(\\bigl(X - \\mathbb{E}(X)\\bigr) \\bigl(Y - \\mathbb{E}(Y)\\bigr)\\Bigr),\n\\tag{11.14}\\]\ndove \\(\\mathbb{E}(X)\\) e \\(\\mathbb{E}(Y)\\) sono i valori attesi di \\(X\\) ed \\(Y\\).\n\nIn maniera esplicita,\n\\[\n\\mbox{Cov}(X,Y) = \\sum_{(x,y) \\in \\Omega} (x - \\mu_X) (y - \\mu_Y) f(x, y).\n\\tag{11.15}\\]\nLa definizione è analoga, algebricamente, a quella di varianza e risulta infatti\n\\[\n\\mathbb{V}(x) = \\mbox{Cov}(X, X)\n\\]\ne\n\\[\n\\mbox{Cov}(X,Y) = \\mathbb{E}(XY) - \\mathbb{E}(Y)\\mathbb{E}(X).\n\\tag{11.16}\\]\n\nDimostrazione. L’Equazione 11.16 si ricava nel modo seguente:\n\\[\n\\begin{align}\n\\mbox{Cov}(X,Y) &= \\mathbb{E}\\Bigl(\\bigl(X-\\mathbb{E}(X)\\bigr) \\bigl(Y-\\mathbb{E}(Y)\\bigr)\\Bigr)\\notag\\\\\n          %&= \\mathbb{E}(XY) - \\mathbb{E}(Y)X -\\mathbb{E}(X)Y + \\mathbb{E}(X)\\mathbb{E}(Y) )\\notag\\\\\n          &= \\mathbb{E}(XY) - \\mathbb{E}(Y)\\mathbb{E}(X) - \\mathbb{E}(X)\\mathbb{E}(Y) + \\mathbb{E}(X)\\mathbb{E}(Y)\\notag\\\\\n          &= \\mathbb{E}(XY) - \\mathbb{E}(Y)\\mathbb{E}(X)\\notag.\n\\end{align}\n\\]\n\n\nEsercizio 11.8 \nConsideriamo le variabili casuali definite nell’Esercizio 2.4. Si calcoli la covarianza di \\(X\\) e \\(Y\\).\n\n\nSoluzione. Abbiamo che \\(\\mu_X = 1.5\\) e \\(\\mu_Y = 0.5\\). Ne segue che la covarianza di \\(X\\) e \\(Y\\) è:\n\\[\n\\begin{align}\n\\mbox{Cov}(X,Y) &= \\sum_{(x,y) \\in \\Omega} (x - \\mu_X) (y - \\mu_Y) f(x, y)\\notag\\\\\n&= (0-1.5)(0-0.5)\\cdot \\frac{1}{8} + (0-1.5)(1-0.5) \\cdot 0 \\\\\n   &\\qquad + (1-1.5)(0-0.5)\\cdot \\frac{2}{8} + (1-1.5)(1-0.5) \\cdot \\frac{1}{8} \\notag\\\\\n    &\\qquad+ (2-1.5)(0-0.5) \\cdot \\frac{1}{8} + (2-1.5)(1-0.5) \\cdot \\frac{2}{8} \\\\\n   &\\qquad+ (3-1.5)(0-0.5) \\cdot 0 +  (3-1.5)(1-0.5)\\cdot\\frac{1}{8} \\notag\\\\\n   &= \\frac{1}{4}. \\notag\n\\end{align}\n\\]\nLo stesso risultato può essere trovato nel modo seguente. Iniziamo a calcolare il valore atteso del prodotto \\(XY\\):\n\\[\n\\mathbb{E}(XY) = 0 \\cdot\\frac{4}{8} + 1 \\cdot\\frac{1}{8} + 2 \\cdot\\frac{2}{8} + 3 \\cdot\\frac{1}{8} = 1.0.\n\\]\nDunque, la covarianza tra \\(X\\) e \\(Y\\) diventa\n\\[\n\\begin{align}\n\\mbox{Cov}(X,Y) &= \\mathbb{E}(XY) - \\mathbb{E}(X)\\mathbb{E}(Y)\\notag\\\\\n&= 1 -  1.5\\cdot 0.5 \\notag\\\\\n&= 0.25.\\notag\n\\end{align}\n\\]"
  },
  {
    "objectID": "020_expval_var.html#correlazione",
    "href": "020_expval_var.html#correlazione",
    "title": "11  Valore atteso e varianza",
    "section": "\n11.7 Correlazione",
    "text": "11.7 Correlazione\nLa covarianza dipende dall’unità di misura delle due variabili e quindi non consente di stabilire l’intensità della relazione. Una misura standardizzata della relazione che intercorre fra due variabili è invece rappresentata dalla correlazione. La correlazione si ottiene dividendo la covarianza per le deviazioni standard delle due variabili aleatorie.\n\nIl coefficiente di correlazione tra \\(X\\) ed \\(Y\\) è il numero definito da\n\\[\n\\rho(X,Y) =\\frac{\\mbox{Cov}(X,Y)}{\\sqrt{\\mathbb{V}(X)\\mathbb{V}(Y)}}.\n\\tag{11.17}\\]\n\nSi può anche scrivere \\(\\rho_{X,Y}\\) al posto di \\(\\rho(X,Y)\\).\nIl coefficiente di correlazione \\(\\rho_{xy}\\) è un numero puro, cioè non dipende dall’unità di misura delle variabili, e assume valori compresi tra -1 e +1."
  },
  {
    "objectID": "020_expval_var.html#proprietà",
    "href": "020_expval_var.html#proprietà",
    "title": "11  Valore atteso e varianza",
    "section": "\n11.8 Proprietà",
    "text": "11.8 Proprietà\n\nLa covarianza tra una variabile aleatoria \\(X\\) e una costante \\(c\\) è nulla: \\(\\mbox{Cov}(c,X) = 0;\\)\nla covarianza è simmetrica: \\(\\mbox{Cov}(X,Y) = \\mbox{Cov}(Y,X);\\)\nvale \\(-1 \\leq \\rho(X,Y) \\leq 1;\\)\nla correlazione non dipende dall’unità di misura: \\(\\rho(aX, bY) = \\rho(X,Y), \\qquad \\forall a, b > 0;\\)\nse \\(Y = a + bX\\) è una funzione lineare di \\(X\\) con costanti \\(a\\) e \\(b\\), allora \\(\\rho(X,Y) = \\pm 1\\), a seconda del segno di \\(b\\);\nla covarianza tra \\(X\\) e \\(Y\\), ciascuna moltiplicata per una costante, è uguale al prodotto delle costanti per la covarianza tra \\(X\\) e \\(Y\\): \\(\\mbox{Cov}(aX,bY) = ab \\;\\mbox{Cov}(X,Y), \\qquad \\forall a,b \\in\\);\nvale \\(\\mathbb{V}(X \\pm Y) = \\mathbb{V}(X) + \\mathbb{V}(Y) \\pm 2 \\cdot \\mbox{Cov}(X,Y)\\);\nvale \\(\\mbox{Cov}(X + Y, Z) = \\mbox{Cov}(X,Z) + \\mbox{Cov}(Y,Z);\\)\nper una sequenza di variabili aleatorie \\(X_1, \\dots, X_n\\), si ha \\(\\mathbb{V}\\left( \\sum_{i=1}^n X_i\\right) = \\sum_{i=1}^n \\mathbb{V}(X_i) + 2\\sum_{i,j: i<j}cov(X_i, X_j);\\)\nvale \\(\\mbox{Cov}\\left(\\sum_{i=1}^n a_i X_i, \\sum_{j=1}^m b_jY_j\\right) = \\sum_{i=1}^n \\sum_{j=1}^m a_j b_j\\mbox{Cov}(X_j, Y_j);\\)\nse \\(X_1, X_2, \\dots, X_n\\) sono indipendenti, allora \\(\\mbox{Cov}\\left(\\sum_{i=1}^n a_i X_i, \\sum_{j=1}^n b_jX_j\\right) = \\sum_{i=1}^n a_i b_i \\mathbb{V}(X_i).\\)\n\n\n11.8.1 Incorrelazione\n\nDefinizione 11.6 Si dice che \\(X\\) ed \\(Y\\) sono incorrelate, o linermente indipendenti, se la loro covarianza è nulla,\n\\[\n\\sigma_{XY} = \\mathbb{E} \\big[(X - \\mu_X) (y-\\mu_u) \\big] = 0,\n\\tag{11.18}\\]\nche si può anche scrivere come\n\\[\n\\rho_{XY} = 0, \\quad \\mathbb{E}(XY) = \\mathbb{E}(X) \\mathbb{E}(Y).\n\\]\n\nSi introduce così un secondo tipo di indipendenza, più debole, dopo quello di indipendenza stocastica. Viceversa, però, se \\(\\mbox{Cov}(X, Y) = 0\\), non è detto che \\(X\\) ed \\(Y\\) siano indipendenti.\n\nEsercizio 11.9 Siano \\(X\\) e \\(Y\\) due variabili aleatorie discrete avente una distribuzione di massa di probabilità congiunta pari a\n\\[\nf_{XY}(x,y) = \\frac{1}{4} \\quad (x,y) \\in \\{(0,0), (1,1), (1, -1), (2,0) \\}\n\\]\ne zero altrimenti. Le due variabili aleatorie \\(X\\) e \\(Y\\) sono mutuamente indipendenti?\n\n\nSoluzione. La distribuzione marginale della \\(X\\) è\n\\[\n\\begin{cases}\nX = 0, \\quad  P_X = 1/4, \\\\\nX = 1, \\quad P_X = 2/4, \\\\\nX = 2, \\quad P_X = 1/4.\n\\end{cases}\n\\]\n\\[\n\\mathbb{E}(X) = 0 \\frac{1}{4} + 1 \\frac{2}{4} + 2 \\frac{1}{4} = 1.\n\\]\n\\[\n\\mathbb{E}(X^2) = 0^2 \\frac{1}{4} + 1^2 \\frac{2}{4} + 2^2 \\frac{1}{4} = \\frac{3}{2}.\n\\]\n\\[\n\\mathbb{V}(X) = \\frac{3}{2} - 1^2 = \\frac{1}{2}.\n\\]\nLa distribuzione marginale della \\(Y\\) è\n\\[\n\\begin{cases}\nY = -1, \\quad  P_Y = 1/4, \\\\\nY = 0, \\quad P_Y = 2/4, \\\\\nY = 1, \\quad P_Y = 1/4.\n\\end{cases}\n\\]\n\\[\n\\mathbb{E}(Y) = 0 \\frac{2}{4} + 1 \\frac{1}{4} + (-1) \\frac{1}{4} = 0.\n\\]\n\\[\n\\mathbb{E}(Y^2) = 0^2 \\frac{2}{4} + 1^2 \\frac{1}{4} + (-1)^2 \\frac{1}{4} = \\frac{1}{2}.\n\\]\n\\[\n\\mathbb{V}(X) = \\frac{1}{2} - 0^2 = \\frac{1}{2}.\n\\]\nCalcoliamo ora la covarianza tra \\(X\\) e \\(Y\\):\n\\[\n\\mathbb{E}(XY) = \\sum_x\\sum_y xy f_{XY} (x,y) =\n(0\\cdot 0)\\frac{1}{4} +\n(1\\cdot 1)\\frac{1}{4} +\n(1\\cdot -1)\\frac{1}{4} +\n(2\\cdot 0)\\frac{1}{4} = 0.\n\\]\n\\[\n\\mbox{Cov}(X,Y) = \\mathbb{E}(XY) - \\mathbb{E}(X)\\mathbb{E}(Y) = 0 - 1\\cdot0 = 0.\n\\]\nQuindi le due variabili aleatorie hanno covarianza pari a zero. Tuttavia, esse non sono indipendenti, in quanto non è vero che\n\\[\nf_{XY} (x,y) = f_X(x) f_Y(y)\n\\]\nper tutti gli \\(x\\) e \\(y\\).\n\nIn conclusione, anche se condizione di indipendenza implica una covarianza nulla, l’esempio precedente mostra come l’inverso non sia necessariamente vero: la covarianza può essere zero anche quando le due variabili aleatorie non sono indipendenti."
  },
  {
    "objectID": "020_expval_var.html#conclusioni",
    "href": "020_expval_var.html#conclusioni",
    "title": "11  Valore atteso e varianza",
    "section": "Conclusioni",
    "text": "Conclusioni\nLa densità di probabilità congiunta bivariata tiene simultaneamente conto del comportamento di due variabili aleatorie \\(X\\) e \\(Y\\) e di come esse si influenzino. Se \\(X\\) e \\(Y\\) sono legate linearmente, allora il coefficiente di correlazione\n\\[\\begin{equation}\n\\rho = \\frac{\\mbox{Cov}(X, Y)}{\\sigma_X \\sigma_Y}\\notag\n\\end{equation}\\]\nfornisce l’indice maggiormente utilizzato per descrivere l’intensità e il segno dell’associazione lineare. Nel caso di un’associazione lineare perfetta, \\(Y = a + bX\\), avremo \\(\\rho = 1\\) con \\(b\\) positivo ed \\(\\rho = -1\\) con \\(b\\) negativo. Se il coefficiente di correlazione è pari a 0 le variabili si dicono incorrelate. Condizione sufficiente (ma non necessaria) affinché \\(\\rho = 0\\) è che le due variabili siano tra loro indipendenti."
  },
  {
    "objectID": "distr.html",
    "href": "distr.html",
    "title": "Parte 3: Distribuzioni di v.c. discrete e continue",
    "section": "",
    "text": "In questa parte della dispensa verranno presentate le più importanti distribuzioni di massa di probabilità e di densità di probabilità."
  },
  {
    "objectID": "022_discr_rv_distr.html",
    "href": "022_discr_rv_distr.html",
    "title": "12  Distribuzioni di v.c. discrete",
    "section": "",
    "text": "In questo Capitolo verranno esaminate le principali distribuzioni di probabilità delle variabili casuali discrete. Un esperimento casuale che può dare luogo a solo due possibili esiti (successo, insuccesso) è modellabile con una variabile casuale di Bernoulli. Una sequenza di prove di Bernoulli costituisce un processo Bernoulliano. Il numero di successi dopo \\(n\\) prove di Bernoulli corrisponde ad una variabile casuale che segue la legge binomiale. La distribuzione binomiale risulta da un insieme di prove di Bernoulli solo se il numero totale \\(n\\) è fisso per disegno. Se il numero di prove è esso stesso una variabile casuale, allora il numero di successi nella corrispondente sequenza di prove bernoulliane segue al distribuzione di Poisson. Concluderemo con la distribuzione discreta uniforme."
  },
  {
    "objectID": "022_discr_rv_distr.html#una-prova-bernoulliana",
    "href": "022_discr_rv_distr.html#una-prova-bernoulliana",
    "title": "12  Distribuzioni di v.c. discrete",
    "section": "\n12.1 Una prova Bernoulliana",
    "text": "12.1 Una prova Bernoulliana\nSe un esperimento casuale ha solo due esiti possibili, allora le repliche indipendenti di questo esperimento sono chiamate “prove Bernoulliane” (il lancio di una moneta è il tipico esempio).\n\nDefinizione 12.1 Viene detta variabile di Bernoulli una variabile casuale discreta \\(Y = \\{0, 1\\}\\) con la seguente distribuzione di probabilità:\n\\[\nP(Y \\mid \\theta) =\n  \\begin{cases}\n    \\theta     & \\text{se $Y = 1$}, \\\\\n    1 - \\theta & \\text{se $Y = 0$},\n  \\end{cases}\n\\]\ncon \\(0 \\leq \\theta \\leq 1\\). Convenzionalmente l’evento \\(\\{Y = 1\\}\\) con probabilità \\(\\theta\\) viene chiamato “successo” mentre l’evento \\(\\{Y = 0\\}\\) con probabilità \\(1-\\theta\\) viene chiamato “insuccesso”.\n\nApplicando l’operatore di valore atteso e di varianza, otteniamo\n\\[\n\\begin{align}\n\\mathbb{E}(Y) &= 0 \\cdot P(Y=0) + 1 \\cdot P(Y=1) = \\theta, \\\\\n\\mathbb{V}(Y) &= (0 - \\theta)^2 \\cdot P(Y=0) + (1 - \\theta)^2 \\cdot P(Y=1) = \\theta(1-\\theta).\n\\end{align}\n\\tag{12.1}\\]\nScriviamo \\(Y \\sim \\mbox{Bernoulli}(\\theta)\\) per indicare che la variabile casuale \\(Y\\) ha una distribuzione Bernoulliana di parametro \\(\\theta\\).\n\nEsercizio 12.1 \nNel caso del lancio di una moneta equilibrata la variabile casuale di Bernoulli assume i valori \\(0\\) e \\(1\\). La distribuzione di massa di probabilità è pari a \\(\\frac{1}{2}\\) in corrispondenza di entrambi i valori. La funzione di distribuzione vale \\(\\frac{1}{2}\\) per \\(Y = 0\\) e \\(1\\) per \\(Y = 1\\)."
  },
  {
    "objectID": "022_discr_rv_distr.html#una-sequenza-di-prove-bernoulliane",
    "href": "022_discr_rv_distr.html#una-sequenza-di-prove-bernoulliane",
    "title": "12  Distribuzioni di v.c. discrete",
    "section": "\n12.2 Una sequenza di prove Bernoulliane",
    "text": "12.2 Una sequenza di prove Bernoulliane\nLa distribuzione binomiale è rappresentata dall’elenco di tutti i possibili numeri di successi \\(Y = \\{0, 1, 2, \\dots n\\}\\) che possono essere osservati in \\(n\\) prove Bernoulliane indipendenti di probabilità \\(\\theta\\), a ciascuno dei quali è associata la relativa probabilità. Esempi di una distribuzione binomiale sono i risultati di una serie di lanci di una stessa moneta o di una serie di estrazioni da un’urna (con reintroduzione). La distribuzione binomiale di parametri \\(n\\) e \\(\\theta\\) è in realtà una famiglia di distribuzioni: al variare dei parametri \\(\\theta\\) e \\(n\\) variano le probabilità.\n\nDefinizione 12.2 La probabilità di ottenere \\(y\\) successi e \\(n-y\\) insuccessi in \\(n\\) prove Bernoulliane è data dalla distribuzione binomiale:\n\\[\n\\begin{align}\nP(Y=y) &= \\binom{n}{y} \\theta^{y} (1-\\theta)^{n-y} \\notag \\\\\n&= \\frac{n!}{y!(n-y)!} \\theta^{y} (1-\\theta)^{n-y},\n\\end{align}\n\\tag{12.2}\\]\ndove \\(n\\) = numero di prove Bernoulliane, \\(\\theta\\) = probabilità di successo in ciascuna prova e \\(y\\) = numero di successi.\n\n\nDimostrazione. L’Equazione 12.2 può essere derivata nel modo seguente. Indichiamo con \\(S\\) il successo e con \\(I\\) l’insuccesso di ciascuna prova. Una sequenza di \\(n\\) prove Bernoulliane darà come esito una sequenza di \\(n\\) elementi \\(S\\) e \\(I\\). Ad esempio, una sequenza che contiene \\(y\\) successi è la seguente:\n\\[\n\\overbrace{SS\\dots S}^\\text{$y$ volte} \\overbrace{II\\dots I}^\\text{$n-y$ volte}\n\\]\nEssendo \\(\\theta\\) la probabilità di \\(S\\) e \\(1-\\theta\\) la probabilità di \\(I\\), la probabilità di ottenere la specifica sequenza riportata sopra è\n\\[\n\\begin{equation}\n\\overbrace{\\theta \\theta\\dots \\theta}^\\text{$y$ volte} \\overbrace{(1-\\theta)(1-\\theta)\\dots (1-\\theta)}^\\text{$n-y$ volte} = \\theta^y \\cdot (1-\\theta)^{n-y}.\n\\end{equation}\n\\tag{12.3}\\]\nNon siamo però interessati alla probabilità di una specifica sequenza di \\(S\\) e \\(I\\) ma, bensì, alla probabilità di osservare una qualsiasi sequenza di \\(y\\) successi in \\(n\\) prove. In altre parole, vogliamo la probabilità dell’unione di tutti gli eventi corrispondenti a \\(y\\) successi in \\(n\\) prove.\nÈ immediato notare che una qualsiasi altra sequenza contenente esattamente \\(y\\) successi avrà sempre come probabilità \\(\\theta^y \\cdot (1-\\theta)^{n-y}\\): il prodotto infatti resta costante anche se cambia l’ordine dei fattori.1 Per trovare il risultato cercato dobbiamo moltiplicare l’Equazione 12.3 per il numero di sequenze possibili di \\(y\\) successi in \\(n\\) prove.\nIl numero di sequenze che contengono esattamente \\(y\\) successi in \\(n\\) prove. La risposta è fornita dal coefficiente binomiale:\n\\[\n\\begin{equation}\n\\binom{n}{y} = \\frac{n!}{y!(n-y)!},\n\\end{equation}\n\\tag{12.4}\\]\ndove il simbolo \\(n!\\) si legge \\(n\\) fattoriale ed è uguale al prodotto di \\(n\\) numeri interi decrescenti a partire da \\(n\\). Per definizione \\(0! = 1\\).\nEssendo la probabilità dell’unione di \\(K\\) elementi incompatibili uguale alla somma delle loro rispettive probabilità, e dato che le sequenze di \\(y\\) successi in \\(n\\) prove hanno tutte la stessa probabilità, per trovare la formula della distributione binomiale Equazione 12.2 è sufficiente moltiplicare l’Equazione 12.3 per l’Equazione 12.4.\n\nLa distribuzione di probabilità di alcune distribuzioni binomiali, per due valori di \\(n\\) e \\(\\theta\\), è fornita nella Figura 12.1.\n\n\n\n\nFigura 12.1: Alcune distribuzioni binomiali. Nella figura, il parametro \\(\\theta\\) è indicato con \\(p\\).\n\n\n\n\n\nEsercizio 12.2 \nUsando l’Equazione 12.2, si trovi la probabilità di \\(y = 2\\) successi in \\(n = 4\\) prove Bernoulliane indipendenti con \\(\\theta = 0.2\\)\n\n\nSoluzione. Abbiamo\n\\[\n\\begin{aligned}\nP(Y=2) &= \\frac{4!}{2!(4-2)!} 0.2^{2} (1-0.2)^{4-2} \\notag  \\\\\n&= \\frac{4 \\cdot 3 \\cdot 2 \\cdot 1}{(2 \\cdot 1)(2 \\cdot 1)}\n0.2^{2} 0.8^{2} = 0.1536. \\notag\n\\end{aligned}\n\\]\nRipetendo i calcoli per i valori \\(y = 0, \\dots, 4\\) troviamo la distribuzione binomiale di parametri \\(n = 4\\) e \\(\\theta = 0.2\\):\n\n\ny\nP(Y = y)\n\n\n\n0\n0.4096\n\n\n1\n0.4096\n\n\n2\n0.1536\n\n\n3\n0.0256\n\n\n4\n0.0016\n\n\nsum\n1.0\n\n\n\nLo stesso risultato si ottiene usando la sequente istruzione R:\n\nCodicedbinom(0:4, 4, 0.2)\n#> [1] 0.4096 0.4096 0.1536 0.0256 0.0016\n\n\n\n\nEsercizio 12.3 \nLanciando \\(5\\) volte una moneta onesta, qual è la probabilità che esca testa almeno tre volte?\n\n\nSoluzione. In R, la soluzione si trova con\n\nCodicedbinom(3, 5, 0.5) + dbinom(4, 5, 0.5) + dbinom(5, 5, 0.5)\n#> [1] 0.5\n\n\nAlternativamente, possiamo trovare la probabilità dell’evento complementare a quello definito dalla funzione di ripartizione calcolata mediante pbinom(), ovvero\n\nCodice1 - pbinom(2, 5, 0.5)\n#> [1] 0.5\n\n\n\n\n12.2.1 Valore atteso e deviazione standard\nLa media (numero atteso di successi in \\(n\\) prove) e la deviazione standard di una distribuzione binomiale si trovano nel modo seguente:\n\\[\n\\begin{align}\n\\mu    &= n\\theta,  \\notag \\\\\n\\sigma &= \\sqrt{n\\theta(1-\\theta)}.\n\\end{align}\n\\tag{12.5}\\]\n\nDimostrazione. Essendo \\(Y\\) la somma di \\(n\\) prove Bernoulliane indipendenti \\(Y_i\\), è facile vedere che\n\\[\\begin{align}\n\\mathbb{E}(Y) &= \\mathbb{E}\\left( \\sum_{i=1}^n Y_i \\right) = \\sum_{i=1}^n \\mathbb{E}(Y_i) = n\\theta, \\\\\n\\mathbb{V}(Y) &= \\mathbb{V} \\left( \\sum_{i=1}^n Y_i \\right) = \\sum_{i=1}^n \\mathbb{V}(Y_i) = n \\theta (1-\\theta).\n\\end{align}\\]\n\n\nEsercizio 12.4 \nSi trovino il valore atteso e la varianza del lancio di quattro monete con probabilità di successo pari a \\(\\theta = 0.2\\).\n\n\nSoluzione. Il valore atteso è \\(\\mu = n \\theta = 4 \\cdot 0.2 = 0.8.\\) Ciò significa che, se l’esperimento casuale venisse ripetuto infinite volte, l’esito testa verrebbe osservato un numero medio di volte pari a 0.8. La varianza è \\(n \\theta (1-\\theta) = 4 \\cdot 0.2 \\cdot (1 - 0.2) = 0.64\\)."
  },
  {
    "objectID": "022_discr_rv_distr.html#distribuzione-di-poisson",
    "href": "022_discr_rv_distr.html#distribuzione-di-poisson",
    "title": "12  Distribuzioni di v.c. discrete",
    "section": "\n12.3 Distribuzione di Poisson",
    "text": "12.3 Distribuzione di Poisson\nLa distribuzione di Poisson è una distribuzione di probabilità discreta che esprime le probabilità per il numero di eventi che si verificano successivamente ed indipendentemente in un dato intervallo di tempo, sapendo che mediamente se ne verifica un numero \\(\\lambda\\). La distribuzione di Poisson serve dunque per contare il numero di volte in cui un evento ha luogo in un determinato intervallo di tempo. La stessa distribuzione può essere estesa anche per contare gli eventi che hanno luogo in una determinata porzione di spazio.\n\nLa distribuzione di Poisson può essere intesa come limite della distribuzione binomiale, dove la probabilità di successo \\(\\theta\\) è pari a \\(\\frac{\\lambda}{n}\\) con \\(n\\) che tende a \\(\\infty\\):\n\\[\\begin{equation}\n\\lim_{y \\rightarrow \\infty} \\binom{n}{y} \\theta^y (1-\\theta)^{n-y} = \\frac{\\lambda^y}{y!}e^{-\\lambda}.\n\\end{equation}\\]\n\nAlcune distribuzioni di Poisson sono riportate nella figura Figura 12.2.\n\n\n\n\nFigura 12.2: Alcune distribuzioni di Poisson.\n\n\n\n\n\nEsercizio 12.5 \nSupponiamo che un evento accada 300 volte all’ora. Si vuole determinare la probabilità che in un minuto accadano esattamente 3 eventi.\n\n\nSoluzione. Il numero medio di eventi in un minuto è pari a\n\nCodicelambda <- 300 / 60\nlambda\n#> [1] 5\n\n\nQuindi la probabilità che in un minuto si abbiano 3 eventi è pari a\n\nCodicey <- 3\n(lambda^y / factorial(y)) * exp(-lambda)\n#> [1] 0.1403739\n\n\n\n\nEsercizio 12.6 \nPer i dati dell’Esercizio 12.5, si trovi la probabilità che un evento accada almeno 8 volte in un minuto.\n\n\nSoluzione. La probabilità cercata è\n\\[\np(y \\geq 8) = 1 - p (y \\leq 7) = 1- \\sum_{i = 0}^7 \\frac{\\lambda^7}{7!}e^{-\\lambda},\n\\]\ncon \\(\\lambda = 5\\).\nSvolgendo i calcoli in R otteniamo:\n\nCodice1 - ppois(q = 7, lambda = 5)\n#> [1] 0.1333717\nppois(q = 7, lambda = 5, lower.tail = FALSE)\n#> [1] 0.1333717\n\n\n\n\nEsercizio 12.7 \nSapendo che un evento avviene in media 6 volte al minuto, si calcoli (a) la probabilità di osservare un numero di eventi uguale o inferiore a 3 in un minuto, e (b) la probabilità di osservare esattamente 2 eventi in 30 secondi.\n\n\nSoluzione. Per la domanda (a), \\(\\lambda = 6\\) e la probabilità richiesta è\n\nCodiceppois(q = 3, lambda = 6, lower.tail = TRUE)\n#> [1] 0.1512039\n\n\nNel caso di (b), \\(\\lambda = 6 / 2\\) e la probabilità richiesta è\n\nCodicedpois(x = 2, lambda = 3)\n#> [1] 0.2240418\n\n\n\n\n12.3.1 Alcune proprietà della variabile di Poisson\n\nIl valore atteso, la moda e la varianza della variabile di Poisson sono uguali a \\(\\lambda\\).\nLa somma \\(Y_1 + \\dots + Y_n\\) di \\(n\\) variabili casuali indipendenti con distribuzioni di Poisson di parametri \\(\\lambda_{1},\\dots,\\lambda_{n}\\) segue una distribuzione di Poisson di parametro \\(\\lambda = \\lambda_{1}+\\dots+\\lambda_{n}\\).\nLa differenze di due variabili di Poisson non è una variabile di Poisson. Basti infatti pensare che può assumere valori negativi."
  },
  {
    "objectID": "022_discr_rv_distr.html#distribuzione-discreta-uniforme",
    "href": "022_discr_rv_distr.html#distribuzione-discreta-uniforme",
    "title": "12  Distribuzioni di v.c. discrete",
    "section": "\n12.4 Distribuzione discreta uniforme",
    "text": "12.4 Distribuzione discreta uniforme\nUna distribuzione discreta uniforme è una distribuzione di probabilità discreta che è uniforme su un insieme, ovvero che attribuisce ad ogni elemento dell’insieme discreto e finito \\(S\\) su cui è definita la stessa probabilità \\(p\\) di verificarsi.\nSi consideri una variabile casuale \\(X\\) con supporto \\(1, 2, \\dots, m\\). Un esperimento casuale in cui si verifica questa distribuzione è la scelta casuale di un intero compreso tra 1 e \\(m\\) inclusi. Sia \\(X\\) il numero scelto. Allora\n\\[\nP(X = x) = \\frac{1}{m}, \\quad x = 1, \\dots, m.\n\\]\nIl valore atteso di \\(X\\) è\n\\[\n\\mathbb{E}(X) = \\sum_{x=1}^m x f_X(x) = \\sum_{x=1}^m x \\frac{1}{m} = \\frac{1}{m} (1 + 2 + \\dots + m) = \\frac{m+1}{2},\n\\]\ndove abbiamo utilizzato l’identità \\(1+2+···+m = m(m+1)/2\\).\nPer trovare la varianza, prima calcoliamo\n\\[\n\\mathbb{E}(X^2) = \\frac{1}{m} \\sum_{x=1}^m x^2,\n\\] e poi troviamo\n\\[\n\\mathbb{V}(X) = \\mathbb{E}(X^2) - \\left[\\mathbb{E}(X)\\right]^2.\n\\]\n\n12.4.1 Distribuzione discreta uniforme con \\(\\textsf{R}\\)\n\nLa sintassi per simulare una variabile casuale uniforme discreta è sample(x, size, replace = TRUE). L’argomento x identifica i numeri da cui campionare casualmente. Se x è un numero, il campionamento viene eseguito da 1 a x. L’argomento size indica quanto dovrebbe essere grande la dimensione del campione e replace indica se i numeri devono essere reintrodotti o meno nell’urna dopo essere stati estratti. L’opzione di default è replace = FALSE ma per le uniformi discrete i valori estratti devono essere sostituiti. Seguono alcuni esempi.\n\nPer lanciare un dado equilibrato 3000 volte: sample(6, size = 3000, replace = TRUE);\nper scegliere 27 numeri casuali da 30 a 70: sample(30:70, size = 27, replace = TRUE);\nper lanciare una moneta equa 1000 volte: sample(c(\"H\",\"T\"), size = 1000, replace = TRUE)."
  },
  {
    "objectID": "022_discr_rv_distr.html#distribuzione-beta-binomiale",
    "href": "022_discr_rv_distr.html#distribuzione-beta-binomiale",
    "title": "12  Distribuzioni di v.c. discrete",
    "section": "\n12.5 Distribuzione beta-binomiale",
    "text": "12.5 Distribuzione beta-binomiale\nLa distribuzione beta-binomiale di parametri \\(N\\), \\(\\alpha\\) e \\(\\beta\\) è una distribuzione discreta con una funzione di massa di probabilità uguale a\n\\[\n\\mbox{BetaBinomial}(y \\mid N, \\alpha, \\beta) = \\binom{N}{y} \\frac{B(y + \\alpha, N-y+\\beta)}{B(\\alpha, \\beta)},\n\\tag{12.6}\\]\ndove la funzione beta è \\(B(u, v) = \\frac{\\Gamma(u)\\Gamma(v)}{\\Gamma(u+v)}\\).\nSenza entrare nei dettagli, ci accontentiamo di sapere che tale distribuzione è implementata nella funzione dbbinom() del pacchetto extraDistr."
  },
  {
    "objectID": "022_discr_rv_distr.html#commenti-e-considerazioni-finali",
    "href": "022_discr_rv_distr.html#commenti-e-considerazioni-finali",
    "title": "12  Distribuzioni di v.c. discrete",
    "section": "Commenti e considerazioni finali",
    "text": "Commenti e considerazioni finali\nLa distribuzione binomiale è una distribuzione di probabilità discreta che descrive il numero di successi in un processo di Bernoulli, ovvero la variabile aleatoria \\(Y = Y_1 + \\dots + Y_n\\) che somma \\(n\\) variabili casuali indipendenti di uguale distribuzione di Bernoulli \\(\\mathcal{B}(\\theta)\\), ognuna delle quali può fornire due soli risultati: il successo con probabilità \\(\\theta\\) e l’insuccesso con probabilità \\(1 - \\theta\\).\nLa distribuzione binomiale è molto importante per le sue molte applicazioni. Nelle presenti dispense dedicate all’analisi bayesiana, è importante perché costituisce il fondamento del caso più semplice dell’aggiornamento bayesiano, ovvero il caso Beta-Binomiale. Il modello Beta-Binomiale fornisce un esempio paradigmatico dell’approccio bayesiano all’inferenza e sarà trattato in maniera analitica nei capitoli successivi. È dunque importante che le proprietà della distribuzione binomiale risultino ben chiare."
  },
  {
    "objectID": "023_cont_rv_distr.html",
    "href": "023_cont_rv_distr.html",
    "title": "13  Distribuzioni di v.c. continue",
    "section": "",
    "text": "Dopo avere introdotto con una simulazione il concetto di funzione di densità nel Capitolo Capitolo 10, prendiamo ora in esame alcune delle densità di probabilità più note. La più importante di esse è sicuramente la distribuzione Normale."
  },
  {
    "objectID": "023_cont_rv_distr.html#distribuzione-gaussiana",
    "href": "023_cont_rv_distr.html#distribuzione-gaussiana",
    "title": "13  Distribuzioni di v.c. continue",
    "section": "\n13.1 Distribuzione Gaussiana",
    "text": "13.1 Distribuzione Gaussiana\nNon c’è un’unica distribuzione gaussiana (o normale): la distribuzione gaussiana è una famiglia di distribuzioni. Tali distribuzioni sono dette “gaussiane” in onore di Carl Friedrich Gauss (uno dei più grandi matematici della storia il quale, tra le altre cose, scoprì l’utilità di tale funzione di densità per descrivere gli errori di misurazione). Adolphe Quetelet, il padre delle scienze sociali quantitative, fu il primo ad applicare tale funzione di densità alle misurazioni dell’uomo. Karl Pearson usò per primo il termine “distribuzione normale” anche se ammise che questa espressione “ha lo svantaggio di indurre le persone a credere che le altre distribuzioni, in un senso o nell’altro, non siano normali.”\n\n13.1.1 Limite delle distribuzioni binomiali\nIniziamo con un un breve excursus storico. Nel 1733, Abraham de Moivre notò che, aumentando il numero di prove di una distribuzione binomiale, la distribuzione risultante diventava quasi simmetrica e a forma campanulare. Con 10 prove e una probabilità di successo di 0.9 in ciascuna prova, la distribuzione è chiaramente asimmetrica.\n\nCodiceN <- 10\nx <- 0:10\ny <- dbinom(x, N, 0.9)\nbinomial_limit_plot <-\n  tibble(x = x, y = y) %>%\n  ggplot(aes(x = x, y = y)) +\n  geom_bar(\n    stat = \"identity\", color = \"black\", size = 0.2\n  ) +\n  xlab(\"y\") +\n  scale_x_continuous(breaks = c(0, 2, 4, 6, 8, 10)) +\n  ylab(\"Binomial(y | 10, 0.9)\")\nbinomial_limit_plot\n\n\n\nFigura 13.1: Probabilità del numero di successi in \\(N = 10\\) prove bernoulliane indipendenti, ciascuna con una probabilità di successo di 0.90. Il risultato è una distribuzione \\(\\mbox{Bin}(y \\mid 10, 0.9)\\). Con solo dieci prove, la distribuzione è fortemente asimmetrica negativa.\n\n\n\n\nMa se aumentiamo il numero di prove di un fattore di 100 a N = 1000, senza modificare la probabilità di successo di 0.9, la distribuzione assume una forma campanulare quasi simmetrica. Dunque, de Moivre scoprì che, quando N è grande, la funzione gaussiana (che introdurremo qui sotto), nonostante sia la densità di v.a. continue, fornisce una buona approssimazione alla funzione di massa di probabilità binomiale.\n\nCodiceN <- 1000\nx <- 0:1000\ny <- dbinom(x, N, 0.9)\nbinomial_limit_plot <-\n  tibble(x = x, y = y) %>%\n  ggplot(aes(x = x, y = y)) +\n  geom_bar(stat = \"identity\", color = \"black\", size = 0.2) +\n  xlab(\"y\") +\n  ylab(\"Binomial(y | 1000, 0.9)\") +\n  xlim(850, 950)\nbinomial_limit_plot\n\n\n\nFigura 13.2: Probabilità del numero di successi in \\(N = 1000\\) prove bernoulliane indipendenti, ciascuna con una probabilità di successo di 0.90. Il risultato è una distribuzione \\(\\mbox{Bin}(y \\mid 1000, 0.9)\\). Con mille prove, la distribuzione è quasi simmetrica a forma campanulare.\n\n\n\n\nLa distribuzione Normale fu scoperta da Gauss nel 1809. Il Paragrafo successivo illustra come si possa giungere alla Normale mediante una simulazione."
  },
  {
    "objectID": "023_cont_rv_distr.html#normal-random-walk",
    "href": "023_cont_rv_distr.html#normal-random-walk",
    "title": "13  Distribuzioni di v.c. continue",
    "section": "\n13.2 La Normale prodotta con una simulazione",
    "text": "13.2 La Normale prodotta con una simulazione\nMcElreath (2020) illustra come sia possibile giungere alla distribuzione Normale mediante una simulazione. Supponiamo che vi siano mille persone tutte allineate su una linea di partenza. Quando viene dato un segnale, ciascuna persona lancia una moneta e fa un passo in avanti oppure all’indietro a seconda che sia uscita testa o croce. Supponiamo che la lunghezza di ciascun passo vari da 0 a 1 metro. Ciascuna persona lancia una moneta 16 volte e dunque compie 16 passi.\nAlla conclusione di queste passeggiate casuali (random walk) non possiamo sapere con esattezza dove si troverà ciascuna persona, ma possiamo conoscere con certezza le caratteristiche della distribuzione delle mille distanze dall’origine. Per esempio, possiamo predire in maniera accurata la proporzione di persone che si sono spostate in avanti oppure all’indietro. Oppure, possiamo predire accuratamente la proporzione di persone che si troveranno ad una certa distanza dalla linea di partenza (es., a 1.5 m dall’origine).\nQueste predizioni sono possibili perché tali distanze si distribuiscono secondo la legge Normale. È facile simulare questo processo usando . I risultati della simulazione sono riportati nella Figura 13.3.\n\nCodicepos <-\n  replicate(100, runif(16, -1, 1)) %>%\n  as_tibble() %>%\n  rbind(0, .) %>%\n  mutate(step = 0:16) %>%\n  gather(key, value, -step) %>%\n  mutate(person = rep(1:100, each = 17)) %>%\n  group_by(person) %>%\n  mutate(position = cumsum(value)) %>%\n  ungroup()\n\nggplot(\n  data = pos,\n  aes(x = step, y = position, group = person)\n) +\n  geom_vline(xintercept = c(4, 8, 16), linetype = 2) +\n  geom_line(aes(color = person < 2, alpha = person < 2)) +\n  scale_color_manual(values = c(\"gray\", \"black\")) +\n  scale_alpha_manual(values = c(1 / 5, 1)) +\n  scale_x_continuous(\n    \"Numero di passi\",\n    breaks = c(0, 4, 8, 12, 16)\n  ) +\n  labs(y = \"Posizione\") +\n  theme(legend.position = \"none\")\n\n\n\nFigura 13.3: Passeggiata casuale di 4, 8 e 16 passi. La spezzata nera indica la media delle distanze dall’origine come funzione del numero di passi.\n\n\n\n\nUn kernel density plot delle distanze ottenute dopo 4, 8 e 16 passi è riportato nella Figura 13.4. Nel pannello di destra, al kernel density plot è stata sovrapposta una densità Normale di opportuni parametri (linea tratteggiata).\n\nCodicep1 <-\n  pos %>%\n  filter(step == 4) %>%\n  ggplot(aes(x = position)) +\n  geom_line(stat = \"density\", color = \"black\") +\n  labs(title = \"4 passi\")\n\np2 <-\n  pos %>%\n  filter(step == 8) %>%\n  ggplot(aes(x = position)) +\n  geom_density(color = \"black\", outline.type = \"full\") +\n  labs(title = \"8 passi\")\n\nsd <-\n  pos %>%\n  filter(step == 16) %>%\n  summarise(sd = sd(position)) %>%\n  pull(sd)\n\np3 <-\n  pos %>%\n  filter(step == 16) %>%\n  ggplot(aes(x = position)) +\n  stat_function(\n    fun = dnorm,\n    args = list(mean = 0, sd = sd),\n    linetype = 2\n  ) +\n  geom_density(color = \"black\", alpha = 1 / 2) +\n  labs(\n    title = \"16 passi\",\n    y = \"Densità\"\n  )\n\n(p1 | p2 | p3) & coord_cartesian(xlim = c(-6, 6))\n\n\n\nFigura 13.4: Kernel density plot dei risultati della passeggiata casuale riportata nella figura precente, dopo 4, 8 e 16 passi. Nel pannello di destra, una densità Normale di opportuni parametri è sovrapposta all’istogramma lisciato.\n\n\n\n\nQuesta simulazione mostra che qualunque processo nel quale viene sommato un certo numero di valori casuali, tutti provenienti dalla medesima distribuzione, converge ad una distribuzione Normale. Non importa quale sia la forma della distribuzione di partenza: essa può essere uniforme, come nell’esempio presente, o di qualunque altro tipo. La forma della distribuzione da cui viene realizzato il campionamento determina la velocità della convergenza alla Normale. In alcuni casi la convergenza è lenta; in altri casi la convergenza è molto rapida (come nell’esempio presente).\nDa un punto di vista formale, diciamo che una variabile casuale continua \\(Y\\) ha una distribuzione Normale se la sua densità è\n\\[\nf(y; \\mu, \\sigma) = {1 \\over {\\sigma\\sqrt{2\\pi} }} \\exp \\left\\{-\\frac{(y -  \\mu)^2}{2 \\sigma^2} \\right\\},\n\\tag{13.1}\\]\ndove \\(\\mu \\in \\mathbb{R}\\) e \\(\\sigma > 0\\) sono i parametri della distribuzione.\nLa densità normale è unimodale e simmetrica con una caratteristica forma a campana e con il punto di massima densità in corrispondenza di \\(\\mu\\).\nIl significato dei parametri \\(\\mu\\) e \\(\\sigma\\) che appaiono nell’Equazione 13.1 viene chiarito dalla dimostrazione che\n\\[\n\\mathbb{E}(Y) = \\mu, \\qquad \\mathbb{V}(Y) = \\sigma^2.\n\\]\nLa rappresentazione grafica di quattro densità Normali tutte con media 0 e con deviazioni standard 0.25, 0.5, 1 e 2 è fornita nella Figura 13.5.\n\n\n\n\nFigura 13.5: Alcune distribuzioni Normali.\n\n\n\n\n\n13.2.1 Concentrazione\nÈ istruttivo osservare il grado di concentrazione della distribuzione Normale attorno alla media:\n\\[\n\\begin{align}\nP(\\mu - \\sigma < Y < \\mu + \\sigma) &= P (-1 < Z < 1) \\simeq 0.683, \\notag\\\\\nP(\\mu - 2\\sigma < Y < \\mu + 2\\sigma) &= P (-2 < Z < 2) \\simeq 0.956, \\notag\\\\\nP(\\mu - 3\\sigma < Y < \\mu + 3\\sigma) &= P (-3 < Z < 3) \\simeq 0.997. \\notag\n\\end{align}\n\\]\nSi noti come un dato la cui distanza dalla media è superiore a 3 volte la deviazione standard presenti un carattere di eccezionalità perché meno del 0.3% dei dati della distribuzione Normale presentano questa caratteristica.\nPer indicare la distribuzione Normale si usa la notazione \\(\\mathcal{N}(\\mu, \\sigma)\\).\n\n13.2.2 Funzione di ripartizione\nIl valore della funzione di ripartizione di \\(Y\\) nel punto \\(y\\) è l’area sottesa alla curva di densità \\(f(y)\\) nella semiretta \\((-\\infty, y]\\). Non esiste alcuna funzione elementare per la funzione di ripartizione\n\\[\nF(y) = \\int_{-\\infty}^y {1 \\over {\\sigma\\sqrt{2\\pi} }} \\exp \\left\\{-\\frac{(y - \\mu)^2}{2\\sigma^2} \\right\\} dy,\n\\tag{13.2}\\]\npertanto le probabilità \\(P(Y < y)\\) vengono calcolate mediante integrazione numerica approssimata. I valori della funzione di ripartizione di una variabile casuale Normale sono dunque forniti da un software.\n\nEsercizio 13.1 Usiamo \\(\\mathsf{R}\\) per calcolare la funzione di ripartizione della Normale. La funzione pnorm(q, mean, sd) restituisce la funzione di ripartizione della Normale con media mean e deviazione standard sd, ovvero l’area sottesa alla funzione di densità di una Normale con media mean e deviazione standard sd nell’intervallo \\([-\\infty, q]\\).\nPer esempio, in precedenza abbiamo detto che il 68% circa dell’area sottesa ad una Normale è compresa nell’intervallo \\(\\mu \\pm \\sigma\\). Verifichiamo per la distribuzione del QI \\(\\sim \\mathcal{N}(\\mu = 100, \\sigma = 15)\\):\n\nCodicepnorm(100+15, 100, 15) - pnorm(100-15, 100, 15)\n#> [1] 0.6826895\n\n\nIl 95% dell’area è compresa nell’intervallo \\(\\mu \\pm 1.96 \\cdot\\sigma\\):\n\nCodicepnorm(100 + 1.96 * 15, 100, 15) - pnorm(100 - 1.96 * 15, 100, 15)\n#> [1] 0.9500042\n\n\nQuasi tutta la distribuzione è compresa nell’intervallo \\(\\mu \\pm 3 \\cdot\\sigma\\):\n\nCodicepnorm(100 + 3 * 15, 100, 15) - pnorm(100 - 3 * 15, 100, 15)\n#> [1] 0.9973002\n\n\n\n\n13.2.3 Distribuzione Normale standard\nLa distribuzione Normale di parametri \\(\\mu = 0\\) e \\(\\sigma = 1\\) viene detta distribuzione Normale standard. La famiglia Normale è l’insieme avente come elementi tutte le distribuzioni Normali con parametri \\(\\mu\\) e \\(\\sigma\\) diversi. Tutte le distribuzioni Normali si ottengono dalla Normale standard mediante una trasformazione lineare: se \\(Y \\sim \\mathcal{N}(\\mu_Y, \\sigma_Y)\\) allora\n\\[\nX = a + b Y \\sim \\mathcal{N}(\\mu_X = a+b \\mu_Y, \\sigma_X = \\left|b\\right|\\sigma_Y).\n\\]\nL’area sottesa alla curva di densità di \\(\\mathcal{N}(\\mu, \\sigma)\\) nella semiretta \\((-\\infty, y]\\) è uguale all’area sottesa alla densità Normale standard nella semiretta \\((-\\infty, z]\\), in cui \\(z = (y -\\mu_Y )/\\sigma_Y\\) è il punteggio standard di \\(Y\\). Per la simmetria della distribuzione, l’area sottesa nella semiretta \\([1, \\infty)\\) è uguale all’area sottesa nella semiretta \\((-\\infty, 1]\\) e quest’ultima coincide con \\(F(-1)\\). Analogamente, l’area sottesa nell’intervallo \\([y_a, y_b]\\), con \\(y_a < y_b\\), è pari a \\(F(z_b) - F(z_a)\\), dove \\(z_a\\) e \\(z_b\\) sono i punteggi standard di \\(y_a\\) e \\(y_b\\).\nSi ha anche il problema inverso rispetto a quello del calcolo delle aree: dato un numero \\(0 \\leq p \\leq 1\\), il problema è quello di determinare un numero \\(z \\in \\mathbb{R}\\) tale che \\(P(Z < z) = p\\). Il valore \\(z\\) cercato è detto quantile di ordine \\(p\\) della Normale standard e può essere trovato mediante un software.\n\nEsercizio 13.2 \nSupponiamo che l’altezza degli individui adulti segua la distribuzione Normale di media \\(\\mu = 1.7\\) m e deviazione standard \\(\\sigma = 0.1\\) m. Vogliamo sapere la proporzione di individui adulti con un’altezza compresa tra \\(1.7\\) e \\(1.8\\) m.\n\n\nSoluzione. Il problema ci chiede di trovare l’area sottesa alla distribuzione \\(\\mathcal{N}(\\mu = 1.7, \\sigma = 0.1)\\) nell’intervallo \\([1.7, 1.8]\\):\n\nCodicedf <- tibble(x = seq(1.4, 2.0, length.out = 100)) %>%\n  mutate(y = dnorm(x, mean = 1.7, sd = 0.1))\n\nggplot(df, aes(x, y)) +\n  geom_area(fill = \"sky blue\") +\n  gghighlight(x < 1.8 & x > 1.7) +\n  labs(\n    x = \"Altezza\",\n    y = \"Densità\"\n  )\n\n\n\n\n\n\n\nLa risposta si trova utilizzando la funzione di ripartizione \\(F(X)\\) della legge \\(\\mathcal{N}(1.7, 0.1)\\) in corrispondenza dei due valori forniti dal problema: \\(F(X = 1.8) - F(X = 1.7)\\). Utilizzando la seguente istruzione\n\nCodicepnorm(1.8, 1.7, 0.1) - pnorm(1.7, 1.7, 0.1)\n#> [1] 0.3413447\n\n\notteniamo il \\(31.43\\%\\).\nIn maniera equivalente, possiamo standardizzare i valori che delimitano l’intervallo considerato e utilizzare la funzione di ripartizione della normale standardizzata. I limiti inferiore e superiore dell’intervallo sono\n\\[\nz_{\\text{inf}} = \\frac{1.7 - 1.7}{0.1} = 0, \\quad z_{\\text{sup}} = \\frac{1.8 - 1.7}{0.1} = 1.0,\n\\]\nquindi otteniamo\n\nCodicepnorm(1.0, 0, 1) - pnorm(0, 0, 1)\n#> [1] 0.3413447\n\n\nIl modo più semplice per risolvere questo problema resta comunque quello di rendersi conto che la probabilità richiesta non è altro che la metà dell’area sottesa dalle distribuzioni Normali nell’intervallo \\([\\mu - \\sigma, \\mu + \\sigma]\\), ovvero \\(0.683/2\\).\n\n\n13.2.3.1 Funzione di ripartizione della normale standard e funzione logistica\nSi noti che la funzione logistica (in blu), pur essendo del tutto diversa dalla Normale dal punto di vista formale, assomiglia molto alla Normale standard quando le due cdf hanno la stessa varianza.\n\nCodicetibble(x = c(-3, 3)) %>%\n  ggplot(aes(x = x)) +\n  stat_function(fun = pnorm) +\n  stat_function(\n    fun = plogis,\n    args = list(scale = 0.56)\n  )"
  },
  {
    "objectID": "023_cont_rv_distr.html#teorema-del-limite-centrale",
    "href": "023_cont_rv_distr.html#teorema-del-limite-centrale",
    "title": "13  Distribuzioni di v.c. continue",
    "section": "\n13.3 Teorema del limite centrale",
    "text": "13.3 Teorema del limite centrale\nLaplace dimostrò il teorema del limite centrale (TLC) nel 1812. Il TLC ci dice che se prendiamo una sequenza di variabili casuali indipendenti e le sommiamo, tale somma tende a distribuirsi come una Normale. Il TLC specifica inoltre, sulla base dei valori attesi e delle varianze delle v.c. che vengono sommate, quali sono i parametri della distribuzione Normale così ottenuta.\n\nTeorema 13.1 Si supponga che \\(Y = Y_1, \\dots, Y_i, \\ldots, Y_n\\) sia una sequenza di v.a. i.i.d. con \\(\\mathbb{E}(Y_i) = \\mu\\) e \\(\\mbox{SD}(Y_i) = \\sigma\\). Si definisca una nuova v.c. come:\n\\[\nZ = \\frac{1}{n} \\sum_{i=1}^n Y_i.\n\\]\nCon \\(n \\rightarrow \\infty\\), \\(Z\\) tenderà ad una Normale con lo stesso valore atteso di \\(Y_i\\) e una deviazione standard che sarà più piccola della deviazione standard originaria di un fattore pari a \\(\\frac{1}{\\sqrt{n}}\\):\n\\[\np_Z(z) \\rightarrow \\mathcal{N}\\left(z \\ \\Bigg| \\ \\mu, \\, \\frac{1}{\\sqrt{n}} \\cdot \\sigma \\right).\n\\]\n\nIl TLC può essere generalizzato a variabili che non hanno la stessa distribuzione purché siano indipendenti e abbiano aspettative e varianze finite. Molti fenomeni naturali, come l’altezza dell’uomo adulto di entrambi i generi, sono il risultato di una serie di effetti additivi relativamente piccoli, la cui combinazione porta alla normalità, indipendentemente da come gli effetti additivi sono distribuiti. Questo è il motivo per cui la distribuzione normale forniscre una buona rappresentazione della distribuzione di molti fenomeni naturali."
  },
  {
    "objectID": "023_cont_rv_distr.html#distribuzione-chi-quadrato",
    "href": "023_cont_rv_distr.html#distribuzione-chi-quadrato",
    "title": "13  Distribuzioni di v.c. continue",
    "section": "\n13.4 Distribuzione Chi-quadrato",
    "text": "13.4 Distribuzione Chi-quadrato\nDalla Normale deriva la distribuzione \\(\\chi^2\\). La distribuzione \\(\\chi^2_{~k}\\) con \\(k\\) gradi di libertà descrive la variabile casuale\n\\[\nZ_1^2 + Z_2^2 + \\dots + Z_k^2,\n\\]\ndove \\(Z_1, Z_2, \\dots, Z_k\\) sono variabili casuali i.i.d. che seguono la distribuzione Normale standard \\(\\mathcal{N}(0, 1)\\). La variabile casuale chi-quadrato dipende dal parametro intero positivo \\(\\nu = k\\) che ne identifica il numero di gradi di libertà. La densità di probabilità di \\(\\chi^2_{~\\nu}\\) è\n\\[\nf(x) = C_{\\nu} x^{\\nu/2-1} \\exp (-x/2), \\qquad \\text{se } x > 0,\n\\]\ndove \\(C_{\\nu}\\) è una costante positiva.\nLa Figura 13.6 mostra alcune distribuzioni Chi-quadrato variando il parametro \\(\\nu\\).\n\n\n\n\nFigura 13.6: Alcune distribuzioni Chi-quadrato.\n\n\n\n\n\n13.4.1 Proprietà\n\nLa distribuzione di densità \\(\\chi^2_{~\\nu}\\) è asimmetrica.\nIl valore atteso di una variabile \\(\\chi^2_{~\\nu}\\) è uguale a \\(\\nu\\).\nLa varianza di una variabile \\(\\chi^2_{~\\nu}\\) è uguale a \\(2\\nu\\).\nPer \\(k \\rightarrow \\infty\\), la \\(\\chi^2_{~\\nu} \\rightarrow \\mathcal{N}\\).\nSe \\(X\\) e \\(Y\\) sono due variabili casuali chi-quadrato indipendenti con \\(\\nu_1\\) e \\(\\nu_2\\) gradi di libertà, ne segue che \\(X + Y \\sim \\chi^2_m\\), con \\(m = \\nu_1 + \\nu_2\\). Tale principio si estende a qualunque numero finito di variabili casuali chi-quadrato indipendenti.\n\n\nEsercizio 13.3 Usiamo \\(\\mathsf{R}\\) per disegnare la densità chi-quadrato con 3 gradi di libertà dividendo l’area sottesa alla curva di densità in due parti uguali.\n\nCodicedf <- tibble(x = seq(0, 15.0, length.out = 100)) %>%\n  mutate(y = dchisq(x, 3))\n\nggplot(df, aes(x, y)) +\n  geom_area(fill = \"sky blue\") +\n  gghighlight(x < 3) +\n  labs(\n    x = \"V.a. chi-quadrato con 3 gradi di libertà\",\n    y = \"Densità\"\n  )"
  },
  {
    "objectID": "023_cont_rv_distr.html#distribuzione-t-di-student",
    "href": "023_cont_rv_distr.html#distribuzione-t-di-student",
    "title": "13  Distribuzioni di v.c. continue",
    "section": "\n13.5 Distribuzione \\(t\\) di Student",
    "text": "13.5 Distribuzione \\(t\\) di Student\nDalle distribuzioni Normale e Chi-quadrato deriva un’altra distribuzione molto nota, la \\(t\\) di Student. Se \\(Z \\sim \\mathcal{N}\\) e \\(W \\sim \\chi^2_{~\\nu}\\) sono due variabili casuali indipendenti, allora il rapporto\n\\[\nT = \\frac{Z}{\\Big( \\frac{W}{\\nu}\\Big)^{\\frac{1}{2}}}\n\\tag{13.3}\\]\ndefinisce la distribuzione \\(t\\) di Student con \\(\\nu\\) gradi di libertà. Si usa scrivere \\(T \\sim t_{\\nu}\\). L’andamento della distribuzione \\(t\\) di Student è simile a quello della distribuzione Normale, ma ha una maggiore dispersione (ha le code più pesanti di una Normale, ovvero ha una varianza maggiore di 1).\nLa Figura 13.7 mostra alcune distribuzioni \\(t\\) di Student variando il parametro \\(\\nu\\).\n\n\n\n\nFigura 13.7: Alcune distribuzioni \\(t\\) di Student.\n\n\n\n\n\n13.5.1 Proprietà\nLa variabile casuale \\(t\\) di Student soddisfa le seguenti proprietà:\n\nPer \\(\\nu \\rightarrow \\infty\\), \\(t_{\\nu}\\) tende alla normale standard \\(\\mathcal{N}(0, 1)\\).\nLa densità della \\(t_{\\nu}\\) è una funzione simmetrica con valore atteso nullo.\nPer \\(\\nu > 2\\), la varianza della \\(t_{\\nu}\\) vale \\(\\nu/(\\nu - 2)\\); pertanto è sempre maggiore di 1 e tende a 1 per \\(\\nu \\rightarrow \\infty\\)."
  },
  {
    "objectID": "023_cont_rv_distr.html#funzione-beta",
    "href": "023_cont_rv_distr.html#funzione-beta",
    "title": "13  Distribuzioni di v.c. continue",
    "section": "\n13.6 Funzione beta",
    "text": "13.6 Funzione beta\nLa funzione beta di Eulero è una funzione matematica, non una densità di probabilità. La menzioniamo qui perché viene utilizzata nella distribuzione Beta. La funzione beta si può scrivere in molti modi diversi; per i nostri scopi la scriveremo così:\n\\[\nB(\\alpha, \\beta) = \\frac{\\Gamma(\\alpha)\\Gamma(\\beta)}{\\Gamma(\\alpha + \\beta)}\\,,\n\\tag{13.4}\\]\ndove \\(\\Gamma(x)\\) è la funzione Gamma, ovvero il fattoriale discendente, cioè\n\\[\n(x-1)(x-2)\\ldots (x-n+1)\\notag\\,.\n\\]\n\nEsercizio 13.4 \nPer esempio, posti \\(\\alpha = 3\\) e \\(\\beta = 9\\), la funzione beta assume il valore\n\nCodicealpha <- 3\nbeta <- 9\nbeta(alpha, beta)\n#> [1] 0.002020202\n\n\nPer chiarire, lo stesso risultato si ottiene con\n\nCodice((2) * (8 * 7 * 6 * 5 * 4 * 3 * 2)) / \n  (11 * 10 * 9 * 8 * 7 * 6 * 5 * 4 * 3 * 2)\n#> [1] 0.002020202\n\n\novvero\n\nCodicegamma(alpha) * gamma(beta) / gamma(alpha + beta)\n#> [1] 0.002020202"
  },
  {
    "objectID": "023_cont_rv_distr.html#distribuzione-beta",
    "href": "023_cont_rv_distr.html#distribuzione-beta",
    "title": "13  Distribuzioni di v.c. continue",
    "section": "\n13.7 Distribuzione Beta",
    "text": "13.7 Distribuzione Beta\nLa distribuzione Beta è una distribuzione usata per modellare percentuali e proporzioni in quanto è definita sull’intervallo \\((0; 1)\\) – ma non include i valori 0 o 1.\n\nDefinizione 13.1 Sia \\(\\pi\\) una variabile casuale che può assumere qualsiasi valore compreso tra 0 e 1, cioè \\(\\pi \\in [0, 1]\\). Diremo che \\(\\pi\\) segue la distribuzione Beta di parametri \\(\\alpha\\) e \\(\\beta\\), \\(\\pi \\sim \\text{Beta}(\\alpha, \\beta)\\), se la sua densità è\n\\[\n\\begin{align}\n\\text{Beta}(\\pi \\mid \\alpha, \\beta) &= \\frac{1}{B(\\alpha, \\beta)}\\pi^{\\alpha-1} (1-\\pi)^{\\beta-1}\\notag\\\\\n&=  \\frac{\\Gamma(\\alpha+ \\beta)}{\\Gamma(\\alpha)\\Gamma(\\beta)}\\pi^{\\alpha-1} (1-\\pi)^{\\beta-1} \\quad \\text{per } \\pi \\in [0, 1]\\,,\n\\end{align}\n\\tag{13.5}\\]\nladdove \\(B(\\alpha, \\beta)\\) è la funzione beta.\n\nI termini \\(\\alpha\\) e \\(\\beta\\) sono i parametri della distribuzione Beta e devono essere entrambi positivi. Tali parametri possono essere interpretati come l’espressione delle nostre credenze a priori relative ad una sequenza di prove Bernoulliane. Il parametro \\(\\alpha\\) rappresenta il numero di “successi” e il parametro \\(\\beta\\) il numero di “insuccessi”:\n\\[\n\\frac{\\text{Numero di successi}}{\\text{Numero di successi} + \\text{Numero di insuccessi}} = \\frac{\\alpha}{\\alpha + \\beta}\\notag\\,.\n\\]\nIl rapporto \\(\\frac{1}{B(\\alpha, \\beta)} = \\frac{\\Gamma(\\alpha+b)}{\\Gamma(\\alpha)\\Gamma(\\beta)}\\) è una costante di normalizzazione:\n\\[\n\\int_0^1 \\pi^{\\alpha-1} (1-\\pi)^{\\beta-1} = \\frac{\\Gamma(\\alpha+b)}{\\Gamma(\\alpha)\\Gamma(\\beta)}\\,.\n\\]\nAd esempio, con \\(\\alpha = 3\\) e \\(\\beta = 9\\) abbiamo\n\nCodicea <- 3\nb <- 9\nintegrand <- function(p) {p^{a - 1}*(1 - p)^{b - 1}}\nintegrate(integrand, lower = 0, upper = 1)\n#> 0.002020202 with absolute error < 2.2e-17\n\n\novvero\n\nCodice1 / (gamma(a + b) / (gamma(a) * gamma(b)))\n#> [1] 0.002020202\n\n\novvero\n\nCodicebeta(alpha, beta)\n#> [1] 0.002020202\n\n\nIl valore atteso, la moda e la varianza di una distribuzione Beta sono dati dalle seguenti equazioni:\n\\[\n\\mathbb{E}(\\pi) = \\frac{\\alpha}{\\alpha+\\beta}\\,,\n\\tag{13.6}\\]\n\\[\n\\mbox{Mo}(\\pi) = \\frac{\\alpha-1}{\\alpha+\\beta-2}\\,,\n\\tag{13.7}\\]\n\\[\n\\mathbb{V}(\\pi) = \\frac{\\alpha \\beta}{(\\alpha+\\beta)^2 (\\alpha+\\beta+1)}\\,.\n\\tag{13.8}\\]\nAl variare di \\(\\alpha\\) e \\(\\beta\\) si ottengono molte distribuzioni di forma diversa; un’illustrazione è fornita dalla seguente GIF animata.\nSi può ottenere una rappresentazione grafica della distribuzione \\(\\mbox{Beta}(\\pi \\mid \\alpha, \\beta)\\) con la funzione plot_beta() del pacchetto bayesrules. Per esempio:\n\nCodicebayesrules::plot_beta(alpha = 3, beta = 9)\n\n\n\n\n\n\n\nLa funzione bayesrules::summarize_beta() ci restituisce la media, moda e varianza della distribuzione Beta. Per esempio:\n\nCodicebayesrules::summarize_beta(alpha = 3, beta = 9)\n#>   mean mode        var        sd\n#> 1 0.25  0.2 0.01442308 0.1200961\n\n\n\nNota. Attenzione alle parole: in questo contesto, il termine “beta” viene utilizzato con tre significati diversi:\n\nla distribuzione di densità Beta,\nla funzione matematica beta,\nil parametro \\(\\beta\\).\n\n\n\nEsercizio 13.5 \nNel disturbo depressivo la recidiva è definita come la comparsa di un nuovo episodio depressivo che si manifesta dopo un prolungato periodo di recupero (6-12 mesi) con stato di eutimia (umore relativamente normale). Supponiamo che una serie di studi mostri una comparsa di recidiva in una proporzione che va dal 20% al 60% dei casi, con una media del 40% (per una recente discussione, si veda Nuggerud-Galeas et al., 2020). Sulla base di queste informazioni, si usi la distribuzione Beta per rappresentare le credenze a priori relativamente alla probabilità di recidiva.\n\n\nSoluzione. Il problema richiede di trovare i parametri della distribuzione Beta tali per cui la massa della densità sia compresa tra 0.2 e 0.6, con la media in corrispondenza di 0.4. Procedendo per tentativi ed errori, ed usando la funzione bayesrules::plot_beta(), un risultato possibile è \\(\\mbox{Beta}(16, 24)\\).\nLa funzione find_pars() prende in input la media e \\(\\alpha + \\beta\\), ritorna i valori dei parametri:\n\nCodicefind_pars <- function(ev, n) {\n  a <- ev * n\n  b <- n - a\n  return(c(round(a), round(b)))\n}\n\npars <- find_pars(.4, 40)\npars\n#> [1] 16 24\nbayesrules::plot_beta(pars[1], pars[2])\n\n\n\n\n\n\n\nVerifichiamo il valore della media della distribuzione:\n\nCodice16 / (16 + 24)\n#> [1] 0.4\n\n\nLa moda è\n\nCodice(16 - 1) / (16 + 24 - 2)\n#> [1] 0.3947368\n\n\nLa deviazione standard della distribuzione è uguale a circa 8 punti percentuali:\n\nCodicesqrt((16 * 24) / ((16 + 24)^2 * (16 + 24 + 1)))\n#> [1] 0.07650921\n\n\nGli stessi risultati si ottengono usando la funzione bayesrules::summarize_beta():\n\nCodicebayesrules::summarize_beta(alpha = 16, beta = 24)\n#>   mean      mode         var         sd\n#> 1  0.4 0.3947368 0.005853659 0.07650921\n\n\nPossiamo concludere dicendo che, se utilizziamo la distribuzione \\(\\mbox{Beta}(16, 24)\\) per rappresentare le nostre credenze (a priori) rispetto la possibilità di recidiva, ciò significa che pensiamo che la nostra incertezza sia quantificabile nei termini di una deviazione standard di circa 8 punti percentuali rispetto a tutti i valori possibili di recidiva, per i quali il valore più verosimile (ovvero, la media della distribuzione) è 0.40.\n\n\nEsercizio 13.6 \nPoniamoci ora il problema di verificare la nostra comprensione delle funzioni \\(\\mathsf{R}\\) che possono essere usate per la funzione Beta. Si risolva l’Esercizio 13.5 usando \\(\\mathsf{R}\\).\n\n\nSoluzione. Utilizziamo i seguenti parametri per la distribuzione Beta:\n\nCodicealpha <- 16\nbeta <- 24\n\n\nLa media di una \\(\\mbox{Beta}(16, 24)\\) è\n\nCodicealpha / (alpha + beta)\n#> [1] 0.4\n\n\nIn corrispondenza della media la densità della funzione è\n\nCodicedbeta(pi, alpha, beta)\n#> [1] 0\n\n\novvero\n\nCodicegamma(alpha + beta) / (gamma(alpha) * gamma(beta)) * \n  pi^(alpha - 1) * (1 - pi)^(beta - 1)\n#> [1] -6.99499e+26\n\n\nUsando la funzione dbeta() possiamo costruire un grafico della funzione \\(\\mbox{Beta}(16, 24)\\) nel modo seguente:\n\nCodicex <- seq(0, 1, length.out = 1e4)\ntibble(x) %>% \n  ggplot(aes(x, dbeta(x, alpha, beta))) +\n  geom_line() +\n  labs(\n    x = \"Probabilità di recidiva\",\n    y = \"Densità Beta(16, 24)\"\n  )"
  },
  {
    "objectID": "023_cont_rv_distr.html#distribuzione-di-cauchy",
    "href": "023_cont_rv_distr.html#distribuzione-di-cauchy",
    "title": "13  Distribuzioni di v.c. continue",
    "section": "\n13.8 Distribuzione di Cauchy",
    "text": "13.8 Distribuzione di Cauchy\nLa distribuzione di Cauchy è un caso speciale della distribuzione di \\(t\\) di Student con 1 grado di libertà. È definita da una densità di probabilità che corrisponde alla seguente funzione, dipendente da due parametri \\(\\theta\\) e \\(d\\) (con la condizione \\(d > 0\\)),\n\\[\nf(x; \\theta, d) = \\frac{1}{\\pi d} \\frac{1}{1 + \\left(\\frac{x - \\theta}{d} \\right)^2},\n\\tag{13.9}\\]\ndove \\(\\theta\\) è la mediana della distribuzione e \\(d\\) ne misura la larghezza a metà altezza."
  },
  {
    "objectID": "023_cont_rv_distr.html#distribuzione-log-normale",
    "href": "023_cont_rv_distr.html#distribuzione-log-normale",
    "title": "13  Distribuzioni di v.c. continue",
    "section": "\n13.9 Distribuzione log-normale",
    "text": "13.9 Distribuzione log-normale\nSia \\(y\\) una variabile casuale avente distribuzione normale con media \\(\\mu\\) e varianza \\(\\sigma^2\\). Definiamo poi una nuova variabile casuale \\(x\\) attraverso la relazione\n\\[\nx = e^y \\quad \\Longleftrightarrow \\quad y = \\log x.\n\\] Il dominio di definizione della \\(x\\) è il semiasse \\(x > 0\\) e la densità di probabilità \\(f(x)\\) è data da\n\\[\nf(x) = \\frac{1}{\\sigma \\sqrt{2 \\pi}} \\frac{1}{x} \\exp \\left\\{-\\frac{(\\log x -  \\mu)^2}{2 \\sigma^2} \\right\\}.\n\\tag{13.10}\\]\nQuesta funzione di densità è chiamata log-normale.\nIl valore atteso e la varianza di una distribuzione log-normale sono dati dalle seguenti equazioni:\n\\[\n\\mathbb{E}(x) = \\exp \\left\\{\\mu + \\frac{\\sigma^2}{2} \\right\\}.\n\\]\n\\[\n\\mathbb{V}(x) = \\exp \\left\\{2 \\mu + \\sigma^2 \\right\\} \\left(\\exp \\left\\{\\sigma^2 \\right\\}  -1\\right).\n\\]\nSi può dimostrare che il prodotto di variabili casuali log-normali ed indipendenti segue una distribuzione log-normale."
  },
  {
    "objectID": "023_cont_rv_distr.html#distribuzione-di-pareto",
    "href": "023_cont_rv_distr.html#distribuzione-di-pareto",
    "title": "13  Distribuzioni di v.c. continue",
    "section": "\n13.10 Distribuzione di Pareto",
    "text": "13.10 Distribuzione di Pareto\nLa distribuzione paretiana (o distribuzione di Pareto) è una distribuzione di probabilità continua e così chiamata in onore di Vilfredo Pareto. La distribuzione di Pareto è una distribuzione di probabilità con legge di potenza utilizzata nella descrizione di fenomeni sociali e molti altri tipi di fenomeni osservabili. Originariamente applicata per descrivere la distribuzione del reddito in una società, adattandosi alla tendenza che una grande porzione di ricchezza è detenuta da una piccola frazione della popolazione, la distribuzione di Pareto è diventata colloquialmente nota e indicata come il principio di Pareto, o “regola 80-20”. Questa regola afferma che, ad esempio, l’80% della ricchezza di una società è detenuto dal 20% della sua popolazione. Viene spesso applicata nello studio della distribuzione del reddito, della dimensione dell’impresa, della dimensione di una popolazione e nelle fluttuazioni del prezzo delle azioni.\nLa densità di una distribuzione di Pareto è\n\\[\nf(x)=(x_m/x)^\\alpha,\n\\tag{13.11}\\]\ndove \\(x_m\\) (parametro di scala) è il minimo (necessariamente positivo) valore possibile di \\(X\\) e \\(\\alpha\\) è un parametro di forma.\n\n\n\n\n\n\n\n\nLa distribuzione di Pareto ha una asimmetria positiva. Il supporto della distribuzione di Pareto è la retta reale positiva. Tutti i valori devono essere maggiori del parametro di scala \\(x_m\\), che è in realtà un parametro di soglia."
  },
  {
    "objectID": "023_cont_rv_distr.html#commenti-e-considerazioni-finali",
    "href": "023_cont_rv_distr.html#commenti-e-considerazioni-finali",
    "title": "13  Distribuzioni di v.c. continue",
    "section": "Commenti e considerazioni finali",
    "text": "Commenti e considerazioni finali\nIn questa dispensa le densità continue che useremo più spesso sono la distribuzione gaussiana e la distribuzione Beta. Faremo un uso limitato della distribuzione \\(t\\) di Student e della distribuzione di Cauchy. Le altre distribuzioni qui descritte sono stato presentate per completezza.\n\n\n\n\n\n\nMcElreath, R. (2020). Statistical rethinking: A Bayesian course with examples in R and Stan (2nd Edition). CRC Press.\n\n\nNuggerud-Galeas, S., Sáez-Benito Suescun, L., Berenguer Torrijo, N., Sáez-Benito Suescun, A., Aguilar-Latorre, A., Magallón Botaya, R., & Oliván Blázquez, B. (2020). Analysis of depressive episodes, their recurrence and pharmacologic treatment in primary care patients: A retrospective descriptive study. Plos One, 15(5), e0233454."
  },
  {
    "objectID": "024_likelihood.html",
    "href": "024_likelihood.html",
    "title": "14  La funzione di verosimiglianza",
    "section": "",
    "text": "La verosimiglianza viene utilizzata sia nell’inferenza bayesiana che in quella frequentista. In entrambi i paradigmi di inferenza, il suo ruolo è quantificare la forza con la quale i dati osservati supportano i possibili valori dei parametri sconosciuti di un modello statistico.\nDetto in altre parole, la funzione di verosimiglianza e la funzione di (massa o densità di) probabilità sono formalmente identiche, ma è completamente diversa la loro interpretazione:\nLa funzione di verosimiglianza descrive in termini relativi il sostegno empirico che \\(\\theta \\in \\Theta\\) riceve da \\(y\\). Infatti, la funzione di verosimiglianza assume forme diverse al variare di \\(y\\). Possiamo dunque pensare alla funzione di verosimiglianza come alla risposta alla seguente domanda: avendo osservato i dati \\(y\\), quanto risultano (relativamente) credibili i diversi valori del parametro \\(\\theta\\)? In termini più formali possiamo dire: sulla base dei dati, \\(\\theta_1 \\in \\Theta\\) risulta più credibile di \\(\\theta_2 \\in \\Theta\\) quale indice del modello probabilistico generatore dei dati se \\(\\mathcal{L}(\\theta_1) > \\mathcal{L}(\\theta_1)\\).\nSi noti un punto importante: la funzione \\(\\mathcal{L}(\\theta \\mid y)\\) non è una funzione di densità. Infatti, essa non racchiude un’area unitaria."
  },
  {
    "objectID": "024_likelihood.html#modello-binomiale",
    "href": "024_likelihood.html#modello-binomiale",
    "title": "14  La funzione di verosimiglianza",
    "section": "\n14.1 Modello binomiale",
    "text": "14.1 Modello binomiale\nIniziamo a discutere la funzione di verosimiglianza considerando il caso più semplice, ovvero quello Binomiale.\nPer \\(n\\) prove Bernoulliane indipendenti, le quali producono \\(y\\) successi e (\\(n-y\\)) insuccessi, la funzione nucleo di verosimiglianza (ovvero, la funzione di verosimiglianza da cui sono state escluse tutte le costanti moltiplicative che non hanno alcun effetto su \\(\\hat{\\theta}\\)) è\n\\[\n\\mathcal{L}(p \\mid y) = \\theta^y (1-\\theta)^{n - y}.\\notag\n\\tag{14.1}\\]\nPer fare un esempio pratico, consideriamo la ricerca di Zetsche et al. (2019). Questi ricercatori hanno trovato che, su 30 pazienti clinicamente depressi, 23 manifestavano delle aspettative relative al loro umore futuro distorsione negativamente. Se i dati di Zetsche et al. (2019) vengono riassunti da una proporzione (ovvero, 23/30), allora è sensato adottare un modello probabilistico binomiale quale meccanismo generatore dei dati:\n\\[\ny  \\sim \\mbox{Bin}(n, \\theta),\n\\tag{14.2}\\]\nladdove \\(\\theta\\) è la probabiltà che una prova Bernoulliana assuma il valore 1 e \\(n\\) corrisponde al numero di prove Bernoulliane. Questo modello assume che le prove Bernoulliane \\(y_i\\) che costituiscono il campione \\(y\\) siano tra loro indipendenti e che ciascuna abbia la stessa probabilità \\(\\theta \\in [0, 1]\\) di essere un “successo” (valore 1). In altre parole, il modello generatore dei dati avrà una funzione di massa di probabilità\n\\[\np(y \\mid \\theta)\n\\ = \\\n\\mbox{Bin}(y \\mid n, \\theta).\n\\]\nNei capitoli precedenti è stato mostrato come, sulla base del modello binomiale, sia possibile assegnare una probabilità a ciascun possibile valore \\(y \\in \\{0, 1, \\dots, n\\}\\) assumendo noto il valore del parametro \\(\\theta\\). Ma ora abbiamo il problema inverso, ovvero quello di fare inferenza su \\(\\theta\\) alla luce dei dati campionari \\(y\\). In altre parole, riteniamo di conoscere il modello probabilistico che ha generato i dati, ma di tale modello non conosciamo i parametri: vogliamo dunque ottenere informazioni su \\(\\theta\\) avendo osservato i dati \\(y\\). Per fare questo, in un ottica bayesiana, è innanzitutto necessario definire la funzione di verosimiglianza.\nPer i dati di Zetsche et al. (2019) la funzione di verosimiglianza corrisponde alla funzione binomiale di parametro \\(\\theta \\in [0, 1]\\) sconosciuto. Abbiamo osservato 23 successi, \\(y = 23\\), in 30 prove, \\(n = 30\\).\n\nCodicen <- 30\ny <- 23\n\n\nLa funzione di verosimiglianza dunque diventa\n\\[\n\\mathcal{L}(\\theta \\mid y) = \\frac{(23 + 7)!}{23!7!} \\theta^{23} + (1-\\theta)^7.\n\\tag{14.3}\\]\nPer costruire la funzione di verosimiglianza dobbiamo applicare l’Equazione 14.3 tante volte, cambiando ogni volta il valore \\(\\theta\\), ma tenendo sempre costante il valore dei dati. Nella simulazione considereremo 100 possibili valori \\(\\theta \\in [0, 1]\\).\n\nCodicetheta <- seq(0, 1, length.out = 100)\ntheta\n#>   [1] 0.00000000 0.01010101 0.02020202 0.03030303 0.04040404 0.05050505\n#>   [7] 0.06060606 0.07070707 0.08080808 0.09090909 0.10101010 0.11111111\n#>  [13] 0.12121212 0.13131313 0.14141414 0.15151515 0.16161616 0.17171717\n#>  [19] 0.18181818 0.19191919 0.20202020 0.21212121 0.22222222 0.23232323\n#>  [25] 0.24242424 0.25252525 0.26262626 0.27272727 0.28282828 0.29292929\n#>  [31] 0.30303030 0.31313131 0.32323232 0.33333333 0.34343434 0.35353535\n#>  [37] 0.36363636 0.37373737 0.38383838 0.39393939 0.40404040 0.41414141\n#>  [43] 0.42424242 0.43434343 0.44444444 0.45454545 0.46464646 0.47474747\n#>  [49] 0.48484848 0.49494949 0.50505051 0.51515152 0.52525253 0.53535354\n#>  [55] 0.54545455 0.55555556 0.56565657 0.57575758 0.58585859 0.59595960\n#>  [61] 0.60606061 0.61616162 0.62626263 0.63636364 0.64646465 0.65656566\n#>  [67] 0.66666667 0.67676768 0.68686869 0.69696970 0.70707071 0.71717172\n#>  [73] 0.72727273 0.73737374 0.74747475 0.75757576 0.76767677 0.77777778\n#>  [79] 0.78787879 0.79797980 0.80808081 0.81818182 0.82828283 0.83838384\n#>  [85] 0.84848485 0.85858586 0.86868687 0.87878788 0.88888889 0.89898990\n#>  [91] 0.90909091 0.91919192 0.92929293 0.93939394 0.94949495 0.95959596\n#>  [97] 0.96969697 0.97979798 0.98989899 1.00000000\n\n\nPer esempio, ponendo \\(\\theta = 0.1\\) otteniamo un valore dell’ordinata della funzione di verosimiglianza\n\\[\n\\mathcal{L}(\\theta \\mid y) = \\frac{(23 + 7)!}{23!7!} 0.1^{23} + (1-0.1)^7.\n\\]\n\nCodicedbinom(23, 30, 0.1)\n#> [1] 9.737168e-18\n\n\nPonendo \\(\\theta = 0.2\\) otteniamo un altro valore dell’ordinata della funzione di verosimiglianza\n\\[\n\\mathcal{L}(\\theta \\mid y) = \\frac{(23 + 7)!}{23!7!} 0.2^{23} + (1-0.2)^7.\n\\]\n\nCodicedbinom(23, 30, 0.2)\n#> [1] 3.581417e-11\n\n\nSe ripetiamo questo processo 100 volte, una volta per ciascuno dei valori \\(\\theta\\) considerati, otteniamo 100 coppie di punti \\(\\theta\\) e \\(f(\\theta)\\).\n\nCodicelike <- choose(n, y) * theta^y * (1 - theta)^(n - y)\n\n\nLa curva che interpola tali punti è la funzione di verosimiglianza. La Figura 14.1 fornisce una rappresentazione grafica di tale funzione.\n\nCodicetibble(theta, like) %>%\n  ggplot(aes(x = theta, y = like)) +\n  geom_line() +\n  vline_at(0.7676768, color = \"lightgray\", linetype=\"dashed\") +\n  labs(\n    y = expression(L(theta)),\n    x = expression(\"Valori possibili di\" ~ theta)\n  )\n\n\n\nFigura 14.1: Funzione di verosimiglianza nel caso di 23 successi in 30 prove.\n\n\n\n\n\n14.1.1 Interpretazione\nCome possiamo interpretare la curva che abbiamo ottenuto? Per alcuni valori \\(\\theta\\) la funzione di verosimiglianza assume valori piccoli; per altri valori \\(\\theta\\) la funzione di verosimiglianza assume valori più grandi. Questi ultimi sono i valori di \\(\\theta\\) più credibili e il valore 23/30 = 0.767 (la moda della funzione di verosimiglianza) è il valore più credibile di tutti.\n\nCodiced <- tibble(theta, like)\nd[which.max(like), ]$theta\n#> [1] 0.7676768\n\n\n\n14.1.2 La log-verosimiglianza\nDal punto di vista pratico risulta più conveniente utilizzare, al posto della funzione di verosimiglianza, il suo logaritmo naturale, ovvero la funzione di log-verosimiglianza:\n\\[\n\\ell(\\theta) = \\log \\mathcal{L}(\\theta).\n\\tag{14.4}\\]\nPoiché il logaritmo è una funzione strettamente crescente (usualmente si considera il logaritmo naturale), allora \\(\\mathcal{L}(\\theta)\\) e \\(\\ell(\\theta)\\) assumono il massimo (o i punti di massimo) in corrispondenza degli stessi valori di \\(\\theta\\):\n\\[\n\\hat{\\theta} = \\mbox{argmax}_{\\theta \\in \\Theta} \\ell(\\theta) = \\mbox{argmax}_{\\theta \\in \\Theta} \\mathcal{L}(\\theta).\n\\]\nPer le proprietà del logaritmo, la funzione nucleo di log-verosimiglianza è\n\\[\n\\begin{aligned}\n\\ell(\\theta \\mid y) &= \\log \\mathcal{L}(\\theta \\mid y) \\notag\\\\\n          &= \\log \\left(\\theta^y (1-\\theta)^{n - y} \\right) \\notag\\\\\n          &= \\log \\theta^y + \\log \\left( (1-\\theta)^{n - y} \\right) \\notag\\\\\n          &= y \\log \\theta + (n - y) \\log (1-\\theta).\\notag\n\\end{aligned}\n\\]\nSi noti che non è necessario lavorare con i logaritmi, ma è fortemente consigliato. Il motivo è che i valori della verosimiglianza, in cui si moltiplicano valori di probabilità molto piccoli, possono diventare estremamente piccoli – qualcosa come \\(10^{-34}\\). In tali circostanze, non è sorprendente che i programmi dei computer mostrino problemi di arrotondamento numerico. Le trasformazioni logaritmiche risolvono questo problema.\nSvolgiamo nuovamente il problema precedente usando la log-verosimiglianza per trovare il massimo della funzione di log-verosimiglianza. Nella funzione dbinom() ora utilizziamo l’argomento log = TRUE.\n\nCodicell <- dbinom(y, n, theta, log = TRUE) \n\n\nLa funzione di log-verosimiglianza è rappresentata nella Figura 14.2.\n\nCodicetibble(theta, ll) %>%\n  ggplot(aes(x = theta, y = ll)) +\n  geom_line() +\n  vline_at(0.7676768, color = \"lightgray\", linetype=\"dashed\") +\n  labs(\n    y = expression(\"log-likelihood\" ~ (theta)),\n    x = expression(\"Valori possibili di\" ~ theta)\n  )\n\n\n\nFigura 14.2: Funzione di log-verosimiglianza nel caso di 23 successi in 30 prove.\n\n\n\n\nIl risultato replica quello trovato in precedenza con la funzione di verosimiglianza.\n\nCodiced <- tibble(theta, ll)\nd[which.max(ll), ]$theta\n#> [1] 0.7676768"
  },
  {
    "objectID": "024_likelihood.html#modello-gaussiano",
    "href": "024_likelihood.html#modello-gaussiano",
    "title": "14  La funzione di verosimiglianza",
    "section": "\n14.2 Modello gaussiano",
    "text": "14.2 Modello gaussiano\nOra che abbiamo capito come costruire la funzione verosimiglianza di una binomiale è relativamente semplice fare un passo ulteriore e considerare la verosimiglianza del caso di una funzione di densità, ovvero nel caso di una variabile casuale continua. Consideriamo qui il caso della Normale. La densità di una distribuzione Normale di parametri \\(\\mu\\) e \\(\\sigma\\) è\n\\[\nf(y \\mid \\mu, \\sigma) = \\frac{1}{\\sigma \\sqrt{2\\pi}} \\exp\\left\\{-\\frac{1}{2\\sigma^2}(y-\\mu)^2\\right\\}.\n\\tag{14.5}\\]\nCi poniamo ora il problema di costruire la funzione di verosimiglianza per la densità dell’Equazione 14.5.\n\n14.2.1 Una singola osservazione\nEsaminiamo prima il caso in cui i dati corrispondono ad una singola osservazione \\(y\\).\n\nCodicey <- 114\n\n\nL’Equazione 14.5 dipende dai parametri \\(\\mu\\) e \\(\\sigma\\) e dai dati \\(y\\). Per semplicità, ipotizzeremo \\(\\sigma\\) noto e uguale a 15. Nella simulazione considereremo 1000 valori \\(\\mu\\) compresi tra 70 e 160.\n\nCodicemu <- seq(70, 160, length.out = 1e3)\n\n\nDato che consideriamo 1000 possibili valori \\(\\mu\\), per costruire la funzione di verosimiglianza applicheremo l’Equazione 14.5 1000 volte. In ciascun passo della simulazione inseriremo nell’Equazione 14.5\n\nil singolo valore \\(y\\) considerato,\nil valore \\(\\sigma\\) assunto noto,\nciascuno dei valori \\(\\mu\\) che abbiamo considerato.\n\nLa distribuzione Gaussiana è implementata in \\(\\mathsf{R}\\) nella funzione dnorm(). La funzione dnorm() ha tre argomenti: il valore \\(y\\) (o il vettore \\(y\\)), la media, ovvero il parametro \\(\\mu\\) e la deviazione standard, ovvero il parametro \\(\\sigma\\).\nUsando la funzione dnorm() 1000 volte, una volta per ciascuno dei valori \\(\\mu\\) che abbiamo considerato (e tenendo fissi \\(y = 114\\) e \\(\\sigma = 15\\)) otteniamo 1000 valori \\(f(\\mu)\\).\n\nCodicef_mu <- dnorm(y, mean = mu, sd = 15)\n\n\nLa funzione di verosimiglianza è la curva che interpola i punti \\(\\big(\\mu, f(\\mu)\\big)\\).\n\nCodicetibble(mu, f_mu) %>% \n  ggplot(\n    aes(x = mu, y = f_mu)\n  ) +\n    geom_line() +\n    vline_at(114, color = \"lightgray\", linetype=\"dashed\") +\n      labs(\n      y = \"Verosimiglianza\",\n      x = c(\"Parametro \\u03BC\")\n    ) \n\n\n\n\n\n\n\nSi noti che la funzione di verosimiglianza così trovata ha la forma della distribuzione Gaussiana. Nel caso di una singola osservazione (ma solo in questo caso) ha un’area unitaria.\n\nCodiceintegrand <- function(mu) {\n  y = 114\n  sigma = 15\n  dnorm(y, mu, sigma)\n}\nintegrate(integrand, lower = -10000, upper = 10000)\n#> 1 with absolute error < 1.6e-06\n\n\nLa moda della funzione di verosimiglianza è 114.\n\n14.2.2 Un campione di osservazioni\nConsideriamo ora il caso più generale, ovvero quello di un campione di \\(n\\) osservazioni. Possiamo immaginare un campione casuale \\(y_1, y_2, \\dots, y_n\\) estratto da una popolazione \\(\\mathcal{N}(\\mu, \\sigma)\\) come una sequenza di realizzazioni indipendenti ed identicamente distribuite (di seguito, i.i.d.) della medesima variabile casuale \\(Y \\sim \\mathcal{N}(\\mu, \\sigma)\\). I parametri sconosciuti sono \\(\\theta = \\{\\mu, \\sigma\\}\\).\nSe le variabili casuali \\(y_1, y_2, \\dots, y_n\\) sono i.i.d., la loro densità congiunta è data da: \\[\\begin{align}\nf(y \\mid \\theta) &= f(y_1 \\mid \\theta) \\cdot f(y_2 \\mid \\theta) \\cdot \\; \\dots \\; \\cdot f(y_n \\mid \\theta)\\notag\\\\\n                 &= \\prod_{i=1}^n f(y_i \\mid \\theta),\n\\end{align}\\]\nladdove \\(f(\\cdot)\\) è la densità Gaussiana di parametri \\(\\mu, \\sigma\\). Tenendo costanti i dati \\(y\\), la funzione di verosimiglianza diventa:\n\\[\\begin{equation}\n\\mathcal{L}(\\theta \\mid y) = \\prod_{i=1}^n f(y_i \\mid \\theta).\n\\end{equation}\\]\nPer chiarire la formula precedente, consideriamo un esempio che utilizza come dati i valori BDI-II dei trenta soggetti del campione clinico di Zetsche et al. (2020).\n\nCodiced <- tibble(\n  y = c(\n    26, 35, 30, 25, 44, 30, 33, 43, 22, 43, 24, 19, 39, 31, 25, 28, 35, 30, 26, \n    31, 41, 36, 26, 35, 33, 28, 27, 34, 27, 22\n    )\n)\n\n\nCi poniamo l’obiettivo di creare la funzione di verosimiglianza per questi dati, supponendo di sapere (in base ai risultati di ricerche precedenti) che i punteggi BDI-II si distribuiscono secondo la legge Normale e supponendo \\(\\sigma\\) noto e uguale alla deviazione standard del campione.\n\nCodicetrue_sigma <- sd(d$y)\ntrue_sigma \n#> [1] 6.606858\n\n\nAbbiamo visto in precedenza che, per una singola osservazione, la funzione di verosimiglianza è la densità Gaussiana espressa in funzione dei parametri (in questo caso, solo \\(\\mu\\)). Per un campione di osservazioni i.i.d., ovvero \\(y = (y_1, y_2, \\dots, y_n)\\), la verosimiglianza è la funzione di densità congiunta \\(f(y \\mid \\mu, \\sigma)\\) espressa in funzione dei parametri. Dato che le osservazioni sono i.i.d., la densità congiunta è data dal prodotto delle densità delle singole osservazioni.\nPer l’osservazione \\(y_i\\) abbiamo\n\\[\nf(y_i \\mid \\mu, \\sigma) = \\frac{1}{{6.61 \\sqrt {2\\pi}}}\\exp\\left\\{{-\\frac{(y_i - \\mu)^2}{2\\cdot 6.61^2}}\\right\\}.\n\\]\nLa densità congiunta è dunque\n\\[\nf(y \\mid \\mu, \\sigma) = \\, \\prod_{i=1}^n f(y_i \\mid \\mu, \\sigma)\n\\]\nAlla luce dei dati osservati (e assumendo \\(\\sigma = 6.61\\)), la verosimiglianza diventa\n\\[\n\\begin{aligned}\n\\mathcal{L}(\\mu, \\sigma \\mid y) =& \\, \\prod_{i=1}^n f(y_i \\mid \\mu, \\sigma) = \\notag\\\\\n& \\frac{1}{{6.61 \\sqrt {2\\pi}}}\\exp\\left\\{{-\\frac{(26 - \\mu)^2}{2\\cdot 6.61^2}}\\right\\} \\times \\notag\\\\\n& \\frac{1}{{6.61 \\sqrt {2\\pi}}}\\exp\\left\\{{-\\frac{(35 - \\mu)^2}{2\\cdot 6.61^2}}\\right\\} \\times  \\notag\\\\\n& \\vdots \\notag\\\\\n& \\frac{1}{{6.61 \\sqrt {2\\pi}}}\\exp\\left\\{{-\\frac{(22 - \\mu)^2}{2\\cdot 6.61^2}}\\right\\}.\n\\end{aligned}\n\\]\nÈ più conveniente svolgere l’esercizio usando il logaritmo della verosimiglianza. In \\(\\textsf{R}\\), definiamo la funzione di log-verosimiglianza, log_likelihood(), che prende come argomenti y, mu e sigma = 6.61.\n\nCodicelog_likelihood <- function(y, mu, sigma = true_sigma) {\n  sum(dnorm(y, mu, sigma, log = TRUE))\n}\n\n\nL’argomento y è un vettore di 30 elementi; gli argomenti mu e sigma sono scalari.\nPer ciascuno valore y, la funzione dnorm() trova la densità Normale utilizzando il valore mu in input e sigma = 6.61. L’argomento log = TRUE specifica che deve essere preso il logaritmo. I 30 valori così ottenuti vengono poi sommati dalla funzione sum().\nUtilizzando un singolo valore \\(\\mu\\) otteniamo l’ordinata della funzione di log-verosimiglianza in corrispondenza del valore \\(\\mu\\) utilizzato. Vogliamo però trovare l’ordinata della log-verosimiglianza per tutti i possibili valori che \\(\\mu\\) può assumere. Nella simulazione, usiamo 100,000 valori possibili del parametro \\(\\mu \\in [\\bar{y} - \\mbox{SD}, \\bar{y} + \\mbox{SD}]\\). Mediante un ciclo for(), ripetiamo dunque i calcoli descritti sopra 100,000 volte, una volta per ciascuno dei valori \\(\\mu\\) considerati. I 100,000 risultati vengono salvati nel vettore ll.\n\nCodicenrep <- 1e5\nmu <- seq(\n  mean(d$y) - sd(d$y), \n  mean(d$y) + sd(d$y), \n  length.out = nrep\n)\n\nll <- rep(NA, nrep)\nfor (i in 1:nrep) {\n  ll[i] <- log_likelihood(d$y, mu[i], true_sigma)\n}\n\n\nNel caso di un solo parametro sconosciuto (nel caso presente, \\(\\mu\\)) è possibile rappresentare la log-verosimiglianza con una curva che interpola i punti (mu, ll).\n\nCodicetibble(mu, ll) %>% \nggplot(aes(x = mu, y = ll)) +\n  geom_line() +\n  vline_at(mean(d$y), color = \"gray\", linetype = \"dashed\") +\n  labs(\n    y = \"Log-verosimiglianza\",\n    x = expression(\"Parametro\"~mu)\n  ) \n\n\n\nFigura 14.3: Log-verosimiglianza del parametro \\(\\mu\\) per i dati di Zetsche et al. (2019).\n\n\n\n\nTale funzione descrive la credibilità relativa che può essere attribuita ai valori del parametro \\(\\mu\\) alla luce dei dati osservati.\n\n14.2.3 Massima verosimiglianza\nIl valore \\(\\mu\\) più credibile corrisponde al massimo della funzione di log-verosimiglinza e viene detto stima di massima verosimiglianza.\nIl massimo della funzione di log-verosimiglianza, ovvero 30.93 nel caso dell’esempio presente, è identico alla media dei dati campionari. Tale risultato, ottenuto per via numerica, può essere dimostrato formalmente nel modo seguente.\nUsando la notazione matematica possiamo dire che cerchiamo l’argmax dell’equazione precedente rispetto a \\(\\theta\\), ovvero\n\\[\n\\hat{\\theta} = \\text{argmax}_{\\theta} \\prod_{i=1}^n f(y_i \\mid \\theta).\n\\]\nQuesto problema si risolve calcolando le derivate della funzione rispetto a \\(\\theta\\), ponendo le derivate uguali a zero e risolvendo. Saltando tutti i passaggi algebrici di questo procedimento, per \\(\\mu\\) troviamo\n\\[\\begin{equation}\n\\hat{\\mu} = \\frac{1}{n} \\sum_{i=1}^n y_i\n\\end{equation}\\]\ne per \\(\\sigma\\) abbiamo\n\\[\\begin{equation}\n\\hat{\\sigma} = \\sqrt{\\sum_{i=1}^n\\frac{1}{n}(y_i- \\mu)^2}.\n\\end{equation}\\]\nIn altri termini, la s.m.v. del parametro \\(\\mu\\) è la media del campione e la s.m.v. del parametro \\(\\sigma\\) è la deviazione standard del campione.\n\nEsercizio 14.1 \nDalla Figura 14.3 notiamo che il massimo della funzione di log-verosimiglianza calcolata per via numerica, ovvero 30.93, è identico alla media dei dati campionari e corrisponde al risultato teorico atteso."
  },
  {
    "objectID": "024_likelihood.html#commenti-e-considerazioni-finali",
    "href": "024_likelihood.html#commenti-e-considerazioni-finali",
    "title": "14  La funzione di verosimiglianza",
    "section": "Commenti e considerazioni finali",
    "text": "Commenti e considerazioni finali\nNella funzione di verosimiglianza i dati (osservati) vengono trattati come fissi, mentre i valori del parametro (o dei parametri) \\(\\theta\\) vengono variati: la verosimiglianza è una funzione di \\(\\theta\\) per il dato fisso \\(y\\). Pertanto, la funzione di verosimiglianza riassume i seguenti elementi: un modello statistico che genera stocasticamente i dati (in questo capitolo abbiamo esaminato due modelli statistici: quello binomiale e quello Normale), un intervallo di valori possibili per \\(\\theta\\) e i dati osservati \\(y\\).\nNella statistica frequentista l’inferenza si basa solo sui dati a disposizione e qualunque informazione fornita dalle conoscenze precedenti non viene presa in considerazione. Nello specifico, nella statistica frequentista l’inferenza viene condotta massimizzando la funzione di (log) verosimiglianza, condizionatamente ai valori assunti dalle variabili casuali campionarie. Le basi dell’inferenza frequentista, dunque, sono state riassunte in questo Capitolo. Nella statistica bayesiana, invece, l’inferenza statistica viene condotta combinando la funzione di verosimiglianza con le distribuzioni a priori dei parametri incogniti \\(\\theta\\). Ciò verrà discusso nei Capitoli successivi.\nLa differenza fondamentale tra inferenza bayesiana e frequentista è dunque che i frequentisti non ritengono utile descrivere i parametri in termini probabilistici: i parametri dei modelli statistici vengono concepiti come fissi ma sconosciuti. Nell’inferenza bayesiana, invece, i parametri sconosciuti sono intesi come delle variabili casuali e ciò consente di quantificare in termini probabilistici il nostro grado di intertezza relativamente al loro valore.\n\n\n\n\n\n\nZetsche, U., Bürkner, P.-C., & Renneberg, B. (2019). Future expectations in clinical depression: Biased or realistic? Journal of Abnormal Psychology, 128(7), 678–688."
  },
  {
    "objectID": "025_intro_bayes.html",
    "href": "025_intro_bayes.html",
    "title": "15  Credibilità, modelli e parametri",
    "section": "",
    "text": "L’obiettivo di questo Capitolo è di introdurre il quadro concettuale dell’analisi dei dati bayesiana."
  },
  {
    "objectID": "025_intro_bayes.html#analisi-dei-dati-bayesiana",
    "href": "025_intro_bayes.html#analisi-dei-dati-bayesiana",
    "title": "15  Credibilità, modelli e parametri",
    "section": "\n15.1 Analisi dei dati bayesiana",
    "text": "15.1 Analisi dei dati bayesiana\nL’analisi dei dati bayesiana si basa su due idee fondamentali.\n\nLa prima idea è la riallocazione della credibilità tra le possibilità.\n\nLa seconda idea è che le possibili ipotesi, a cui attribuiamo diversi gradi di credibilità, corrispondono ai valori dei parametri di un modello statistico.\n\n\n15.1.1 Prima idea: riallocazione della credibilità\nConsideriamo la prima idea. Kruschke (2014) la descrive mediante un riferimento letterario. Il detective immaginario Sherlock Holmes spesso diceva al suo compagno, il dottor Watson: “Quante volte ti ho detto che quando hai eliminato l’impossibile, tutto ciò che rimane, per quanto improbabile, deve essere la verità?” (Doyle, 1890, cap. 6). Anche se il ragionamento di Holmes o Watson o Doyle non è mai stato descritto come un’inferenza bayesiana, in realtà lo è. Nei romanzi di Doyle, Sherlock Holmes ragiona nel modo seguente. Holmes inizia a elencare i vari sospetti di un crimine. A priori, attribuisce un certo grado di credibilità alla possibilità che il colpevole sia uno dei sospetti considerati. In seguito, Holmes raccoglie sistematicamente le prove che escludono alcuni possibili sospetti. Se è possibile escludere tutti i possibili sospetti tranne uno, allora Sherlock Holmes conclude attribuendo una piena credibilità all’idea che il colpevole sia il sospetto rimanente, anche se all’inizio questa idea poteva sembrare poco credibile.\nKruschke (2014) esprime il ragionamento “bayesiano” di Sherlock Holmes mediante la seguente figura. Supponiamo che vi siano quattro possibili ipotesi rispetto ad un fenomeno (nella figura “Possibilities”): A, B, C, D. Queste ipotesi possono corrispondere, ad esempio, ai quattro sospettati.\n\n\n\n\n\n\n\n\nLa riga superiore riporta la credibilità a priori che viene assegnata all’ipotesi che ciascun sospettato sia il colpevole. Nella prima colonna, la credibilità a priori si distribuisce equamente tra i quattro sospettati. Si noti che all’intera credibilità a priori assegniamo il valore 1; se ci sono quattro sospettati, e non abbiamo modo di distinguere tra essi, allora la credibilità dell’ipotesi che uno di essi sia il colpevole vale 0.25. Se i dati a disposizione consentono di escludere il sospettato A allora, a posteriori, la credibilità si ridistribuisce tra i tre rimanenti sospettati come indicato nella figura (ovvero, la credibilità dell’ipotesi che uno di essi sia il colpevle varrà 1/3).\nIl passaggio dalla distribuzione a priori a quella a posteriori si dice aggiornamento bayesiano. Per il caso rappresentato nella prima colonna, l’aggiornamento bayesiano (ovvero, la riallocazione della credibilità alla luce dei dati a disposizione) ha consentito di escludere un sospettato. Nella seconda colonna, a priori si considera impossibile il sospettato A, per cui la credibilità di distribuisce equamente tra i rimanenti tre sospettati. Supponendo che i dati consentano di escludere la possibilità B, l’aggiornamento bayesiano ci porta alla distribuzione a posteriori della credibilità che si distribuisce equamente tra C e D. In questo caso, sono stati esclusi due sospettati, ma non è possibile decidere tra C e D. Infine, il caso più fortunato è descritto nell’ultima colonna; in questo caso, a priori, possiamo escludere A e B. I dati ci consentono di escludere C. Dunque, a posteriori, siamo sicuri (la credibilità è 1) che D sia il colpevole.\nL’analisi bayesiana procede allo stesso modo: distribuisce la credibilità a priori tra una serie di possibilità. Vengono poi acquisite le informazioni fornite dai dati. Sulla base di tali informazioni si ottiene un nuova distribuzione della credibilità tra le possibilità. Tale aggiornamento delle credenze conduce alla distribuzione a posteriori, la quale descrive il modo in cui abbiamo modificato le nostre credenze a priori alla luce delle informazioni fornite dai dati.\n\n15.1.1.1 I dati sono rumorosi e le inferenze sono probabilistiche\nI casi della figura precedente presupponevano che i dati avessero relazioni deterministiche con le possibili cause. Ad esempio, Sherlock Holmes potrebbe aver trovato un’impronta sulla scena del crimine e identificato la taglia e il tipo di scarpa con assoluta certezza, escludendo così completamente o implicando un particolare sospettato.\nNella ricerca scientifica la situazione è più complessa in quanto le relazioni tra i dati e le cause soggiacenti sono solo probabilistiche (non deterministiche). Un vero investigatore potrebbe misurare l’impronta di una scarpa e i dettagli del suo battistrada, ma queste misurazioni restringerebbero solo probabilisticamente la gamma delle scarpe possibili che potrebbero aver prodotto l’impronta. Al di fuori dei romanzi di Arthur Conan Doyle, le misure non sono mai perfette e l’impronta è solo una rappresentazione imperfetta della scarpa che l’ha prodotta. La relazione tra la causa (cioè la scarpa) e l’effetto misurato (cioè l’impronta) viene complicata dalla presenza del “rumore della misurazione”.\nNella ricerca scientifica, le misurazioni sono fortemente contaminate da molteplici influenze estranee, nonostante gli enormi sforzi dei ricercatori per limitare la loro influenza. Per esempio, in uno studio sull’apprendimento della statistica da parte degli studenti di psicologia, un ricercatore potrebbe dividere gli studenti in due gruppi: un gruppo sperimentale (che affianca lo studio del materiale dell’esame con una serie di esercitazioni nelle quali viene utilizzato un software per l’analisi dei dati) e un gruppo di controllo (che studia il materiale dell’esame su un testo e si limita a svolgere degli esercizi scolastici carta-e-penna). Supponiamo che il ricercatore misuri la prestazione all’esame dei due gruppi. È chiaro che la prestazione all’esame per ogni singolo studente, al di là dell’effetto della manipolazione sperimentale, può variare notevolmente a seconda di molte altre influenze, come la motivazione, l’ansia, la possibilità di usare un computer, le conoscenze informatiche, la preparazione pregressa nelle materie quantitative, la quantità e qualità dello studio, ecc. I dati risultanti, quindi, saranno estremamente rumorosi, con un’enorme variabilità all’interno di ciascun gruppo e un’enorme sovrapposizione tra i gruppi. Pertanto, ci saranno molti studenti del gruppo sperimentale che faranno meglio all’esame della media gruppo di controllo e viceversa. Da queste due distribuzioni di voti all’esame, molto disperse e sovrapposte, vogliamo inferire qual è la differenza media tra i due gruppi e quanto possiamo essere certi che vi sia una differenza. Tutte le misurazioni scientifiche (i dati) includono un certo grado di “rumore”. Le tecniche di analisi dei dati sono progettate per inferire le tendenze sottostanti presenti in dati rumorosi. A differenza di Sherlock Holmes, che sulla base di un’osservazione esclude completamente un sospettato, nella ricerca scientifica vengono raccolti dei dati che modificano solo incrementalmente la credibilità che può essere attribuita alle possibili tendenze suggerite dai dati. In questo insegnamento vedremo molti esempi realistici di questo processo. Uno dei maggiori vantaggi dell’analisi bayesiana è il fatto che essa consente di utilizzare la teoria delle probabilità per riallocare la credibilità tra le ipotesi, alla luce delle informazioni fornite dai dati, in un modo non arbitrario e automatico.\n\n15.1.2 Seconda idea: le possibilità sono valori di parametri in un modello statistico\nBDI-II prima e dopo un intervento psicologico.\nNel precedente ragionamento “bayesiano” di Sherlock Holmes, le possibilità corrispondevano alle quattro modalità di una variabile discreta: la variabile era “i sospettati del crimine” e le modalità erano A, B, C e D. In statistica, lavorare con variabili discrete è complicato. È più semplice svolgere l’aggiornamento bayesiano mediante gli strumenti della teoria delle probabilità se vengono invece utilizzate variabili continue. In tali circostanze, le “possibilità” corrispondono ai valori dei parametri in un modello statistico. Possiamo chiarire questa affermazione nel modo seguente.\nConsideriamo una distribuzione di differenze di punteggi BDI-II misurati prima e dopo un intervento psicologico: se l’intervento funziona i punteggi BDI-II saranno minori dopo l’intervento e dunque la differenza prima - dopo sarà positiva. L’intervento però non ha gli stessi effetti sui diversi partecipanti per cui, in uno studio, osserviaamo una distribuzione di punteggi (prima - dopo). Supponiamo che tale distrinuzione di punteggi sia rappresentata dall’istogramma illustrato nella figura seguente.\n\nCodiceset.seed(2)\nd <- tibble(x = rnorm(2000, mean = 5, sd = 4))\n\n# plot!\nd %>% ggplot(aes(x = x)) +\n  geom_histogram(aes(y = ..density..),\n                 binwidth = 1, fill = \"grey67\", \n                 color = \"grey92\", size = 1/10) +\n  geom_line(data = tibble(x = seq(from = -10, to = 20, by = .01)),\n            aes(x = x, y = dnorm(x, mean = 5, sd = 4)),\n            color = \"grey33\") +\n  labs(subtitle = \"The candidate normal distribution\\nhas a mean of 5 and SD of 4.\",\n       x = \"Data Values\", \n       y = \"Data Probability\") +\n  theme(panel.grid = element_blank())\n\n\n\n\n\n\n\nAll’istogramma è sovrapposta una distribuzione Gaussiana di parametri \\(\\mu\\) = 5 e \\(\\sigma\\) = 4. Questa scelta per i valori dei parametri sembra appropriata per descrivere i dati a disposizione. Qui in basso mostriamo gli stessi dati ipotetici con sovrapposta una diversa distribuzione Gaussiana, di parametri \\(\\mu\\) = 3.5 e \\(\\sigma\\) = 5. Anche se questa seconda distribuzione Gaussiana è plausibile, sicuramente descrive i dati in una maniera peggiore del caso precedente.\n\nCodiceggplot(data = d, aes(x = x)) +\n  geom_histogram(aes(y = ..density..),\n                 binwidth = 1, fill = \"grey67\",\n                 color = \"grey92\", size = 1/8) +\n  stat_function(fun = dnorm, n = 101, args = list(mean = 3.5, sd = 5),\n                color = \"grey33\", linetype = 2) +\n  labs(subtitle = \"The candidate normal distribution\\nhas a mean of 3.5 and SD of 5.\",\n       x = \"Data Values\", \n       y = \"Data Probability\") +\n  theme(panel.grid = element_blank())\n\n\n\n\n\n\n\nIl ruolo dell’inferenza bayesiana è quello di calcolare l’esatta credibilità relativa dei valori dei parametri candidati, tenendo anche conto delle loro probabilità a priori. In applicazioni realistiche, i valori dei parametri candidati possono formare un continuum infinito. Il parametro di localizzazione della distribuzione normale può assumere qualsiasi valore da negativo a positivo infinito. L’inferenza bayesiana opera senza problemi su continui infiniti.\nCi sono due principali desiderata per una descrizione matematica dei dati. In primo luogo, la descrizione matematica dovrebbe essere comprensibile. Così come sarebbe inutile descrivere i dati in una lingua che non conosciamo, sarebbe inutile descrivere i dati con una forma matematica che non comprendiamo, con parametri che non possiamo interpretare. Nel caso di una distribuzione normale, ad esempio, il parametro \\(\\mu\\) medio e il parametro \\(\\sigma\\) sono direttamente interpretabili come indici di posizione e scala della distribuzione. In questo insegnamento useremo descrizioni matematiche dei dati dotate di parametri a cui è possibile attribuire un’interpretazione intuitiva. Pertanto, possiamo dire che l’analisi bayesiana rialloca la credibilità tra i valori dei parametri all’interno di uno spazio di possibilità definito dal modello scelto.\nIl secondo desideratum di una modellizzazione matematica è che dovrebbe essere descrittivamente adeguata, il che significa, all’incirca, che il modello matematico (in questo caso, la curva Normale) dovrebbe “assomigliare” ai dati. Non dovrebbero esserci discrepanze sistematiche importanti tra le tendenze dei dati e la forma del modello. Decidere se un’apparente discrepanza sia importante o sistematica non è un processo definito. Nelle prime fasi della ricerca, potremmo essere soddisfatti di una descrizione approssimativa e “abbastanza buona” dei dati, perché cattura tendenze significative che sono interessanti e nuove rispetto alle conoscenze precedenti. Man mano che il campo della ricerca matura, potremmo richiedere descrizioni sempre più accurate dei dati. L’analisi bayesiana è molto utile per valutare la credibilità relativa di diverse possibili modellizzazioni matematiche dei dati.\nÈ anche importante capire che le descrizioni matematiche dei dati non sono necessariamente spiegazioni causali dei dati. Dire che i dati sono ben descritti da una distribuzione normale con media di 5 e deviazione standard di 4 non spiega quale processo abbia causato i dati aventi quella forma. I parametri hanno un significato solo nel contesto del modello matematico della distribuzione normale; i valori dei parametri non hanno necessariamente un significato se consideriamo le cause dell’efficacia (o non efficacia) dell’intervento psicologico nell’esempio. Meglio sarebbe esprimere le possibili cause dell’efficiacia dell’intervento psicologico nei termini di un modello matematico per poi usare i dati, e l’analisi bayesiana, per stimare i parametri del modello (ovvero, per attribuire un “peso” alle possibili cause), ma procedere in questo modo è possibile solo in pochi casi. Solitamente la psicologia si accontenta di descrivere le differenze medie tra gruppi, senza un’indagine puntuale delle cause di tali differenze."
  },
  {
    "objectID": "025_intro_bayes.html#modellizzazione-bayesiana",
    "href": "025_intro_bayes.html#modellizzazione-bayesiana",
    "title": "15  Credibilità, modelli e parametri",
    "section": "\n15.2 Modellizzazione bayesiana",
    "text": "15.2 Modellizzazione bayesiana\nLa moderna statistica bayesiana viene per lo più eseguita utilizzando un linguaggio di programmazione probabilistico implementato su computer. Ciò ha cambiato radicalmente il modo in cui venivano eseguite le statistiche bayesiane anche fin pochi decenni fa. La complessità dei modelli che possiamo costruire è aumentata e la barriera delle competenze matematiche e computazionali che sono richieste è diminuita. Inoltre, il processo di modellazione iterativa è diventato, sotto molti aspetti, molto più facile da eseguire. Anche se formulare modelli statistici complessi è diventato più facile che mai, la statistica è un campo pieno di sottigliezze che non scompaiono magicamente utilizzando potenti metodi computazionali. Pertanto, avere una buona preparazione sugli aspetti teorici, specialmente quelli rilevanti per la pratica, è estremamente utile per applicare efficacemente i metodi statistici.\n\nNell’approccio bayesiano all’inferenza statistica si prende in considerazione una variabile casuale \\(Y\\) di cui si conosce la distribuzione a meno di un parametro \\(\\theta\\). Nel caso dell’esempio precedente, la variabile \\(Y\\) è la distribuzione delle differenze pre/post dei punteggi BDI-II. Immaginiamo di assumere che \\(Y\\) dia una variabile Gaussiana di cui non conosciamo il parametro \\(\\mu\\) (media) ma di cui conosciamo \\(\\sigma\\).\nSecondo l’approccio bayesiano, è possibile modellare l’incertezza sul valore del parametro ignoto rappresentandolo con una variabile casuale continua \\(\\Theta\\) avente come supporto l’insieme dei valori ammissibili per il parametro cercato. Nel caso dell’esempio considerato, ciò significa che consideriamo \\(\\mu\\) come una variabile casuale il cui supporto è \\([-\\infty, \\infty]\\).\nLa funzione di densità \\(p(\\theta)\\) prende il nome di distribuzione a priori e rappresenta la sintesi delle opinioni e delle informazioni che si hanno sul parametro prima dell’osservazione dei dati. Nell’esempio, anche se \\(\\mu\\) può assumere valori nell’intervallo \\([-\\infty, \\infty]\\), non tutti questi valori sono plausibili. Ad esempio, una differenza di un milione, sulla scala del BDI-II, è senza senso. A priori, potremmo dunque descrivere la nostra incertezza su \\(\\mu\\) mediante una funzione di densità la cui massa è compresa nell’intervallo, diciamo, [-20, 20]. In assenza di altre informazioni, questa gamma di valori sembra ragionevole. Inoltre, se non abbiamo motivo di credere che l’intervento psicologico sarà sicuramente efficace, la funzione di densità che descrive la nostra incertezza su \\(\\mu\\) potrebbe avere media pari a zero. Pertanto, la nostra incertezza iniziale su \\(\\mu\\) potrebbe essere descritta mediante una \\(\\mathcal{N}(0, 7)\\).\nL’aggiornamento dell’incertezza su \\(\\theta\\) è determinata dal verificarsi dell’evidenza \\(y\\), ovvero dall’osservazione dei risultati di un esperimento casuale. Nel caso dell’esempio, potremmo pensare di misurare il BDI-II prima e dopo l’intervento su 30 pazienti.\nLe informazioni provenienti dal campione osservato \\(y = (y_1, \\dots, y_n)\\) sono contenute nella funzione \\(p(y \\mid \\theta)\\), che, osservata come funzione di \\(\\theta\\) per \\(y\\), prende il nome di funzione di verosimiglianza. In precedenza abbiamo visto come sia possibile costruire la funzione di verosimiglianza Gaussiana nel caso di \\(\\mu\\) incognito e \\(\\sigma\\) noto. Per continuare con l’esempio in discussione, potremmo pensare di costruire la funzione di verosimiglianza in questo modo. La funzione di verosimiglianza così costruita ci direbbe qual è la verosimiglianza relativa dei valori del parametro \\(\\mu\\) alla luce dei dati osservati (e assumendo \\(\\sigma\\) come noto).\nL’aggiornamento delle conoscenze a priori incorporate nella distribuzione iniziale \\(p(\\theta)\\) in seguito al verificarsi di \\(Y = y\\) (evidenza empirica) avviene attraverso il teorema di Bayes in cui \\(p(\\theta \\mid y)\\) risulta proporzionale al prodotto della probabilità a priori e della verosimiglianza e prende il nome di distribuzione a posteriori:\n\\[\\begin{equation}\np(\\theta \\mid y) = \\frac{p(y \\mid \\theta) p(\\theta)}{\\int_{\\Theta}p(y \\mid \\theta) p(\\theta) \\,\\operatorname {d}\\!\\theta} \\quad \\theta \\in \\Theta.\n(\\#eq:bayes-intro)\n\\end{equation}\\]\nNel caso dell’esempio in discussione, la distribuzione a posteriori del parametro \\(\\mu\\) fornisce una descrizione della nostra incertezza relativamente all’efficacia media dell’intervento psicologico. Se, diciamo, la gran parte della massa della distribuzione a posteriori include valori positivi, ciò ci fornisce evidenza che l’intervento psicologico sia stato, in media, efficace (cioè, ha portato ad una riduzione dei valori BDI-II). Se invece la massa della distribuzione a posteriori del parametro \\(\\mu\\) è ripartita in manera bilanciata tra valori negativi e valori positivi, allora non c’è evidenza che l’intervento psicologico sia stato efficace (per alcuni pazienti ha prodotto un miglioramento, per altri un peggioramento).\nPossiamo dunque dire che, nell’esempio, la distribuzione a posteriori del parametro \\(\\mu\\) descrive la credibilità che possiamo attribuire all’efficacia dell’intervento psicologico dopo avere esaminato i dati a disposizione, e includendo le evidenze a priori."
  },
  {
    "objectID": "025_intro_bayes.html#flusso-di-lavoro-bayesiano",
    "href": "025_intro_bayes.html#flusso-di-lavoro-bayesiano",
    "title": "15  Credibilità, modelli e parametri",
    "section": "\n15.3 Flusso di lavoro bayesiano",
    "text": "15.3 Flusso di lavoro bayesiano\nIn pratica, Martin et al. (2022) descrivono la modellazione bayesiana distinguendo tre passaggi.\n\nDati alcuni dati e alcune ipotesi su come questi dati potrebbero essere stati generati, si progetta un modello statistico combinando e trasformando variabili casuali.\nSi usa il teorema di Bayes per condizionare il modello ai dati. Questo processo viene chiamato “inferenza” e come risultato si ottiene una distribuzione a posteriori.\n\nSi critica il modello utilizzando criteri diversi, inclusi i dati e la nostra conoscenza del dominio, per verificare se abbia senso. Poiché in generale siamo incerti sul modello, a volte si confrontano modelli diversi.\n\nQuesti tre passaggi vengono eseguiti in modo iterativo e danno luogo a quello che è chiamato “flusso di lavoro bayesiano” (bayesian workflow).\nEsaminiamo ora più nei dettagli le varie fasi del flusso di lavoro bayesiano.\n\n15.3.1 Notazione\nPer fissare la notazione, nel seguito \\(y\\) rappresenterà i dati e \\(\\theta\\) rappresenterà i parametri incogniti di un modello statistico. Sia \\(y\\) che \\(\\theta\\) vengono concepiti come variabili casuali. Con \\(x\\) vengono invece denotate le quantità note, come ad esempio i predittori del modello lineare. Per rappresentare in un modo conciso i modelli probabilistici viene usata una notazione particolare. Ad esempio, invece di scrivere \\(p(\\theta) = \\mbox{Beta}(1, 1)\\) scriviamo \\(\\theta \\sim \\mbox{Beta}(1, 1)\\). Il simbolo “\\(\\sim\\)” viene spesso letto “è distribuito come”. Possiamo anche pensare che significhi che \\(\\theta\\) costituisce un campione casuale estratto dalla distribuzione Beta(1, 1). Allo stesso modo, ad esempio, la verosimiglianza del modello binomiale può essere scritta come \\(y \\sim \\text{Bin}(n, \\theta)\\).\n\n15.3.2 Distribuzioni a priori\nQuando adottiamo un approccio bayesiano, i parametri della distribuzione di riferimento non venono considerati come delle costanti incognite ma bensì vengono trattati come variabili casuali; di conseguenza, i parametri assumono una particolare distribuzione che nelle statistica bayesiana viene definita “a priori”. I parametri \\(\\theta\\) possono assumere delle distribuzioni a priori differenti: a seconda delle informazioni disponibili bisogna selezionare una distribuzione di \\(\\theta\\) in modo tale che venga assegnata una probabilità maggiore a quei valori del parametro che si ritengono più plausibili. Idealmente, le credenze a priori che portano alla specificazione di una distribuzione a priori dovrebbero essere supportate da una qualche motivazione, come ad esempio i risultati di ricerche precedenti.\n\n\n\n15.3.2.1 Tipologie di distribuzioni a priori\nPossiamo distinguere tra diverse distribuzioni a priori in base a quanto fortemente impegnano il ricercatore a ritenere come credibile un particolare intervallo di valori dei parametri. Un caso estremo è quello che rivela una totale assenza di conoscenze a priori, il che conduce alle distribuzioni a priori non informative, ovvero quelle che assegnano lo stesso livello di credibilità a tutti i valori dei parametri. Le distribuzioni a priori informative, d’altra parte, possono essere debolmente informative o fortemente informative, a seconda del modo in cui lo sperimentatore distribuisce la credibilità nello spazio del parametro. Un caso estremo di credenza a priori è quello che assegna tutta la credibilità ad un singolo valore del parametro. La figura seguente mostra alcuni esempi di distribuzioni a priori per il modello Binomiale:\n\ndistribuzione non informativa: \\(\\theta_c \\sim \\mbox{Beta}(1,1)\\);\ndistribuzione debolmente informativa: \\(\\theta_c \\sim \\mbox{Beta}(5,2)\\);\ndistribuzione fortemente informativa: \\(\\theta_c \\sim \\mbox{Beta}(50,20)\\);\n\nvalore puntuale: \\(\\theta_c \\sim \\mbox{Beta}(\\alpha, \\beta)\\) con \\(\\alpha, \\beta \\rightarrow \\infty\\) e \\(\\frac{\\alpha}{\\beta} = \\frac{5}{2}\\).\n\n\n\n\n\nEsempi di distribuzioni a priori per il parametro \\(\\theta_c\\) nel Modello Binomiale.\n\n\n\n\n\n15.3.2.2 Selezione della distribuzione a priori\nLa selezione delle distribuzioni a priori è stata spesso vista come una delle scelte più importanti che un ricercatore fa quando implementa un modello bayesiano in quanto può avere un impatto sostanziale sui risultati finali. La soggettività delle distribuzioni a priori è evidenziata dai critici come un potenziale svantaggio dei metodi bayesiani. A questa critica, Schoot et al. (2021) rispondono dicendo che le distribuzioni a priori svolgono due importanti ruoli statistici: quello della “regolarizzazione della stima”, ovvero, il processo che porta ad indebolire l’influenza indebita di osservazioni estreme, e quello del miglioramento dell’efficenza della stima, ovvero, la facilitazione dei processi di calcolo numerico di stima della distribuzione a posteriori. L’effetto della distribuzione a priori sulla distribuzione a posteriori verrà discusso in dettaglio nel Capitolo @ref(chapter-balance). Inoltre, Schoot et al. (2021) notano che, a proposito di scelte “soggettive”, al di là della scelta delle distribuzioni a priori, ci sono molti elementi del processo di inferenza statistica che risultano sicuramente “soggettivi” (cioè, arbitrari), in particolare la scelta del modello statistico e le ipotesi sulla distribuzione degli errori. Risultano inoltre “soggettivi” il modo di operazionalizzare la variabile dipendente, il tipo di confronti da esaminare e tante altre dimensioni dell’inferenza statistica. Per cui, il confronto tra statistica bayesiana e frequentista non può essere sicuramente svolto nei termini delle dimensioni oggettivo/soggettivo.\n\n15.3.3 La funzione di verosimiglianza\nLa funzione di verosimiglianza per due casi tipici, quello binomiale e quello Normale, è stata descritta nel Capitolo @ref(ch:likelihood).\n\nNota. Seguendo una pratica comune, all’interno di un framework bayesiano spesso useremo la notazione \\(p(\\cdot)\\) per rappresentare due quantità differenti, ovvero la funzione di verosimiglianza e la distribuzione a priori. Questo piccolo abuso di notazione riflette il seguente punto di vista: anche se la verosimiglianza non è una funzione di densità di probabilità, noi non vogliamo stressare questo aspetto, ma vogliamo piuttosto pensare alla verosimiglianza e alla distribuzione a priori come a due elementi che sono egualmente necessari per calcolare la distribuzione a posteriori. In altri termini, per così dire, questa notazione assegna lo stesso status epistemico alle due diverse quantità che si trovano al numeratore della regola di Bayes.\n\n\n15.3.4 La verosimiglianza marginale\nPer il calcolo di \\(p(\\theta \\mid y)\\) è necessario dividere il prodotto tra la distribuzione a priori e la verosimiglianza per una costante di normalizzazione. Tale costante di normalizzazione, detta verosimiglianza marginale, ha lo scopo di fare in modo che \\(p(\\theta \\mid y)\\) abbia area unitaria.\n\nSi noti che la verosimiglianza marginale (ovvero, l’integrale al denominatore della @ref(eq:bayes-intro)) è spesso di difficile risoluzione analitica per cui l’inferenza bayesiana solitamente procede attraverso metodi di ricampionamento e metodi iterativi, quali le Catene di Markov Monte Carlo (MCMC).\n\n15.3.5 La distribuzione a posteriori\nLa distribuzione a postreriori si trova applicando il teorema di Bayes:\n\\[\n\\text{probabilità a posteriori} = \\frac{\\text{probabilità a priori} \\cdot \\text{verosimiglianza}}{\\text{costante di normalizzazione}}\n\\]\nNei Capitoli successivi vedremo come calcolare la distribuzione a posteriori. Ci sono due metodi:\n\nun metodo esatto, che può essere usato nel caso delle distribuzioni a priori coniugate;\nun metodo approssimato, che può sempre essere usato, ma è computazionalmente intensivo.\n\n\n15.3.6 Distribuzione predittiva a priori\nLa distribuzione a posteriori è l’oggetto centrale nella statistica bayesiana, ma non è l’unico. Oltre a fare inferenze sui valori dei parametri, potremmo voler fare inferenze sui dati. Questo può essere fatto calcolando la distribuzione predittiva a priori:\n\\[\\begin{equation}\np(y^*) = \\int_\\Theta p(y^* \\mid \\theta) p(\\theta) \\,\\operatorname {d}\\!\\theta .\n(\\#eq:prior-pred-distr)\n\\end{equation}\\]\nLa @ref(eq:prior-pred-distr) descrive la distribuzione prevista dei dati in base al modello (che include la distribuzione a priori e la verosimiglianza), ovvero descrive i dati \\(y^*\\) che ci aspettiamo di osservare, dato il modello, prima di avere osservato i dati del campione.\nÈ possibile utilizzare campioni dalla distribuzione predittiva a priori per valutare e calibrare i modelli utilizzando le nostre conoscenze dominio-specifiche. Ad esempio, ci possiamo chiedere: “È sensato che un modello dell’altezza umana preveda che un essere umano sia alto -1.5 metri?”. Già prima di misurare una singola persona, possiamo renderci conto dell’assurdità di questa domanda. Se la distribuzione prevista dei dati consente domande di questo tipo (ovvero, prevede di osservare dati che risultano insensati alla luce delle nostre conoscenze dominio-specifiche), è chiaro che il modello deve essere riformulato.\n\n\n\n\n15.3.7 Distribuzione predittiva a posteriori\nUn’altra quantità utile da calcolare è la distribuzione predittiva a posteriori:\n\\[\\begin{equation}\np(\\tilde{y} \\mid y) = \\int_\\Theta p(\\tilde{y} \\mid \\theta) p(\\theta \\mid y) \\,\\operatorname {d}\\!\\theta .\n(\\#eq:post-pred-distr)\n\\end{equation}\\]\nQuesta è la distribuzione dei dati attesi futuri \\(\\tilde{y}\\) alla luce della distribuzione a posteriori \\(p(\\theta \\mid y)\\), che a sua volta è una conseguenza del modello adottato (distribuzione a priori e verosimiglianza) e dei dati osservati. In altre parole, questi sono i dati che il modello si aspetta dopo aver osservato i dati de campione. Dalla @ref(eq:post-pred-distr) possiamo vedere che le previsioni sui dati attesi futuri sono calcolate integrando (o marginalizzando) sulla distribuzione a posteriori dei parametri. Di conseguenza, le previsioni calcolate in questo modo incorporano l’incertezza relativa alla stima dei parametri del modello."
  },
  {
    "objectID": "025_intro_bayes.html#commenti-e-considerazioni-finali",
    "href": "025_intro_bayes.html#commenti-e-considerazioni-finali",
    "title": "15  Credibilità, modelli e parametri",
    "section": "Commenti e considerazioni finali",
    "text": "Commenti e considerazioni finali\nQuesto Capitolo ha brevemente passato in rassegna i concetti di base dell’inferenza statistica bayesiana. In base all’approccio bayesiano, invece di dire che il parametro di interesse di un modello statistico ha un valore vero ma sconosciuto, diciamo che, prima di eseguire l’esperimento, è possibile assegnare una distribuzione di probabilità, che chiamano stato di credenza, a quello che è il vero valore del parametro. Questa distribuzione a priori può essere nota (per esempio, sappiamo che la distribuzione dei punteggi del QI è normale con media 100 e deviazione standard 15) o può essere del tutto arbitraria. L’inferenza bayesiana procede poi nel modo seguente: si raccolgono alcuni dati e si calcola la probabilità dei possibili valori del parametro alla luce dei dati osservati e delle credenze a priori. Questa nuova distribuzione di probabilità è chiamata “distribuzione a posteriori” e riassume l’incertezza dell’inferenza."
  },
  {
    "objectID": "025_intro_bayes.html#bibliografia",
    "href": "025_intro_bayes.html#bibliografia",
    "title": "15  Credibilità, modelli e parametri",
    "section": "Bibliografia",
    "text": "Bibliografia\n\n\n\n\n\n\nKruschke, J. (2014). Doing bayesian data analysis: A tutorial with R, JAGS, and Stan. Academic Press.\n\n\nMartin, O. A., Kumar, R., & Lao, J. (2022). Bayesian modeling and computation in python. CRC Press.\n\n\nSchoot, R. van de, Depaoli, S., King, R., Kramer, B., Märtens, K., Tadesse, M. G., Vannucci, M., Gelman, A., Veen, D., Willemsen, J., & Yau, C. (2021). Bayesian statistics and modelling. Nature Reviews Methods Primer, 1(1), 1–26."
  },
  {
    "objectID": "999_refs.html",
    "href": "999_refs.html",
    "title": "Riferimenti bibliografici",
    "section": "",
    "text": "Albert, J., & Hu, J. (2019). Probability and bayesian\nmodeling. Chapman; Hall/CRC.\n\n\nFinetti, B. de. (1931). Probabilismo. Logos, 163–219.\n\n\nKruschke, J. (2014). Doing bayesian data analysis: A\ntutorial with R, JAGS, and Stan. Academic\nPress.\n\n\nLazic, S. E., Semenova, E., & Williams, D. P. (2020). Determining\norgan weight toxicity with bayesian causal models: Improving on the\nanalysis of relative organ weights. Scientific Reports,\n10(1), 1–12.\n\n\nMartin, O. A., Kumar, R., & Lao, J. (2022). Bayesian modeling\nand computation in python. CRC Press.\n\n\nMcElreath, R. (2020). Statistical rethinking: A\nBayesian course with examples in R and\nStan (2nd Edition). CRC Press.\n\n\nNuggerud-Galeas, S., Sáez-Benito Suescun, L., Berenguer Torrijo, N.,\nSáez-Benito Suescun, A., Aguilar-Latorre, A., Magallón Botaya, R., &\nOliván Blázquez, B. (2020). Analysis of depressive episodes, their\nrecurrence and pharmacologic treatment in primary care patients: A\nretrospective descriptive study. Plos One, 15(5),\ne0233454.\n\n\nSchoot, R. van de, Depaoli, S., King, R., Kramer, B., Märtens, K.,\nTadesse, M. G., Vannucci, M., Gelman, A., Veen, D., Willemsen, J., &\nYau, C. (2021). Bayesian statistics and modelling. Nature Reviews\nMethods Primer, 1(1), 1–26.\n\n\nStevens, S. S. (1946). On the theory of scales of measurement.\nScience, 103(2684), 677–680.\n\n\nTufte, E. R. (2001). The visual display of quantitative\ninformation. Graphics press Cheshire, CT.\n\n\nZetsche, U., Bürkner, P.-C., & Renneberg, B. (2019). Future\nexpectations in clinical depression: Biased or realistic?\nJournal of Abnormal Psychology, 128(7), 678–688."
  }
]